<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Forensics on Jasmine❀Hiker</title>
    <link>//localhost:1313/tags/forensics/</link>
    <description>Recent content in Forensics on Jasmine❀Hiker</description>
    <generator>Hugo</generator>
    <language>en</language>
    <copyright>&lt;a href=&#34;https://creativecommons.org/licenses/by-nc/4.0/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;CC BY-NC 4.0&lt;/a&gt;</copyright>
    <lastBuildDate>Tue, 04 Oct 2022 23:18:37 +0800</lastBuildDate>
    <atom:link href="//localhost:1313/tags/forensics/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>OtterCTF 2018 内存取证复现</title>
      <link>//localhost:1313/posts/otterctf_2018_memory_forensic_writeup/</link>
      <pubDate>Tue, 04 Oct 2022 23:18:37 +0800</pubDate>
      <guid>//localhost:1313/posts/otterctf_2018_memory_forensic_writeup/</guid>
      <description>&lt;h1 id=&#34;otterctf-2018-memory-forensic-reappearance&#34;&gt;OtterCTF 2018 Memory Forensic Reappearance&lt;/h1&gt;&#xA;&lt;p&gt;想学习并练习下电子取证技术，经过网络上的一番搜索发现OtterCTF的取证题目非常有意思，这次尝试练习下内存取证的题目顺便学习下内存取证的相关内容和技能点。内存取证主要使用的工具是Volatility，githu上面有相关项目。Volatility有两个版本分别是用python2和python3进行构建的，目前主要的组件还是以python2为主。&#xA;Volatility项目地址：&lt;a href=&#34;https://github.com/volatilityfoundation/volatility&#34;&gt;https://github.com/volatilityfoundation/volatility&lt;/a&gt;&#xA;Volatility3项目地址：&lt;a href=&#34;https://github.com/volatilityfoundation/volatility3&#34;&gt;https://github.com/volatilityfoundation/volatility3&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;环境配置：Kali Linux 2022&#xA;工具配置：volatility + mimikatz&lt;/p&gt;&#xA;&lt;h2 id=&#34;info&#34;&gt;Info&lt;/h2&gt;&#xA;&lt;p&gt;题目附件就一个镜像，先查看下镜像的指纹数据：&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;5b3d8a9f9c96581a821c19b71dd6aa80dd299fc674b818f443f3a6fb5495a872  OtterCTF.vmem&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;使用vol简单查看下镜像信息数据，查看数据的指令：&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol.py -f OtterCTF.vmem imageinfo&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;blockquote&gt;&#xA;&lt;p&gt;&lt;strong&gt;说明&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;vol.py&lt;/code&gt; volatility程序&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;-f OtterCTF.vmem&lt;/code&gt;  加载&lt;code&gt;OtterCTF.vmem&lt;/code&gt;内存镜像文件&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;imageinfo&lt;/code&gt; 查看内存镜像的基本信息&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;p&gt;得到如下信息：&lt;/p&gt;&#xA;&lt;p&gt;&lt;img alt=&#34;image-20221002204848160&#34; src=&#34;//localhost:1313/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221002204848160.png&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;可以看到大致的镜像系统是Win7系统&lt;/p&gt;&#xA;&lt;h2 id=&#34;what-the-password&#34;&gt;What the password?&lt;/h2&gt;&#xA;&lt;p&gt;查看题目描述：&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;you got a sample of rick&amp;#39;s PC&amp;#39;s memory. can you get his user password?&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;要得到用户名的密码，先获取到hash数据，使用获取hash的指令：&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol.py -f OtterCTF.vmem --profile&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;Win7SP1x64 hashdump  &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;blockquote&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;--profile=Win7SP1x64&lt;/code&gt; 设置配置为&lt;code&gt;Win7SP1x64&lt;/code&gt;配置&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;hashdump&lt;/code&gt; 从内存中dump出密码的hash信息&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;p&gt;得到hash信息：&lt;/p&gt;&#xA;&lt;p&gt;&lt;img alt=&#34;image-20221002212051508&#34; src=&#34;//localhost:1313/images/OtterCTF_2018_Memory_Forensic_writeup/image-20221002212051508.png&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;对于这种hash信息可以使用mimikatz插件，或者使用hashcat也可以，这里使用mimikatz进行获取&lt;/p&gt;&#xA;&lt;p&gt;使用如下指令使用mimikatz插件进行获取：&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol.py -f OtterCTF.vmem --profile&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;Win7SP1x64 mimikatz&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;得到如下信息：&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
