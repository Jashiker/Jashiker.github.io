<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>XCTF REVERSE novice_writeup | Jasmine❀Hiker</title><meta name=keywords content="ctf,writeup,reverse"><meta name=description content="XCTF-REVERSE-新手区 writeup 来XCTF平台，做做Re练练手
XCTF平台有十道题目：
十道题目应该是涵盖了逆向方向的主要内容，带着好奇心去探索逆向的世界吧
0x0 insanity 往往第一道题目都不是很难，下载附件，看看是个什么东西。
文件没有扩展名，可能是个ELF文件，走个流程
首先查一下壳
果然是ELF格式的文件，不过不是x64格式的ELF文件
使用IDA pro打开文件，查看主函数的反编译代码
int __cdecl main(int argc, const char **argv, const char **envp) { unsigned int v3; // eax unsigned int v4; // eax puts(&#34;Reticulating splines, please wait..&#34;); sleep(5u); v3 = time(0); srand(v3); v4 = rand(); puts((&amp;strs)[v4 % 0xA]); return 0; } 跟进strs的数据
继续跟进strs的数据
get到了flag
9447{This_is_a_flag} 0x1 python-trade 看题目应该是一个Python的逆向题目
文件是一个pyc文件应该是Python的逆向文件，可以使用Python的反编译工具进行反编译
可以使用 uncompyle 进行反编译：
# uncompyle6 version 3.7.4 # Python bytecode 2."><meta name=author content="Me"><link rel=canonical href=/posts/xctf-reverse-novice_writeup/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.bf5f9f73cf17311d52cedbcda82c922e91b2f566d88a85ad9f5b5a08b586bd5f.css integrity="sha256-v1+fc88XMR1SztvNqCySLpGy9WbYioWtn1taCLWGvV8=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.acb54fd32bbc1982428b8850317e45d076b95012730a5936667e6bc21777692a.js integrity="sha256-rLVP0yu8GYJCi4hQMX5F0Ha5UBJzClk2Zn5rwhd3aSo=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=favicon.ico><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=apple-touch-icon href=apple-touch-icon.png><link rel=mask-icon href=safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="XCTF REVERSE novice_writeup"><meta property="og:description" content="XCTF-REVERSE-新手区 writeup 来XCTF平台，做做Re练练手
XCTF平台有十道题目：
十道题目应该是涵盖了逆向方向的主要内容，带着好奇心去探索逆向的世界吧
0x0 insanity 往往第一道题目都不是很难，下载附件，看看是个什么东西。
文件没有扩展名，可能是个ELF文件，走个流程
首先查一下壳
果然是ELF格式的文件，不过不是x64格式的ELF文件
使用IDA pro打开文件，查看主函数的反编译代码
int __cdecl main(int argc, const char **argv, const char **envp) { unsigned int v3; // eax unsigned int v4; // eax puts(&#34;Reticulating splines, please wait..&#34;); sleep(5u); v3 = time(0); srand(v3); v4 = rand(); puts((&amp;strs)[v4 % 0xA]); return 0; } 跟进strs的数据
继续跟进strs的数据
get到了flag
9447{This_is_a_flag} 0x1 python-trade 看题目应该是一个Python的逆向题目
文件是一个pyc文件应该是Python的逆向文件，可以使用Python的反编译工具进行反编译
可以使用 uncompyle 进行反编译：
# uncompyle6 version 3.7.4 # Python bytecode 2."><meta property="og:type" content="article"><meta property="og:url" content="/posts/xctf-reverse-novice_writeup/"><meta property="og:image" content="%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-10-14T13:27:13+08:00"><meta property="article:modified_time" content="2021-10-14T13:27:13+08:00"><meta property="og:site_name" content="Jasmine❀Hiker"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="XCTF REVERSE novice_writeup"><meta name=twitter:description content="XCTF-REVERSE-新手区 writeup 来XCTF平台，做做Re练练手
XCTF平台有十道题目：
十道题目应该是涵盖了逆向方向的主要内容，带着好奇心去探索逆向的世界吧
0x0 insanity 往往第一道题目都不是很难，下载附件，看看是个什么东西。
文件没有扩展名，可能是个ELF文件，走个流程
首先查一下壳
果然是ELF格式的文件，不过不是x64格式的ELF文件
使用IDA pro打开文件，查看主函数的反编译代码
int __cdecl main(int argc, const char **argv, const char **envp) { unsigned int v3; // eax unsigned int v4; // eax puts(&#34;Reticulating splines, please wait..&#34;); sleep(5u); v3 = time(0); srand(v3); v4 = rand(); puts((&amp;strs)[v4 % 0xA]); return 0; } 跟进strs的数据
继续跟进strs的数据
get到了flag
9447{This_is_a_flag} 0x1 python-trade 看题目应该是一个Python的逆向题目
文件是一个pyc文件应该是Python的逆向文件，可以使用Python的反编译工具进行反编译
可以使用 uncompyle 进行反编译：
# uncompyle6 version 3.7.4 # Python bytecode 2."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"/posts/"},{"@type":"ListItem","position":3,"name":"XCTF REVERSE novice_writeup","item":"/posts/xctf-reverse-novice_writeup/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"XCTF REVERSE novice_writeup","name":"XCTF REVERSE novice_writeup","description":"XCTF-REVERSE-新手区 writeup 来XCTF平台，做做Re练练手\nXCTF平台有十道题目：\n十道题目应该是涵盖了逆向方向的主要内容，带着好奇心去探索逆向的世界吧\n0x0 insanity 往往第一道题目都不是很难，下载附件，看看是个什么东西。\n文件没有扩展名，可能是个ELF文件，走个流程\n首先查一下壳\n果然是ELF格式的文件，不过不是x64格式的ELF文件\n使用IDA pro打开文件，查看主函数的反编译代码\nint __cdecl main(int argc, const char **argv, const char **envp) { unsigned int v3; // eax unsigned int v4; // eax puts(\u0026#34;Reticulating splines, please wait..\u0026#34;); sleep(5u); v3 = time(0); srand(v3); v4 = rand(); puts((\u0026amp;strs)[v4 % 0xA]); return 0; } 跟进strs的数据\n继续跟进strs的数据\nget到了flag\n9447{This_is_a_flag} 0x1 python-trade 看题目应该是一个Python的逆向题目\n文件是一个pyc文件应该是Python的逆向文件，可以使用Python的反编译工具进行反编译\n可以使用 uncompyle 进行反编译：\n# uncompyle6 version 3.7.4 # Python bytecode 2.","keywords":["ctf","writeup","reverse"],"articleBody":"XCTF-REVERSE-新手区 writeup 来XCTF平台，做做Re练练手\nXCTF平台有十道题目：\n十道题目应该是涵盖了逆向方向的主要内容，带着好奇心去探索逆向的世界吧\n0x0 insanity 往往第一道题目都不是很难，下载附件，看看是个什么东西。\n文件没有扩展名，可能是个ELF文件，走个流程\n首先查一下壳\n果然是ELF格式的文件，不过不是x64格式的ELF文件\n使用IDA pro打开文件，查看主函数的反编译代码\nint __cdecl main(int argc, const char **argv, const char **envp) { unsigned int v3; // eax unsigned int v4; // eax puts(\"Reticulating splines, please wait..\"); sleep(5u); v3 = time(0); srand(v3); v4 = rand(); puts((\u0026strs)[v4 % 0xA]); return 0; } 跟进strs的数据\n继续跟进strs的数据\nget到了flag\n9447{This_is_a_flag} 0x1 python-trade 看题目应该是一个Python的逆向题目\n文件是一个pyc文件应该是Python的逆向文件，可以使用Python的反编译工具进行反编译\n可以使用 uncompyle 进行反编译：\n# uncompyle6 version 3.7.4 # Python bytecode 2.7 (62211) # Decompiled from: Python 3.8.8 (default, Apr 13 2021, 15:08:03) [MSC v.1916 64 bit (AMD64)] # Embedded file name: 1.py # Compiled at: 2017-06-03 10:20:43 import base64 def encode(message): s = '' for i in message: x = ord(i) ^ 32 x = x + 16 s += chr(x) return base64.b64encode(s) correct = 'XlNkVmtUI1MgXWBZXCFeKY+AaXNt' flag = '' print 'Input flag:' flag = raw_input() if encode(flag) == correct: print 'correct' else: print 'wrong' # okay decompiling .\\test.pyc 应该是需要逆这个加密算法的进行求解，密码手的老本行了，写个求解脚本:\nimport base64 def Redecode(cipher): message = '' cipher = base64.b64decode(cipher).decode() for i in cipher: x = ord(i) - 16 x = x ^ 32 message += chr(x) return message cipher = 'XlNkVmtUI1MgXWBZXCFeKY+AaXNt' flag = Redecode(cipher) print(flag) 在python2环境下运行脚本，就能得到flag了：\nnctf{d3c0mpil1n9_PyC} 0x2 re1 附件有报毒，麻了\n走一下流程，先查文件信息\n32位的可执行程序，程序没有壳，丢进IDA pro进行静态分析\nint __cdecl main(int argc, const char **argv, const char **envp) { int v3; // eax __m128i v5; // [esp+0h] [ebp-44h] BYREF char v6[8]; // [esp+10h] [ebp-34h] BYREF int v7; // [esp+18h] [ebp-2Ch] __int16 v8; // [esp+1Ch] [ebp-28h] char v9[32]; // [esp+20h] [ebp-24h] BYREF v5 = _mm_loadu_si128((const __m128i *)\"DUTCTF{We1c0met0DUTCTF}\"); v7 = 0; strcpy(v6, \"DUTCTF}\"); v8 = 0; printf(\"欢迎来到DUTCTF呦\\n\"); printf(\"这是一道很可爱很简单的逆向题呦\\n\"); printf(\"输入flag吧:\"); scanf(\"%s\", v9); v3 = strcmp(v5.m128i_i8, v9); if ( v3 ) v3 = v3 \u003c 0 ? -1 : 1; if ( v3 ) printf(aFlag_0); else printf(aFlagGet); system(\"pause\"); return 0; } 首先，我们需要知道具体的逻辑判断形式，逻辑判断是以什么形式进行判断的，找到逻辑判断语句\nif ( v3 ) v3 = v3 \u003c 0 ? -1 : 1; if ( v3 ) printf(aFlag_0); else printf(aFlagGet); v3 数值不为0的情况下会先执行第一个 if 语句，将不正确的v3值进行转换\n然后再进行一个if - else 的逻辑语句，判断v3的数值，如果v3的数值是等于0的，那么我们输入的flag就是正确的\n那么，v3 是什么东西？\nv3 = strcmp(v5.m128i_i8, v9); 是一个比较数值，如果 v5.m128i_i8 与 v9 相等，那么v3 的数值就等于0了，逻辑现在搞通了，下面跟进数据：\n这段数据应该就是 v5 的数据了，将数据转换成字符串\n成功得到flag：\nDUTCTF{We1c0met0DUTCTF} 0x3 game 应该是个游戏，感觉还是挺有意思的\n果然是一个游戏，还蛮有意思的，不过，还是要走下流程查一下信息\n32位程序，没有壳，先丢进IDA pro康一康\nint __cdecl main_0(int argc, const char **argv, const char **envp) { int i; // [esp+DCh] [ebp-20h] int v5; // [esp+F4h] [ebp-8h] BYREF sub_45A7BE(\u0026unk_50B110); sub_45A7BE(\u0026unk_50B158); sub_45A7BE(\u0026unk_50B1A0); sub_45A7BE(\u0026unk_50B1E8); sub_45A7BE(\u0026unk_50B230); sub_45A7BE(\u0026unk_50B278); sub_45A7BE(\u0026unk_50B2C0); sub_45A7BE(\u0026unk_50B308); sub_45A7BE(\"二 |\\n\"); sub_45A7BE(\"| by 0x61 |\\n\"); sub_45A7BE(\"| |\\n\"); sub_45A7BE(\"|------------------------------------------------------|\\n\"); sub_45A7BE( \"Play a game\\n\" \"The n is the serial number of the lamp,and m is the state of the lamp\\n\" \"If m of the Nth lamp is 1,it's on ,if not it's off\\n\" \"At first all the lights were closed\\n\"); sub_45A7BE(\"Now you can input n to change its state\\n\"); sub_45A7BE( \"But you should pay attention to one thing,if you change the state of the Nth lamp,the state of (N-1)th and (N+1)th w\" \"ill be changed too\\n\"); sub_45A7BE(\"When all lamps are on,flag will appear\\n\"); sub_45A7BE(\"Now,input n \\n\"); while ( 1 ) { while ( 1 ) { sub_45A7BE(\"input n,n(1-8)\\n\"); sub_459418(); sub_45A7BE(\"n=\"); sub_4596D4(\"%d\", \u0026v5); sub_45A7BE(\"\\n\"); if ( v5 \u003e= 0 \u0026\u0026 v5 \u003c= 8 ) break; sub_45A7BE(\"sorry,n error,try again\\n\"); } if ( v5 ) { sub_4576D6(v5 - 1); } else { for ( i = 0; i \u003c 8; ++i ) { if ( (unsigned int)i \u003e= 9 ) sub_458919(); byte_532E28[i] = 0; } } sub_4581B7(\"CLS\"); sub_458054(); if ( byte_532E28[0] == 1 \u0026\u0026 byte_532E28[1] == 1 \u0026\u0026 byte_532E28[2] == 1 \u0026\u0026 byte_532E28[3] == 1 \u0026\u0026 byte_532E28[4] == 1 \u0026\u0026 byte_532E28[5] == 1 \u0026\u0026 byte_532E28[6] == 1 \u0026\u0026 byte_532E28[7] == 1 ) { sub_457AB4(); } } } 寻找到核心代码：\nif ( byte_532E28[0] == 1 \u0026\u0026 byte_532E28[1] == 1 \u0026\u0026 byte_532E28[2] == 1 \u0026\u0026 byte_532E28[3] == 1 \u0026\u0026 byte_532E28[4] == 1 \u0026\u0026 byte_532E28[5] == 1 \u0026\u0026 byte_532E28[6] == 1 \u0026\u0026 byte_532E28[7] == 1 ) { sub_457AB4(); } 可以知道，可以确定是 sub_457AB4(); 函数：\nint sub_45E940() { char v1; // [esp+0h] [ebp-164h] int i; // [esp+D0h] [ebp-94h] char v3[22]; // [esp+DCh] [ebp-88h] BYREF char v4[32]; // [esp+F2h] [ebp-72h] BYREF char v5[4]; // [esp+112h] [ebp-52h] BYREF char v6[64]; // [esp+120h] [ebp-44h] sub_45A7BE((int)\"done!!! the flag is \", v1); v6[0] = 18; v6[1] = 64; v6[2] = 98; v6[3] = 5; v6[4] = 2; v6[5] = 4; v6[6] = 6; v6[7] = 3; v6[8] = 6; v6[9] = 48; v6[10] = 49; v6[11] = 65; v6[12] = 32; v6[13] = 12; v6[14] = 48; v6[15] = 65; v6[16] = 31; v6[17] = 78; v6[18] = 62; v6[19] = 32; v6[20] = 49; v6[21] = 32; v6[22] = 1; v6[23] = 57; v6[24] = 96; v6[25] = 3; v6[26] = 21; v6[27] = 9; v6[28] = 4; v6[29] = 62; v6[30] = 3; v6[31] = 5; v6[32] = 4; v6[33] = 1; v6[34] = 2; v6[35] = 3; v6[36] = 44; v6[37] = 65; v6[38] = 78; v6[39] = 32; v6[40] = 16; v6[41] = 97; v6[42] = 54; v6[43] = 16; v6[44] = 44; v6[45] = 52; v6[46] = 32; v6[47] = 64; v6[48] = 89; v6[49] = 45; v6[50] = 32; v6[51] = 65; v6[52] = 15; v6[53] = 34; v6[54] = 18; v6[55] = 16; v6[56] = 0; v3[0] = 123; v3[1] = 32; v3[2] = 18; v3[3] = 98; v3[4] = 119; v3[5] = 108; v3[6] = 65; v3[7] = 41; v3[8] = 124; v3[9] = 80; v3[10] = 125; v3[11] = 38; v3[12] = 124; v3[13] = 111; v3[14] = 74; v3[15] = 49; v3[16] = 83; v3[17] = 108; v3[18] = 94; v3[19] = 108; v3[20] = 84; v3[21] = 6; qmemcpy(v4, \"`S,yhn _uec{\", 12); v4[12] = 127; v4[13] = 119; v4[14] = 96; v4[15] = 48; v4[16] = 107; v4[17] = 71; v4[18] = 92; v4[19] = 29; v4[20] = 81; v4[21] = 107; v4[22] = 90; v4[23] = 85; v4[24] = 64; v4[25] = 12; v4[26] = 43; v4[27] = 76; v4[28] = 86; v4[29] = 13; v4[30] = 114; v4[31] = 1; strcpy(v5, \"u~\"); for ( i = 0; i \u003c 56; ++i ) { v3[i] ^= v6[i]; v3[i] ^= 0x13u; } return sub_45A7BE((int)\"%s\\n\", (char)v3); } 基本上可以确定在这里输出flag，基本逻辑应该可以清晰的知道\n下面使用Ollydbg进行动态调试，调试出来flag\n先使用F8进行单步调试，确定关键函数位置\nF7进入函数的具体执行过程，进行字符串检索\n找到输入的关键位置，然后移动到关键位置\n根据已知的逻辑循环，修改逻辑循环\n修改这个关键性的跳转代码进行跳转修改，将跳转修改为call那个位置\n修改为：\njnz short 00D2F66C 然后运行修改过汇编的程序\n尝试输入几个参数就能获取到flag了\n得到flag\nzsctf{T9is_tOpic_1s_v5ry_int7resting_b6t_others_are_n0t} 0x4 Hello, CTF 首先查一下程序信息\n32位没有壳的程序\n使用IDA pro的看一下程序\nint __cdecl main(int argc, const char **argv, const char **envp) { int i; // ebx char v4; // al int result; // eax int v6; // [esp+0h] [ebp-70h] int v7; // [esp+0h] [ebp-70h] char Buffer[2]; // [esp+12h] [ebp-5Eh] BYREF char v9[20]; // [esp+14h] [ebp-5Ch] BYREF char v10[32]; // [esp+28h] [ebp-48h] BYREF __int16 v11; // [esp+48h] [ebp-28h] char v12; // [esp+4Ah] [ebp-26h] char v13[36]; // [esp+4Ch] [ebp-24h] BYREF strcpy(v13, \"437261636b4d654a757374466f7246756e\"); while ( 1 ) { memset(v10, 0, sizeof(v10)); v11 = 0; v12 = 0; sub_40134B(aPleaseInputYou, v6); scanf(\"%s\", v9); if ( strlen(v9) \u003e 0x11 ) break; for ( i = 0; i \u003c 17; ++i ) { v4 = v9[i]; if ( !v4 ) break; sprintf(Buffer, \"%x\", v4); strcat(v10, Buffer); } if ( !strcmp(v10, v13) ) sub_40134B(aSuccess, v7); else sub_40134B(aWrong, v7); } sub_40134B(aWrong, v7); result = --Stream._cnt; if ( Stream._cnt \u003c 0 ) return _filbuf(\u0026Stream); ++Stream._ptr; return result; } 代码非常清晰，应该可以明确v13的值和flag应该是一致的\nv13应该是Hex编码的字符串，进行解码就得到flag了\nCrackMeJustForFun 0x5 open-source 下载附件，源代码审计，看看源代码内容\n#include #include int main(int argc, char *argv[]) { if (argc != 4) { printf(\"what?\\n\"); exit(1); } unsigned int first = atoi(argv[1]); if (first != 0xcafe) { printf(\"you are wrong, sorry.\\n\"); exit(2); } unsigned int second = atoi(argv[2]); if (second % 5 == 3 || second % 17 != 8) { printf(\"ha, you won't get it!\\n\"); exit(3); } if (strcmp(\"h4cky0u\", argv[3])) { printf(\"so close, dude!\\n\"); exit(4); } printf(\"Brr wrrr grr\\n\"); unsigned int hash = first * 31337 + (second % 17) * 11 + strlen(argv[3]) - 1615810207; printf(\"Get your key: \"); printf(\"%x\\n\", hash); return 0; } 根据源码进行求解，其实也就是解个方程\n可以写个C程序直接求解\n#include #include int main() { unsigned int first = 0xcafe; unsigned int second = 25; char * Third = \"h4cky0u\"; unsigned int hash = first * 31337 + (second % 17) * 11 + strlen(Third) - 1615810207; printf(\"Get your key: \"); printf(\"%x\\n\", hash); return 0; } 编译并运行程序就能得到flag：\nGet your key: c0ffee 0x6 simple-unpack 看题目，应该是一个有壳的程序\n就正常走一下流程首先先要看看程序的信息\n加壳的64位的程序，首先使用upx脱一下壳，然后使用x64 IDA pro查看\n直接就能看到flag信息数据\nflag{Upx_1s_n0t_a_d3liv3r_c0mp4ny} 0x7 logmein 查一下程序信息\n没有壳，64位的Linux程序\n直接进行x64 ida pro静态调试\nvoid __fastcall __noreturn main(int a1, char **a2, char **a3) { size_t v3; // rsi int i; // [rsp+3Ch] [rbp-54h] char s[36]; // [rsp+40h] [rbp-50h] BYREF int v6; // [rsp+64h] [rbp-2Ch] __int64 v7; // [rsp+68h] [rbp-28h] char v8[28]; // [rsp+70h] [rbp-20h] BYREF int v9; // [rsp+8Ch] [rbp-4h] v9 = 0; strcpy(v8, \":\\\"AL_RT^L*.?+6/46\"); v7 = 0x65626D61726168LL; v6 = 7; printf(\"Welcome to the RC3 secure password guesser.\\n\"); printf(\"To continue, you must enter the correct password.\\n\"); printf(\"Enter your guess: \"); __isoc99_scanf(\"%32s\", s); v3 = strlen(s); if ( v3 \u003c strlen(v8) ) sub_4007C0(); for ( i = 0; i \u003c strlen(s); ++i ) { if ( i \u003e= strlen(v8) ) sub_4007C0(); if ( s[i] != (char)(*((_BYTE *)\u0026v7 + i % v6) ^ v8[i]) ) sub_4007C0(); } sub_4007F0(); } 应该是对算法进行逆向来得到相应的flag\n关键的数据是v7和v8，针对这两个数据写个C程序进行逆向算法\n#include #include int main() { char v8[28]; strcpy(v8, \":\\\"AL_RT^L*.?+6/46\"); char *v7 = \"harambe\"; int v6 = 7; char s[strlen(v8)]; for (int i = 0; i \u003c strlen(v8); ++i ) { s[i] = *(v7+i % v6) ^ v8[i]; } printf(\"%s\\n\",s); } 编译并运行得到flag\nRC3-2016-XORISGUD 0x8 no-string-attached 查一下文件的信息\n32位文件，没有壳，丢进到IDA pro查看\nint __cdecl main(int argc, const char **argv, const char **envp) { setlocale(6, \u0026locale); banner(); prompt_authentication(); authenticate(); return 0; } 进行分析，确定flag应该是在 authenticate()函数中\n跟进到 authenticate()函数\nvoid authenticate() { wchar_t ws[8192]; // [esp+1Ch] [ebp-800Ch] BYREF wchar_t *s2; // [esp+801Ch] [ebp-Ch] s2 = (wchar_t *)decrypt((wchar_t *)\u0026s, (wchar_t *)\u0026dword_8048A90); if ( fgetws(ws, 0x2000, stdin) ) { ws[wcslen(ws) - 1] = 0; if ( !wcscmp(ws, s2) ) wprintf(\u0026unk_8048B44); else wprintf(\u0026unk_8048BA4); } free(s2); } 关键数据应该是在s2中，调用了decrypt函数，看一下这个函数的汇编代码\nws= dword ptr -800Ch s2= dword ptr -0Ch ; __unwind { push ebp mov ebp, esp sub esp, 8028h mov dword ptr [esp+4], offset dword_8048A90 ; wchar_t * mov dword ptr [esp], offset s ; s call decrypt mov [ebp+s2], eax mov eax, ds:stdin@@GLIBC_2_0 mov [esp+8], eax ; stream mov dword ptr [esp+4], 2000h ; n lea eax, [ebp+ws] mov [esp], eax ; ws call _fgetws test eax, eax jz short loc_804879C 根据汇编代码，应该可以清晰的知道，flag数据应该是存储在eax寄存器中了\n使用gdb动态调试程序\ngdb Re_demo 然后设置断点，根据刚刚了解到的信息，flag的数据应该是在decrypt函数中，设置断点\nb decrypt 然后运行程序到断点\nr 然后单步执行\nn 查看寄存器\ni r 然后查看eax寄存器存储的数据\nx/sw $eax 成功拿到flag数据\n9447{you_are_an_international_mystery} 0x9 getit 基本流程，查看程序信息\n64位无壳的ELF可执行程序\n先丢进x64 IDA pro看一看\nint __cdecl main(int argc, const char **argv, const char **envp) { char v3; // al int i; // [rsp+0h] [rbp-40h] int j; // [rsp+4h] [rbp-3Ch] FILE *stream; // [rsp+8h] [rbp-38h] char filename[24]; // [rsp+10h] [rbp-30h] BYREF unsigned __int64 v9; // [rsp+28h] [rbp-18h] v9 = __readfsqword(0x28u); for ( i = 0; i \u003c strlen(s); ++i ) { if ( (i \u0026 1) != 0 ) v3 = 1; else v3 = -1; *(\u0026t + i + 10) = s[i] + v3; } strcpy(filename, \"/tmp/flag.txt\"); stream = fopen(filename, \"w\"); fprintf(stream, \"%s\\n\", u); for ( j = 0; j \u003c strlen(\u0026t); ++j ) { fseek(stream, p[j], 0); fputc(*(\u0026t + p[j]), stream); fseek(stream, 0LL, 0); fprintf(stream, \"%s\\n\", u); } fclose(stream); remove(filename); return 0; } 应该是一个文件写入的程序，打开一个文件并进行写入\n对程序进行分析应该可以看出三个部分\n初始化变量 生成flag数据 写入flag数据 查看一下静态数据：\n根据静态数据和对代码分析的结果，写一个flag生成器：\n#include #include int main() { char t[] =\" harifCTF{????????????????????????????????}\"; char s[] = \"c61b68366edeb7bdce3c6820314b7498\"; t[0] = 0x53; int i, v3; for ( i = 0; i \u003c strlen(s); ++i ) { if ( (i \u0026 1) != 0 ) v3 = 1; else v3 = -1; *(t+i+10) = s[i]+v3; } printf(\"%s\\n\",t); return 0; } 编译并运行flag生成器就可以生成flag啦！\nSharifCTF{b70c59275fcfa8aebf2d5911223c6589} 0xA csaw2013reversing2 杀软会报毒的程序，首先查一下壳\n32位无壳程序，使用IDA pro查看详细信息\nint __cdecl __noreturn main(int argc, const char **argv, const char **envp) { int v3; // ecx CHAR *lpMem; // [esp+8h] [ebp-Ch] HANDLE hHeap; // [esp+10h] [ebp-4h] hHeap = HeapCreate(0x40000u, 0, 0); lpMem = (CHAR *)HeapAlloc(hHeap, 8u, SourceSize + 1); memcpy_s(lpMem, SourceSize, \u0026unk_409B10, SourceSize); if ( !sub_40102A() \u0026\u0026 !IsDebuggerPresent() ) { MessageBoxA(0, lpMem + 1, \"Flag\", 2u); HeapFree(hHeap, 0, lpMem); HeapDestroy(hHeap); ExitProcess(0); } __debugbreak(); sub_401000(v3 + 4, lpMem); ExitProcess(0xFFFFFFFF); } 都是WIN32api的调用，尝试运行一下程序：\n应该是有些关键的语句没有执行\n可以查看下IDA pro的汇编语句\n显然是有一个Flag没有进行相应的跳转，显然有着较大的嫌疑，可以尝试去搞一搞让其跳转\n使用OD进行调试修改汇编让其进行跳转，首先定位到Flag\n000D1092 . 85C0 test eax, eax 000D1094 74 23 je short 000D10B9 000D1096 \u003e 41 inc ecx 000D1097 . 41 inc ecx 000D1098 . 41 inc ecx 000D1099 . 41 inc ecx 000D109A CC int3 000D109B . 8B55 F4 mov edx, dword ptr [ebp-C] 000D109E . E8 5DFFFFFF call 000D1000 000D10A3 EB 4A jmp short 000D10EF 000D10A5 . 6A 02 push 2 ; /Style = MB_ABORTRETRYIGNORE|MB_APPLMODAL 000D10A7 . 68 20780D00 push 000D7820 ; |Title = \"Flag\" 000D10AC . FF75 F4 push dword ptr [ebp-C] ; |Text 000D10AF . 6A 00 push 0 ; |hOwner = NULL 000D10B1 . FF15 E4600D00 call dword ptr [\u003c\u0026USER32.MessageBoxA\u003e\u003e; \\MessageBoxA 000D10B7 . EB 14 jmp short 000D10CD 000D10B9 \u003e 6A 02 push 2 ; /Style = MB_ABORTRETRYIGNORE|MB_APPLMODAL 000D10BB . 68 20780D00 push 000D7820 ; |Title = \"Flag\" 000D10C0 . 8B45 F4 mov eax, dword ptr [ebp-C] ; | 000D10C3 . 40 inc eax ; | 000D10C4 . 50 push eax ; |Text 000D10C5 . 6A 00 push 0 ; |hOwner = NULL 000D10C7 . FF15 E4600D00 call dword ptr [\u003c\u0026USER32.MessageBoxA\u003e\u003e; \\MessageBoxA 然后定位到if语句对应的汇编语句\n000D1083 . E8 A2FFFFFF call 000D102A 000D1088 . 85C0 test eax, eax 000D108A . 75 0A jnz short 000D1096 000D108C . FF15 14600D00 call dword ptr [\u003c\u0026KERNEL32.IsDebugger\u003e; [IsDebuggerPresent 000D1092 . 85C0 test eax, eax 000D1094 74 23 je short 000D10B9 000D1096 \u003e 41 inc ecx 000D1097 . 41 inc ecx 000D1098 . 41 inc ecx 000D1099 . 41 inc ecx 000D109A CC int3 000D109B . 8B55 F4 mov edx, dword ptr [ebp-C] 000D109E . E8 5DFFFFFF call 000D1000 000D10A3 EB 4A jmp short 000D10EF 关键就是对这些汇编语句进行修改来获得flag数据，运行过程中有一个int3断点应该是让程序进行终止的，然后就是je跳转语句和jmp跳转语句了。对je跳转语句进行修改和jmp跳转语句进行修改，设置断点进行调试应该就可以获得flag\n修改过的汇编语句\n000D1083 . E8 A2FFFFFF call 000D102A 000D1088 . 85C0 test eax, eax 000D108A . 75 0A jnz short 000D1096 000D108C . FF15 14600D00 call dword ptr [\u003c\u0026KERNEL32.IsDebugger\u003e; [IsDebuggerPresent 000D1092 . 85C0 test eax, eax 000D1094 90 nop 000D1095 90 nop 000D1096 \u003e 41 inc ecx 000D1097 . 41 inc ecx 000D1098 . 41 inc ecx 000D1099 . 41 inc ecx 000D109A 90 nop 000D109B . 8B55 F4 mov edx, dword ptr [ebp-C] 000D109E . E8 5DFFFFFF call 000D1000 000D10A3 EB 14 jmp short 000D10B9 然后设置断点进行调试，来获得flag\n成功得到flag\nflag{reversing_is_not_that_hard!} 0xB maze 走迷宫的题目，逆向题目中多少有些趣味的题目，来一起走迷宫吧\n首先查看一下程序信息\n64位的程序，使用x64 IDA pro查看一下\n__int64 __fastcall main(int a1, char **a2, char **a3) { __int64 v3; // rbx int v4; // eax char v5; // bp char v6; // al const char *v7; // rdi unsigned int v9; // [rsp+0h] [rbp-28h] BYREF int v10[9]; // [rsp+4h] [rbp-24h] BYREF v10[0] = 0; v9 = 0; puts(\"Input flag:\"); scanf(\"%s\", \u0026s1); if ( strlen(\u0026s1) != 24 || strncmp(\u0026s1, \"nctf{\", 5uLL) || *(\u0026byte_6010BF + 24) != 125 ) { LABEL_22: puts(\"Wrong flag!\"); exit(-1); } v3 = 5LL; if ( strlen(\u0026s1) - 1 \u003e 5 ) { while ( 1 ) { v4 = *(\u0026s1 + v3); v5 = 0; if ( v4 \u003e 78 ) { if ( (unsigned __int8)v4 == 79 ) { v6 = sub_400650(v10); goto LABEL_14; } if ( (unsigned __int8)v4 == 111 ) { v6 = sub_400660(v10); goto LABEL_14; } } else { if ( (unsigned __int8)v4 == 46 ) { v6 = sub_400670(\u0026v9); goto LABEL_14; } if ( (unsigned __int8)v4 == 48 ) { v6 = sub_400680(\u0026v9); LABEL_14: v5 = v6; goto LABEL_15; } } LABEL_15: if ( !(unsigned __int8)sub_400690(asc_601060, (unsigned int)v10[0], v9) ) goto LABEL_22; if ( ++v3 \u003e= strlen(\u0026s1) - 1 ) { if ( v5 ) break; LABEL_20: v7 = \"Wrong flag!\"; goto LABEL_21; } } } if ( asc_601060[8 * v9 + v10[0]] != 35 ) goto LABEL_20; v7 = \"Congratulations!\"; LABEL_21: puts(v7); return 0LL; } 函数的主要逻辑应该是根据输入的值来进行走迷宫的，走出迷宫即得到flag。程序中肯定存在的有迷宫的地图作为静态数据存储。所以可以尝试查看静态数据：\n果然有一个类似迷宫的数据，查看迷宫数据\n******* * **** * **** * *** *# *** *** *** ********* 需要对代码进行分析来进一步得到迷宫的大致样子\nif ( strlen(\u0026s1) != 24 || strncmp(\u0026s1, \"nctf{\", 5uLL) || *(\u0026byte_6010BF + 24) != 125 ) { LABEL_22: puts(\"Wrong flag!\"); exit(-1); } 根据这段代码可以判断出走出迷宫需要18个操作数\nwhile ( 1 ) { v4 = *(\u0026s1 + v3); v5 = 0; if ( v4 \u003e 78 ) { if ( (unsigned __int8)v4 == 'O' ) { v6 = sub_400650(v10); goto LABEL_14; } if ( (unsigned __int8)v4 == 'o' ) { v6 = sub_400660(v10); goto LABEL_14; } } else { if ( (unsigned __int8)v4 == '.' ) { v6 = sub_400670(\u0026v9); goto LABEL_14; } if ( (unsigned __int8)v4 == '0' ) { v6 = sub_400680(\u0026v9); 这些是对迷宫操作的判断，根据这些判断可以确定我们如何进行迷宫的操作\n首先根据反汇编的代码进行分析，可以发现有两个关键数据有着比较重要的作用就是v10就v9的数据，根据跟进分析，发现v10 是进行横向操作，发现v9 是纵向操作。然后根据函数内部的加或减来确定 上下左右 的方向。\n对代码进行进一步分析应该就知道对应操作：\n'O' ← 'o' → '.' ↑ '0' ↓ 根据代码的分析，迷宫应该是8x8的迷宫，可以排列出迷宫的样子\n00****** *000*00* ***0*0** **00*0** *00*#00* **0***0* **00000* ******** 根据目前的分析的结果就可以开心地走迷宫了：\no0oo00O000oooo..OO 迷宫路线即为flag，因此本题的flag为：\nnctf{o0oo00O000oooo..OO} ","wordCount":"2647","inLanguage":"en","datePublished":"2021-10-14T13:27:13+08:00","dateModified":"2021-10-14T13:27:13+08:00","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"/posts/xctf-reverse-novice_writeup/"},"publisher":{"@type":"Organization","name":"Jasmine❀Hiker","logo":{"@type":"ImageObject","url":"favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href accesskey=h title="Home (Alt + H)">Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=/categories/ title=Categories><span>Categories</span></a></li><li><a href=/tags/ title=Tags><span>Tags</span></a></li><li><a href=/posts/ title=Posts><span>Posts</span></a></li><li><a href=/about/ title=About><span>About</span></a></li><li><a href=/link/ title=Link><span>Link</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href>Home</a>&nbsp;»&nbsp;<a href=/posts/>Posts</a></div><h1 class=post-title>XCTF REVERSE novice_writeup</h1><div class=post-meta><span title='2021-10-14 13:27:13 +0800 CST'>October 14, 2021</span>&nbsp;·&nbsp;13 min&nbsp;·&nbsp;2647 words&nbsp;·&nbsp;Me</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#xctf-reverse-%e6%96%b0%e6%89%8b%e5%8c%ba-writeup aria-label="XCTF-REVERSE-新手区 writeup">XCTF-REVERSE-新手区 writeup</a><ul><li><a href=#0x0-insanity aria-label="0x0 insanity">0x0 insanity</a></li><li><a href=#0x1-python-trade aria-label="0x1 python-trade">0x1 python-trade</a></li><li><a href=#0x2-re1 aria-label="0x2 re1">0x2 re1</a></li><li><a href=#0x3-game aria-label="0x3 game">0x3 game</a></li><li><a href=#0x4-hello-ctf aria-label="0x4 Hello, CTF">0x4 Hello, CTF</a></li><li><a href=#0x5-open-source aria-label="0x5 open-source">0x5 open-source</a></li><li><a href=#0x6-simple-unpack aria-label="0x6 simple-unpack">0x6 simple-unpack</a></li><li><a href=#0x7-logmein aria-label="0x7 logmein">0x7 logmein</a></li><li><a href=#0x8-no-string-attached aria-label="0x8 no-string-attached">0x8 no-string-attached</a></li><li><a href=#0x9-getit aria-label="0x9 getit">0x9 getit</a></li><li><a href=#0xa-csaw2013reversing2 aria-label="0xA csaw2013reversing2">0xA csaw2013reversing2</a></li><li><a href=#0xb-maze aria-label="0xB maze">0xB maze</a></li></ul></li></ul></div></details></div><div class=post-content><h1 id=xctf-reverse-新手区-writeup>XCTF-REVERSE-新手区 writeup<a hidden class=anchor aria-hidden=true href=#xctf-reverse-新手区-writeup>#</a></h1><p>来XCTF平台，做做Re练练手</p><p><img loading=lazy src=/images/XCTF-REVERSE-novice_writeup/image-20210902134256690.png alt=image-20210902134256690></p><p>XCTF平台有十道题目：</p><p><img loading=lazy src=/images/XCTF-REVERSE-novice_writeup/image-20210902134352010.png alt=image-20210902134352010></p><p>十道题目应该是涵盖了逆向方向的主要内容，带着好奇心去探索逆向的世界吧</p><h2 id=0x0-insanity>0x0 insanity<a hidden class=anchor aria-hidden=true href=#0x0-insanity>#</a></h2><p>往往第一道题目都不是很难，下载附件，看看是个什么东西。</p><p>文件没有扩展名，可能是个ELF文件，走个流程</p><p>首先查一下壳</p><p><img loading=lazy src=/images/XCTF-REVERSE-novice_writeup/image-20210902135713948.png alt=image-20210902135713948></p><p>果然是ELF格式的文件，不过不是x64格式的ELF文件</p><p>使用IDA pro打开文件，查看主函数的反编译代码</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>int</span> <span class=kr>__cdecl</span> <span class=nf>main</span><span class=p>(</span><span class=kt>int</span> <span class=n>argc</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>**</span><span class=n>argv</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>**</span><span class=n>envp</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>unsigned</span> <span class=kt>int</span> <span class=n>v3</span><span class=p>;</span> <span class=c1>// eax
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>unsigned</span> <span class=kt>int</span> <span class=n>v4</span><span class=p>;</span> <span class=c1>// eax
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=nf>puts</span><span class=p>(</span><span class=s>&#34;Reticulating splines, please wait..&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>sleep</span><span class=p>(</span><span class=mi>5u</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>v3</span> <span class=o>=</span> <span class=nf>time</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>srand</span><span class=p>(</span><span class=n>v3</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>v4</span> <span class=o>=</span> <span class=nf>rand</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=nf>puts</span><span class=p>((</span><span class=o>&amp;</span><span class=n>strs</span><span class=p>)[</span><span class=n>v4</span> <span class=o>%</span> <span class=mh>0xA</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>跟进strs的数据</p><p><img loading=lazy src=/images/XCTF-REVERSE-novice_writeup/image-20210902145813017.png alt=image-20210902145813017></p><p>继续跟进strs的数据</p><p><img loading=lazy src=/images/XCTF-REVERSE-novice_writeup/image-20210902145852653.png alt=image-20210902145852653></p><p>get到了flag</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>9447{This_is_a_flag}
</span></span></code></pre></div><h2 id=0x1-python-trade>0x1 python-trade<a hidden class=anchor aria-hidden=true href=#0x1-python-trade>#</a></h2><p>看题目应该是一个Python的逆向题目</p><p>文件是一个pyc文件应该是Python的逆向文件，可以使用Python的反编译工具进行反编译</p><p>可以使用 <code>uncompyle</code> 进行反编译：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># uncompyle6 version 3.7.4</span>
</span></span><span class=line><span class=cl><span class=c1># Python bytecode 2.7 (62211)</span>
</span></span><span class=line><span class=cl><span class=c1># Decompiled from: Python 3.8.8 (default, Apr 13 2021, 15:08:03) [MSC v.1916 64 bit (AMD64)]</span>
</span></span><span class=line><span class=cl><span class=c1># Embedded file name: 1.py</span>
</span></span><span class=line><span class=cl><span class=c1># Compiled at: 2017-06-03 10:20:43</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>base64</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>encode</span><span class=p>(</span><span class=n>message</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>message</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span> <span class=o>=</span> <span class=nb>ord</span><span class=p>(</span><span class=n>i</span><span class=p>)</span> <span class=o>^</span> <span class=mi>32</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span> <span class=o>=</span> <span class=n>x</span> <span class=o>+</span> <span class=mi>16</span>
</span></span><span class=line><span class=cl>        <span class=n>s</span> <span class=o>+=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>base64</span><span class=o>.</span><span class=n>b64encode</span><span class=p>(</span><span class=n>s</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>correct</span> <span class=o>=</span> <span class=s1>&#39;XlNkVmtUI1MgXWBZXCFeKY+AaXNt&#39;</span>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=s1>&#39;Input flag:&#39;</span>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=n>raw_input</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>encode</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span> <span class=o>==</span> <span class=n>correct</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span> <span class=s1>&#39;correct&#39;</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span> <span class=s1>&#39;wrong&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># okay decompiling .\test.pyc</span>
</span></span></code></pre></div><p>应该是需要逆这个加密算法的进行求解，密码手的老本行了，写个求解脚本:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>base64</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>Redecode</span><span class=p>(</span><span class=n>cipher</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>message</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>cipher</span> <span class=o>=</span> <span class=n>base64</span><span class=o>.</span><span class=n>b64decode</span><span class=p>(</span><span class=n>cipher</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>cipher</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span> <span class=o>=</span> <span class=nb>ord</span><span class=p>(</span><span class=n>i</span><span class=p>)</span> <span class=o>-</span> <span class=mi>16</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span> <span class=o>=</span> <span class=n>x</span> <span class=o>^</span> <span class=mi>32</span>
</span></span><span class=line><span class=cl>        <span class=n>message</span> <span class=o>+=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>message</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>cipher</span> <span class=o>=</span> <span class=s1>&#39;XlNkVmtUI1MgXWBZXCFeKY+AaXNt&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=n>Redecode</span><span class=p>(</span><span class=n>cipher</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span>
</span></span></code></pre></div><p>在python2环境下运行脚本，就能得到flag了：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>nctf{d3c0mpil1n9_PyC}
</span></span></code></pre></div><h2 id=0x2-re1>0x2 re1<a hidden class=anchor aria-hidden=true href=#0x2-re1>#</a></h2><p>附件有报毒，麻了</p><p>走一下流程，先查文件信息</p><p><img loading=lazy src=/images/XCTF-REVERSE-novice_writeup/image-20210902152537015.png alt=image-20210902152537015></p><p>32位的可执行程序，程序没有壳，丢进IDA pro进行静态分析</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>int</span> <span class=kr>__cdecl</span> <span class=nf>main</span><span class=p>(</span><span class=kt>int</span> <span class=n>argc</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>**</span><span class=n>argv</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>**</span><span class=n>envp</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>v3</span><span class=p>;</span> <span class=c1>// eax
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>__m128i</span> <span class=n>v5</span><span class=p>;</span> <span class=c1>// [esp+0h] [ebp-44h] BYREF
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>char</span> <span class=n>v6</span><span class=p>[</span><span class=mi>8</span><span class=p>];</span> <span class=c1>// [esp+10h] [ebp-34h] BYREF
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>int</span> <span class=n>v7</span><span class=p>;</span> <span class=c1>// [esp+18h] [ebp-2Ch]
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>__int16</span> <span class=n>v8</span><span class=p>;</span> <span class=c1>// [esp+1Ch] [ebp-28h]
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>char</span> <span class=n>v9</span><span class=p>[</span><span class=mi>32</span><span class=p>];</span> <span class=c1>// [esp+20h] [ebp-24h] BYREF
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=n>v5</span> <span class=o>=</span> <span class=nf>_mm_loadu_si128</span><span class=p>((</span><span class=k>const</span> <span class=kr>__m128i</span> <span class=o>*</span><span class=p>)</span><span class=s>&#34;DUTCTF{We1c0met0DUTCTF}&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>v7</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nf>strcpy</span><span class=p>(</span><span class=n>v6</span><span class=p>,</span> <span class=s>&#34;DUTCTF}&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>v8</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;欢迎来到DUTCTF呦</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;这是一道很可爱很简单的逆向题呦</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;输入flag吧:&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>scanf</span><span class=p>(</span><span class=s>&#34;%s&#34;</span><span class=p>,</span> <span class=n>v9</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>v3</span> <span class=o>=</span> <span class=nf>strcmp</span><span class=p>(</span><span class=n>v5</span><span class=p>.</span><span class=n>m128i_i8</span><span class=p>,</span> <span class=n>v9</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=n>v3</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>v3</span> <span class=o>=</span> <span class=n>v3</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=o>?</span> <span class=o>-</span><span class=mi>1</span> <span class=o>:</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=n>v3</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span><span class=n>aFlag_0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>else</span>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span><span class=n>aFlagGet</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>system</span><span class=p>(</span><span class=s>&#34;pause&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>首先，我们需要知道具体的逻辑判断形式，逻辑判断是以什么形式进行判断的，找到逻辑判断语句</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span> <span class=n>v3</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>v3</span> <span class=o>=</span> <span class=n>v3</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=o>?</span> <span class=o>-</span><span class=mi>1</span> <span class=o>:</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span> <span class=n>v3</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span><span class=n>aFlag_0</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span><span class=n>aFlagGet</span><span class=p>);</span>
</span></span></code></pre></div><p><code>v3</code> 数值不为0的情况下会先执行第一个 <code>if</code> 语句，将不正确的v3值进行转换</p><p>然后再进行一个<code>if - else</code> 的逻辑语句，判断<code>v3</code>的数值，如果<code>v3</code>的数值是等于<code>0</code>的，那么我们输入的flag就是正确的</p><p>那么，<code>v3</code> 是什么东西？</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=n>v3</span> <span class=o>=</span> <span class=nf>strcmp</span><span class=p>(</span><span class=n>v5</span><span class=p>.</span><span class=n>m128i_i8</span><span class=p>,</span> <span class=n>v9</span><span class=p>);</span>
</span></span></code></pre></div><p>是一个比较数值，如果 <code>v5.m128i_i8</code> 与 <code>v9</code> 相等，那么<code>v3</code> 的数值就等于0了，逻辑现在搞通了，下面跟进数据：</p><p><img loading=lazy src=/images/XCTF-REVERSE-novice_writeup/image-20210902155119211.png alt=image-20210902155119211></p><p>这段数据应该就是 <code>v5 </code>的数据了，将数据转换成字符串</p><p><img loading=lazy src=/images/XCTF-REVERSE-novice_writeup/image-20210902155219566.png alt=image-20210902155219566></p><p>成功得到flag：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>DUTCTF{We1c0met0DUTCTF}
</span></span></code></pre></div><h2 id=0x3-game>0x3 game<a hidden class=anchor aria-hidden=true href=#0x3-game>#</a></h2><p>应该是个游戏，感觉还是挺有意思的</p><p><img loading=lazy src=/images/XCTF-REVERSE-novice_writeup/image-20210902160124008.png alt=image-20210902160124008></p><p>果然是一个游戏，还蛮有意思的，不过，还是要走下流程查一下信息</p><p><img loading=lazy src=/images/XCTF-REVERSE-novice_writeup/image-20210902160325396.png alt=image-20210902160325396></p><p>32位程序，没有壳，先丢进IDA pro康一康</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>int</span> <span class=kr>__cdecl</span> <span class=nf>main_0</span><span class=p>(</span><span class=kt>int</span> <span class=n>argc</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>**</span><span class=n>argv</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>**</span><span class=n>envp</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>i</span><span class=p>;</span> <span class=c1>// [esp+DCh] [ebp-20h]
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>int</span> <span class=n>v5</span><span class=p>;</span> <span class=c1>// [esp+F4h] [ebp-8h] BYREF
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=nf>sub_45A7BE</span><span class=p>(</span><span class=o>&amp;</span><span class=n>unk_50B110</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>sub_45A7BE</span><span class=p>(</span><span class=o>&amp;</span><span class=n>unk_50B158</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>sub_45A7BE</span><span class=p>(</span><span class=o>&amp;</span><span class=n>unk_50B1A0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>sub_45A7BE</span><span class=p>(</span><span class=o>&amp;</span><span class=n>unk_50B1E8</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>sub_45A7BE</span><span class=p>(</span><span class=o>&amp;</span><span class=n>unk_50B230</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>sub_45A7BE</span><span class=p>(</span><span class=o>&amp;</span><span class=n>unk_50B278</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>sub_45A7BE</span><span class=p>(</span><span class=o>&amp;</span><span class=n>unk_50B2C0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>sub_45A7BE</span><span class=p>(</span><span class=o>&amp;</span><span class=n>unk_50B308</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>sub_45A7BE</span><span class=p>(</span><span class=s>&#34;二                                                     |</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>sub_45A7BE</span><span class=p>(</span><span class=s>&#34;|              by 0x61                                 |</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>sub_45A7BE</span><span class=p>(</span><span class=s>&#34;|                                                      |</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>sub_45A7BE</span><span class=p>(</span><span class=s>&#34;|------------------------------------------------------|</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>sub_45A7BE</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;Play a game</span><span class=se>\n</span><span class=s>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;The n is the serial number of the lamp,and m is the state of the lamp</span><span class=se>\n</span><span class=s>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;If m of the Nth lamp is 1,it&#39;s on ,if not it&#39;s off</span><span class=se>\n</span><span class=s>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;At first all the lights were closed</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>sub_45A7BE</span><span class=p>(</span><span class=s>&#34;Now you can input n to change its state</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>sub_45A7BE</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;But you should pay attention to one thing,if you change the state of the Nth lamp,the state of (N-1)th and (N+1)th w&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;ill be changed too</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>sub_45A7BE</span><span class=p>(</span><span class=s>&#34;When all lamps are on,flag will appear</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>sub_45A7BE</span><span class=p>(</span><span class=s>&#34;Now,input n </span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>while</span> <span class=p>(</span> <span class=mi>1</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=p>(</span> <span class=mi>1</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nf>sub_45A7BE</span><span class=p>(</span><span class=s>&#34;input n,n(1-8)</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nf>sub_459418</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=nf>sub_45A7BE</span><span class=p>(</span><span class=s>&#34;n=&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nf>sub_4596D4</span><span class=p>(</span><span class=s>&#34;%d&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>v5</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nf>sub_45A7BE</span><span class=p>(</span><span class=s>&#34;</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span> <span class=n>v5</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>v5</span> <span class=o>&lt;=</span> <span class=mi>8</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=nf>sub_45A7BE</span><span class=p>(</span><span class=s>&#34;sorry,n error,try again</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span> <span class=n>v5</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nf>sub_4576D6</span><span class=p>(</span><span class=n>v5</span> <span class=o>-</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>for</span> <span class=p>(</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>8</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span> <span class=p>(</span><span class=kt>unsigned</span> <span class=kt>int</span><span class=p>)</span><span class=n>i</span> <span class=o>&gt;=</span> <span class=mi>9</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=nf>sub_458919</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>byte_532E28</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nf>sub_4581B7</span><span class=p>(</span><span class=s>&#34;CLS&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>sub_458054</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span> <span class=n>byte_532E28</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>      <span class=o>&amp;&amp;</span> <span class=n>byte_532E28</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>      <span class=o>&amp;&amp;</span> <span class=n>byte_532E28</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>      <span class=o>&amp;&amp;</span> <span class=n>byte_532E28</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>      <span class=o>&amp;&amp;</span> <span class=n>byte_532E28</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>      <span class=o>&amp;&amp;</span> <span class=n>byte_532E28</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>      <span class=o>&amp;&amp;</span> <span class=n>byte_532E28</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>      <span class=o>&amp;&amp;</span> <span class=n>byte_532E28</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nf>sub_457AB4</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>寻找到核心代码：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span> <span class=n>byte_532E28</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>      <span class=o>&amp;&amp;</span> <span class=n>byte_532E28</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>      <span class=o>&amp;&amp;</span> <span class=n>byte_532E28</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>      <span class=o>&amp;&amp;</span> <span class=n>byte_532E28</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>      <span class=o>&amp;&amp;</span> <span class=n>byte_532E28</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>      <span class=o>&amp;&amp;</span> <span class=n>byte_532E28</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>      <span class=o>&amp;&amp;</span> <span class=n>byte_532E28</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>      <span class=o>&amp;&amp;</span> <span class=n>byte_532E28</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nf>sub_457AB4</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span></code></pre></div><p>可以知道，可以确定是 <code>sub_457AB4();</code> 函数：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>int</span> <span class=nf>sub_45E940</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>char</span> <span class=n>v1</span><span class=p>;</span> <span class=c1>// [esp+0h] [ebp-164h]
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>int</span> <span class=n>i</span><span class=p>;</span> <span class=c1>// [esp+D0h] [ebp-94h]
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>char</span> <span class=n>v3</span><span class=p>[</span><span class=mi>22</span><span class=p>];</span> <span class=c1>// [esp+DCh] [ebp-88h] BYREF
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>char</span> <span class=n>v4</span><span class=p>[</span><span class=mi>32</span><span class=p>];</span> <span class=c1>// [esp+F2h] [ebp-72h] BYREF
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>char</span> <span class=n>v5</span><span class=p>[</span><span class=mi>4</span><span class=p>];</span> <span class=c1>// [esp+112h] [ebp-52h] BYREF
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>char</span> <span class=n>v6</span><span class=p>[</span><span class=mi>64</span><span class=p>];</span> <span class=c1>// [esp+120h] [ebp-44h]
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=nf>sub_45A7BE</span><span class=p>((</span><span class=kt>int</span><span class=p>)</span><span class=s>&#34;done!!! the flag is &#34;</span><span class=p>,</span> <span class=n>v1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>18</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=mi>64</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=mi>98</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=mi>5</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=mi>2</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=o>=</span> <span class=mi>4</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span> <span class=o>=</span> <span class=mi>6</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span> <span class=o>=</span> <span class=mi>3</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>8</span><span class=p>]</span> <span class=o>=</span> <span class=mi>6</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>9</span><span class=p>]</span> <span class=o>=</span> <span class=mi>48</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>10</span><span class=p>]</span> <span class=o>=</span> <span class=mi>49</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>11</span><span class=p>]</span> <span class=o>=</span> <span class=mi>65</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>12</span><span class=p>]</span> <span class=o>=</span> <span class=mi>32</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>13</span><span class=p>]</span> <span class=o>=</span> <span class=mi>12</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>14</span><span class=p>]</span> <span class=o>=</span> <span class=mi>48</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>15</span><span class=p>]</span> <span class=o>=</span> <span class=mi>65</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>16</span><span class=p>]</span> <span class=o>=</span> <span class=mi>31</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>17</span><span class=p>]</span> <span class=o>=</span> <span class=mi>78</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>18</span><span class=p>]</span> <span class=o>=</span> <span class=mi>62</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>19</span><span class=p>]</span> <span class=o>=</span> <span class=mi>32</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>20</span><span class=p>]</span> <span class=o>=</span> <span class=mi>49</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>21</span><span class=p>]</span> <span class=o>=</span> <span class=mi>32</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>22</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>23</span><span class=p>]</span> <span class=o>=</span> <span class=mi>57</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>24</span><span class=p>]</span> <span class=o>=</span> <span class=mi>96</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>25</span><span class=p>]</span> <span class=o>=</span> <span class=mi>3</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>26</span><span class=p>]</span> <span class=o>=</span> <span class=mi>21</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>27</span><span class=p>]</span> <span class=o>=</span> <span class=mi>9</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>28</span><span class=p>]</span> <span class=o>=</span> <span class=mi>4</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>29</span><span class=p>]</span> <span class=o>=</span> <span class=mi>62</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>30</span><span class=p>]</span> <span class=o>=</span> <span class=mi>3</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>31</span><span class=p>]</span> <span class=o>=</span> <span class=mi>5</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>32</span><span class=p>]</span> <span class=o>=</span> <span class=mi>4</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>33</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>34</span><span class=p>]</span> <span class=o>=</span> <span class=mi>2</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>35</span><span class=p>]</span> <span class=o>=</span> <span class=mi>3</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>36</span><span class=p>]</span> <span class=o>=</span> <span class=mi>44</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>37</span><span class=p>]</span> <span class=o>=</span> <span class=mi>65</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>38</span><span class=p>]</span> <span class=o>=</span> <span class=mi>78</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>39</span><span class=p>]</span> <span class=o>=</span> <span class=mi>32</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>40</span><span class=p>]</span> <span class=o>=</span> <span class=mi>16</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>41</span><span class=p>]</span> <span class=o>=</span> <span class=mi>97</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>42</span><span class=p>]</span> <span class=o>=</span> <span class=mi>54</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>43</span><span class=p>]</span> <span class=o>=</span> <span class=mi>16</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>44</span><span class=p>]</span> <span class=o>=</span> <span class=mi>44</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>45</span><span class=p>]</span> <span class=o>=</span> <span class=mi>52</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>46</span><span class=p>]</span> <span class=o>=</span> <span class=mi>32</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>47</span><span class=p>]</span> <span class=o>=</span> <span class=mi>64</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>48</span><span class=p>]</span> <span class=o>=</span> <span class=mi>89</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>49</span><span class=p>]</span> <span class=o>=</span> <span class=mi>45</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>50</span><span class=p>]</span> <span class=o>=</span> <span class=mi>32</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>51</span><span class=p>]</span> <span class=o>=</span> <span class=mi>65</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>52</span><span class=p>]</span> <span class=o>=</span> <span class=mi>15</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>53</span><span class=p>]</span> <span class=o>=</span> <span class=mi>34</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>54</span><span class=p>]</span> <span class=o>=</span> <span class=mi>18</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>55</span><span class=p>]</span> <span class=o>=</span> <span class=mi>16</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span><span class=p>[</span><span class=mi>56</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v3</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>123</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v3</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=mi>32</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v3</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=mi>18</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v3</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=mi>98</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v3</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=mi>119</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v3</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=o>=</span> <span class=mi>108</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v3</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span> <span class=o>=</span> <span class=mi>65</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v3</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span> <span class=o>=</span> <span class=mi>41</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v3</span><span class=p>[</span><span class=mi>8</span><span class=p>]</span> <span class=o>=</span> <span class=mi>124</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v3</span><span class=p>[</span><span class=mi>9</span><span class=p>]</span> <span class=o>=</span> <span class=mi>80</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v3</span><span class=p>[</span><span class=mi>10</span><span class=p>]</span> <span class=o>=</span> <span class=mi>125</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v3</span><span class=p>[</span><span class=mi>11</span><span class=p>]</span> <span class=o>=</span> <span class=mi>38</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v3</span><span class=p>[</span><span class=mi>12</span><span class=p>]</span> <span class=o>=</span> <span class=mi>124</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v3</span><span class=p>[</span><span class=mi>13</span><span class=p>]</span> <span class=o>=</span> <span class=mi>111</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v3</span><span class=p>[</span><span class=mi>14</span><span class=p>]</span> <span class=o>=</span> <span class=mi>74</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v3</span><span class=p>[</span><span class=mi>15</span><span class=p>]</span> <span class=o>=</span> <span class=mi>49</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v3</span><span class=p>[</span><span class=mi>16</span><span class=p>]</span> <span class=o>=</span> <span class=mi>83</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v3</span><span class=p>[</span><span class=mi>17</span><span class=p>]</span> <span class=o>=</span> <span class=mi>108</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v3</span><span class=p>[</span><span class=mi>18</span><span class=p>]</span> <span class=o>=</span> <span class=mi>94</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v3</span><span class=p>[</span><span class=mi>19</span><span class=p>]</span> <span class=o>=</span> <span class=mi>108</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v3</span><span class=p>[</span><span class=mi>20</span><span class=p>]</span> <span class=o>=</span> <span class=mi>84</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v3</span><span class=p>[</span><span class=mi>21</span><span class=p>]</span> <span class=o>=</span> <span class=mi>6</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nf>qmemcpy</span><span class=p>(</span><span class=n>v4</span><span class=p>,</span> <span class=s>&#34;`S,yhn _uec{&#34;</span><span class=p>,</span> <span class=mi>12</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>v4</span><span class=p>[</span><span class=mi>12</span><span class=p>]</span> <span class=o>=</span> <span class=mi>127</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v4</span><span class=p>[</span><span class=mi>13</span><span class=p>]</span> <span class=o>=</span> <span class=mi>119</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v4</span><span class=p>[</span><span class=mi>14</span><span class=p>]</span> <span class=o>=</span> <span class=mi>96</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v4</span><span class=p>[</span><span class=mi>15</span><span class=p>]</span> <span class=o>=</span> <span class=mi>48</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v4</span><span class=p>[</span><span class=mi>16</span><span class=p>]</span> <span class=o>=</span> <span class=mi>107</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v4</span><span class=p>[</span><span class=mi>17</span><span class=p>]</span> <span class=o>=</span> <span class=mi>71</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v4</span><span class=p>[</span><span class=mi>18</span><span class=p>]</span> <span class=o>=</span> <span class=mi>92</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v4</span><span class=p>[</span><span class=mi>19</span><span class=p>]</span> <span class=o>=</span> <span class=mi>29</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v4</span><span class=p>[</span><span class=mi>20</span><span class=p>]</span> <span class=o>=</span> <span class=mi>81</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v4</span><span class=p>[</span><span class=mi>21</span><span class=p>]</span> <span class=o>=</span> <span class=mi>107</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v4</span><span class=p>[</span><span class=mi>22</span><span class=p>]</span> <span class=o>=</span> <span class=mi>90</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v4</span><span class=p>[</span><span class=mi>23</span><span class=p>]</span> <span class=o>=</span> <span class=mi>85</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v4</span><span class=p>[</span><span class=mi>24</span><span class=p>]</span> <span class=o>=</span> <span class=mi>64</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v4</span><span class=p>[</span><span class=mi>25</span><span class=p>]</span> <span class=o>=</span> <span class=mi>12</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v4</span><span class=p>[</span><span class=mi>26</span><span class=p>]</span> <span class=o>=</span> <span class=mi>43</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v4</span><span class=p>[</span><span class=mi>27</span><span class=p>]</span> <span class=o>=</span> <span class=mi>76</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v4</span><span class=p>[</span><span class=mi>28</span><span class=p>]</span> <span class=o>=</span> <span class=mi>86</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v4</span><span class=p>[</span><span class=mi>29</span><span class=p>]</span> <span class=o>=</span> <span class=mi>13</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v4</span><span class=p>[</span><span class=mi>30</span><span class=p>]</span> <span class=o>=</span> <span class=mi>114</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v4</span><span class=p>[</span><span class=mi>31</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nf>strcpy</span><span class=p>(</span><span class=n>v5</span><span class=p>,</span> <span class=s>&#34;u~&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>56</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>v3</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>^=</span> <span class=n>v6</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=n>v3</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>^=</span> <span class=mh>0x13u</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nf>sub_45A7BE</span><span class=p>((</span><span class=kt>int</span><span class=p>)</span><span class=s>&#34;%s</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=p>(</span><span class=kt>char</span><span class=p>)</span><span class=n>v3</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>基本上可以确定在这里输出flag，基本逻辑应该可以清晰的知道</p><p>下面使用Ollydbg进行动态调试，调试出来flag</p><p><img loading=lazy src=/images/XCTF-REVERSE-novice_writeup/image-20210909174908510.png alt=image-20210909174908510></p><p>先使用F8进行单步调试，确定关键函数位置</p><p><img loading=lazy src=/images/XCTF-REVERSE-novice_writeup/image-20210909195648745.png alt=image-20210909195648745></p><p>F7进入函数的具体执行过程，进行字符串检索</p><p><img loading=lazy src=/images/XCTF-REVERSE-novice_writeup/image-20210909195755383.png alt=image-20210909195755383></p><p>找到输入的关键位置，然后移动到关键位置</p><p><img loading=lazy src=/images/XCTF-REVERSE-novice_writeup/image-20210909195839072.png alt=image-20210909195839072></p><p>根据已知的逻辑循环，修改逻辑循环</p><p><img loading=lazy src=/images/XCTF-REVERSE-novice_writeup/image-20210909200656065.png alt=image-20210909200656065></p><p>修改这个关键性的跳转代码进行跳转修改，将跳转修改为call那个位置</p><p>修改为：</p><pre tabindex=0><code class=language-x86asm data-lang=x86asm>jnz short 00D2F66C
</code></pre><p>然后运行修改过汇编的程序</p><p>尝试输入几个参数就能获取到flag了</p><p><img loading=lazy src=/images/XCTF-REVERSE-novice_writeup/image-20210909201014405.png alt=image-20210909201014405></p><p>得到flag</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>zsctf{T9is_tOpic_1s_v5ry_int7resting_b6t_others_are_n0t}
</span></span></code></pre></div><h2 id=0x4-hello-ctf>0x4 Hello, CTF<a hidden class=anchor aria-hidden=true href=#0x4-hello-ctf>#</a></h2><p>首先查一下程序信息</p><p><img loading=lazy src=/images/XCTF-REVERSE-novice_writeup/image-20210909201418156.png alt=image-20210909201418156></p><p>32位没有壳的程序</p><p>使用IDA pro的看一下程序</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>int</span> <span class=kr>__cdecl</span> <span class=nf>main</span><span class=p>(</span><span class=kt>int</span> <span class=n>argc</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>**</span><span class=n>argv</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>**</span><span class=n>envp</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>i</span><span class=p>;</span> <span class=c1>// ebx
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>char</span> <span class=n>v4</span><span class=p>;</span> <span class=c1>// al
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>int</span> <span class=n>result</span><span class=p>;</span> <span class=c1>// eax
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>int</span> <span class=n>v6</span><span class=p>;</span> <span class=c1>// [esp+0h] [ebp-70h]
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>int</span> <span class=n>v7</span><span class=p>;</span> <span class=c1>// [esp+0h] [ebp-70h]
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>char</span> <span class=n>Buffer</span><span class=p>[</span><span class=mi>2</span><span class=p>];</span> <span class=c1>// [esp+12h] [ebp-5Eh] BYREF
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>char</span> <span class=n>v9</span><span class=p>[</span><span class=mi>20</span><span class=p>];</span> <span class=c1>// [esp+14h] [ebp-5Ch] BYREF
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>char</span> <span class=n>v10</span><span class=p>[</span><span class=mi>32</span><span class=p>];</span> <span class=c1>// [esp+28h] [ebp-48h] BYREF
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>__int16</span> <span class=n>v11</span><span class=p>;</span> <span class=c1>// [esp+48h] [ebp-28h]
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>char</span> <span class=n>v12</span><span class=p>;</span> <span class=c1>// [esp+4Ah] [ebp-26h]
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>char</span> <span class=n>v13</span><span class=p>[</span><span class=mi>36</span><span class=p>];</span> <span class=c1>// [esp+4Ch] [ebp-24h] BYREF
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=nf>strcpy</span><span class=p>(</span><span class=n>v13</span><span class=p>,</span> <span class=s>&#34;437261636b4d654a757374466f7246756e&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>while</span> <span class=p>(</span> <span class=mi>1</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>memset</span><span class=p>(</span><span class=n>v10</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>v10</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=n>v11</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>v12</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nf>sub_40134B</span><span class=p>(</span><span class=n>aPleaseInputYou</span><span class=p>,</span> <span class=n>v6</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>scanf</span><span class=p>(</span><span class=s>&#34;%s&#34;</span><span class=p>,</span> <span class=n>v9</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span> <span class=nf>strlen</span><span class=p>(</span><span class=n>v9</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mh>0x11</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>17</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>v4</span> <span class=o>=</span> <span class=n>v9</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span> <span class=o>!</span><span class=n>v4</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=nf>sprintf</span><span class=p>(</span><span class=n>Buffer</span><span class=p>,</span> <span class=s>&#34;%x&#34;</span><span class=p>,</span> <span class=n>v4</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nf>strcat</span><span class=p>(</span><span class=n>v10</span><span class=p>,</span> <span class=n>Buffer</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span> <span class=o>!</span><span class=nf>strcmp</span><span class=p>(</span><span class=n>v10</span><span class=p>,</span> <span class=n>v13</span><span class=p>)</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=nf>sub_40134B</span><span class=p>(</span><span class=n>aSuccess</span><span class=p>,</span> <span class=n>v7</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span>
</span></span><span class=line><span class=cl>      <span class=nf>sub_40134B</span><span class=p>(</span><span class=n>aWrong</span><span class=p>,</span> <span class=n>v7</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=nf>sub_40134B</span><span class=p>(</span><span class=n>aWrong</span><span class=p>,</span> <span class=n>v7</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>result</span> <span class=o>=</span> <span class=o>--</span><span class=n>Stream</span><span class=p>.</span><span class=n>_cnt</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=n>Stream</span><span class=p>.</span><span class=n>_cnt</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nf>_filbuf</span><span class=p>(</span><span class=o>&amp;</span><span class=n>Stream</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=o>++</span><span class=n>Stream</span><span class=p>.</span><span class=n>_ptr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>result</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>代码非常清晰，应该可以明确v13的值和flag应该是一致的</p><p>v13应该是Hex编码的字符串，进行解码就得到flag了</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>CrackMeJustForFun
</span></span></code></pre></div><h2 id=0x5-open-source>0x5 open-source<a hidden class=anchor aria-hidden=true href=#0x5-open-source>#</a></h2><p>下载附件，源代码审计，看看源代码内容</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;string.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>(</span><span class=kt>int</span> <span class=n>argc</span><span class=p>,</span> <span class=kt>char</span> <span class=o>*</span><span class=n>argv</span><span class=p>[])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>argc</span> <span class=o>!=</span> <span class=mi>4</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    	<span class=nf>printf</span><span class=p>(</span><span class=s>&#34;what?</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    	<span class=nf>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>unsigned</span> <span class=kt>int</span> <span class=n>first</span> <span class=o>=</span> <span class=nf>atoi</span><span class=p>(</span><span class=n>argv</span><span class=p>[</span><span class=mi>1</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>first</span> <span class=o>!=</span> <span class=mh>0xcafe</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    	<span class=nf>printf</span><span class=p>(</span><span class=s>&#34;you are wrong, sorry.</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    	<span class=nf>exit</span><span class=p>(</span><span class=mi>2</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>unsigned</span> <span class=kt>int</span> <span class=n>second</span> <span class=o>=</span> <span class=nf>atoi</span><span class=p>(</span><span class=n>argv</span><span class=p>[</span><span class=mi>2</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>second</span> <span class=o>%</span> <span class=mi>5</span> <span class=o>==</span> <span class=mi>3</span> <span class=o>||</span> <span class=n>second</span> <span class=o>%</span> <span class=mi>17</span> <span class=o>!=</span> <span class=mi>8</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    	<span class=nf>printf</span><span class=p>(</span><span class=s>&#34;ha, you won&#39;t get it!</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    	<span class=nf>exit</span><span class=p>(</span><span class=mi>3</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nf>strcmp</span><span class=p>(</span><span class=s>&#34;h4cky0u&#34;</span><span class=p>,</span> <span class=n>argv</span><span class=p>[</span><span class=mi>3</span><span class=p>]))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    	<span class=nf>printf</span><span class=p>(</span><span class=s>&#34;so close, dude!</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    	<span class=nf>exit</span><span class=p>(</span><span class=mi>4</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;Brr wrrr grr</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>unsigned</span> <span class=kt>int</span> <span class=n>hash</span> <span class=o>=</span> <span class=n>first</span> <span class=o>*</span> <span class=mi>31337</span> <span class=o>+</span> <span class=p>(</span><span class=n>second</span> <span class=o>%</span> <span class=mi>17</span><span class=p>)</span> <span class=o>*</span> <span class=mi>11</span> <span class=o>+</span> <span class=nf>strlen</span><span class=p>(</span><span class=n>argv</span><span class=p>[</span><span class=mi>3</span><span class=p>])</span> <span class=o>-</span> <span class=mi>1615810207</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;Get your key: &#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;%x</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>hash</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>根据源码进行求解，其实也就是解个方程</p><p>可以写个C程序直接求解</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;string.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>unsigned</span> <span class=kt>int</span> <span class=n>first</span> <span class=o>=</span>  <span class=mh>0xcafe</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>unsigned</span> <span class=kt>int</span> <span class=n>second</span> <span class=o>=</span> <span class=mi>25</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>char</span> <span class=o>*</span> <span class=n>Third</span> <span class=o>=</span> <span class=s>&#34;h4cky0u&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>unsigned</span> <span class=kt>int</span> <span class=n>hash</span> <span class=o>=</span> <span class=n>first</span> <span class=o>*</span> <span class=mi>31337</span> <span class=o>+</span> <span class=p>(</span><span class=n>second</span> <span class=o>%</span> <span class=mi>17</span><span class=p>)</span> <span class=o>*</span> <span class=mi>11</span> <span class=o>+</span> <span class=nf>strlen</span><span class=p>(</span><span class=n>Third</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1615810207</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;Get your key: &#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;%x</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>hash</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>编译并运行程序就能得到flag：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Get your key: c0ffee
</span></span></code></pre></div><h2 id=0x6-simple-unpack>0x6 simple-unpack<a hidden class=anchor aria-hidden=true href=#0x6-simple-unpack>#</a></h2><p>看题目，应该是一个有壳的程序</p><p>就正常走一下流程首先先要看看程序的信息</p><p><img loading=lazy src=/images/XCTF-REVERSE-novice_writeup/image-20210910132745520.png alt=image-20210910132745520></p><p>加壳的64位的程序，首先使用upx脱一下壳，然后使用x64 IDA pro查看</p><p><img loading=lazy src=/images/XCTF-REVERSE-novice_writeup/image-20210910133500403.png alt=image-20210910133500403></p><p>直接就能看到flag信息数据</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>flag{Upx_1s_n0t_a_d3liv3r_c0mp4ny}
</span></span></code></pre></div><h2 id=0x7-logmein>0x7 logmein<a hidden class=anchor aria-hidden=true href=#0x7-logmein>#</a></h2><p>查一下程序信息</p><p><img loading=lazy src=/images/XCTF-REVERSE-novice_writeup/image-20210910133947331.png alt=image-20210910133947331></p><p>没有壳，64位的Linux程序</p><p>直接进行x64 ida pro静态调试</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>void</span> <span class=kr>__fastcall</span> <span class=n>__noreturn</span> <span class=nf>main</span><span class=p>(</span><span class=kt>int</span> <span class=n>a1</span><span class=p>,</span> <span class=kt>char</span> <span class=o>**</span><span class=n>a2</span><span class=p>,</span> <span class=kt>char</span> <span class=o>**</span><span class=n>a3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>size_t</span> <span class=n>v3</span><span class=p>;</span> <span class=c1>// rsi
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>int</span> <span class=n>i</span><span class=p>;</span> <span class=c1>// [rsp+3Ch] [rbp-54h]
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>char</span> <span class=n>s</span><span class=p>[</span><span class=mi>36</span><span class=p>];</span> <span class=c1>// [rsp+40h] [rbp-50h] BYREF
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>int</span> <span class=n>v6</span><span class=p>;</span> <span class=c1>// [rsp+64h] [rbp-2Ch]
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>__int64</span> <span class=n>v7</span><span class=p>;</span> <span class=c1>// [rsp+68h] [rbp-28h]
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>char</span> <span class=n>v8</span><span class=p>[</span><span class=mi>28</span><span class=p>];</span> <span class=c1>// [rsp+70h] [rbp-20h] BYREF
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>int</span> <span class=n>v9</span><span class=p>;</span> <span class=c1>// [rsp+8Ch] [rbp-4h]
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=n>v9</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nf>strcpy</span><span class=p>(</span><span class=n>v8</span><span class=p>,</span> <span class=s>&#34;:</span><span class=se>\&#34;</span><span class=s>AL_RT^L*.?+6/46&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>v7</span> <span class=o>=</span> <span class=mh>0x65626D61726168LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v6</span> <span class=o>=</span> <span class=mi>7</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;Welcome to the RC3 secure password guesser.</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;To continue, you must enter the correct password.</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;Enter your guess: &#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>__isoc99_scanf</span><span class=p>(</span><span class=s>&#34;%32s&#34;</span><span class=p>,</span> <span class=n>s</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>v3</span> <span class=o>=</span> <span class=nf>strlen</span><span class=p>(</span><span class=n>s</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=n>v3</span> <span class=o>&lt;</span> <span class=nf>strlen</span><span class=p>(</span><span class=n>v8</span><span class=p>)</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nf>sub_4007C0</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=nf>strlen</span><span class=p>(</span><span class=n>s</span><span class=p>);</span> <span class=o>++</span><span class=n>i</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span> <span class=n>i</span> <span class=o>&gt;=</span> <span class=nf>strlen</span><span class=p>(</span><span class=n>v8</span><span class=p>)</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=nf>sub_4007C0</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span> <span class=n>s</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>!=</span> <span class=p>(</span><span class=kt>char</span><span class=p>)(</span><span class=o>*</span><span class=p>((</span><span class=n>_BYTE</span> <span class=o>*</span><span class=p>)</span><span class=o>&amp;</span><span class=n>v7</span> <span class=o>+</span> <span class=n>i</span> <span class=o>%</span> <span class=n>v6</span><span class=p>)</span> <span class=o>^</span> <span class=n>v8</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=nf>sub_4007C0</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=nf>sub_4007F0</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>应该是对算法进行逆向来得到相应的flag</p><p>关键的数据是v7和v8，针对这两个数据写个C程序进行逆向算法</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;string.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>char</span> <span class=n>v8</span><span class=p>[</span><span class=mi>28</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=nf>strcpy</span><span class=p>(</span><span class=n>v8</span><span class=p>,</span> <span class=s>&#34;:</span><span class=se>\&#34;</span><span class=s>AL_RT^L*.?+6/46&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=kt>char</span> <span class=o>*</span><span class=n>v7</span> <span class=o>=</span> <span class=s>&#34;harambe&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>v6</span> <span class=o>=</span> <span class=mi>7</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kt>char</span> <span class=n>s</span><span class=p>[</span><span class=nf>strlen</span><span class=p>(</span><span class=n>v8</span><span class=p>)];</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=nf>strlen</span><span class=p>(</span><span class=n>v8</span><span class=p>);</span> <span class=o>++</span><span class=n>i</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>s</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=o>*</span><span class=p>(</span><span class=n>v7</span><span class=o>+</span><span class=n>i</span> <span class=o>%</span> <span class=n>v6</span><span class=p>)</span> <span class=o>^</span> <span class=n>v8</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;%s</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span><span class=n>s</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>编译并运行得到flag</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>RC3-2016-XORISGUD
</span></span></code></pre></div><h2 id=0x8-no-string-attached>0x8 no-string-attached<a hidden class=anchor aria-hidden=true href=#0x8-no-string-attached>#</a></h2><p>查一下文件的信息</p><p><img loading=lazy src=/images/XCTF-REVERSE-novice_writeup/image-20210910153107869.png alt=image-20210910153107869></p><p>32位文件，没有壳，丢进到IDA pro查看</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>int</span> <span class=kr>__cdecl</span> <span class=nf>main</span><span class=p>(</span><span class=kt>int</span> <span class=n>argc</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>**</span><span class=n>argv</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>**</span><span class=n>envp</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nf>setlocale</span><span class=p>(</span><span class=mi>6</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>locale</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>banner</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=nf>prompt_authentication</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=nf>authenticate</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>进行分析，确定flag应该是在 <code>authenticate()</code>函数中</p><p>跟进到 <code>authenticate()</code>函数</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>void</span> <span class=nf>authenticate</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>wchar_t</span> <span class=n>ws</span><span class=p>[</span><span class=mi>8192</span><span class=p>];</span> <span class=c1>// [esp+1Ch] [ebp-800Ch] BYREF
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>wchar_t</span> <span class=o>*</span><span class=n>s2</span><span class=p>;</span> <span class=c1>// [esp+801Ch] [ebp-Ch]
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=n>s2</span> <span class=o>=</span> <span class=p>(</span><span class=kt>wchar_t</span> <span class=o>*</span><span class=p>)</span><span class=nf>decrypt</span><span class=p>((</span><span class=kt>wchar_t</span> <span class=o>*</span><span class=p>)</span><span class=o>&amp;</span><span class=n>s</span><span class=p>,</span> <span class=p>(</span><span class=kt>wchar_t</span> <span class=o>*</span><span class=p>)</span><span class=o>&amp;</span><span class=n>dword_8048A90</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=nf>fgetws</span><span class=p>(</span><span class=n>ws</span><span class=p>,</span> <span class=mh>0x2000</span><span class=p>,</span> <span class=n>stdin</span><span class=p>)</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>ws</span><span class=p>[</span><span class=nf>wcslen</span><span class=p>(</span><span class=n>ws</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span> <span class=o>!</span><span class=nf>wcscmp</span><span class=p>(</span><span class=n>ws</span><span class=p>,</span> <span class=n>s2</span><span class=p>)</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=nf>wprintf</span><span class=p>(</span><span class=o>&amp;</span><span class=n>unk_8048B44</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span>
</span></span><span class=line><span class=cl>      <span class=nf>wprintf</span><span class=p>(</span><span class=o>&amp;</span><span class=n>unk_8048BA4</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=nf>free</span><span class=p>(</span><span class=n>s2</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>关键数据应该是在s2中，调用了decrypt函数，看一下这个函数的汇编代码</p><pre tabindex=0><code class=language-x86asm data-lang=x86asm>ws= dword ptr -800Ch
s2= dword ptr -0Ch

; __unwind {
push    ebp
mov     ebp, esp
sub     esp, 8028h
mov     dword ptr [esp+4], offset dword_8048A90 ; wchar_t *
mov     dword ptr [esp], offset s ; s
call    decrypt
mov     [ebp+s2], eax
mov     eax, ds:stdin@@GLIBC_2_0
mov     [esp+8], eax    ; stream
mov     dword ptr [esp+4], 2000h ; n
lea     eax, [ebp+ws]
mov     [esp], eax      ; ws
call    _fgetws
test    eax, eax
jz      short loc_804879C
</code></pre><p>根据汇编代码，应该可以清晰的知道，flag数据应该是存储在eax寄存器中了</p><p>使用gdb动态调试程序</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>gdb Re_demo
</span></span></code></pre></div><p>然后设置断点，根据刚刚了解到的信息，flag的数据应该是在decrypt函数中，设置断点</p><pre tabindex=0><code class=language-gdb data-lang=gdb>b decrypt
</code></pre><p>然后运行程序到断点</p><pre tabindex=0><code class=language-gdb data-lang=gdb>r
</code></pre><p>然后单步执行</p><pre tabindex=0><code class=language-gdb data-lang=gdb>n
</code></pre><p>查看寄存器</p><pre tabindex=0><code class=language-gdb data-lang=gdb>i r
</code></pre><p><img loading=lazy src=/images/XCTF-REVERSE-novice_writeup/image-20210910155818798.png alt=image-20210910155818798></p><p>然后查看eax寄存器存储的数据</p><pre tabindex=0><code class=language-gdb data-lang=gdb>x/sw $eax
</code></pre><p><img loading=lazy src=/images/XCTF-REVERSE-novice_writeup/image-20210910155914675.png alt=image-20210910155914675></p><p>成功拿到flag数据</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>9447{you_are_an_international_mystery}
</span></span></code></pre></div><h2 id=0x9-getit>0x9 getit<a hidden class=anchor aria-hidden=true href=#0x9-getit>#</a></h2><p>基本流程，查看程序信息</p><p><img loading=lazy src=/images/XCTF-REVERSE-novice_writeup/image-20210910160228522.png alt=image-20210910160228522></p><p>64位无壳的ELF可执行程序</p><p>先丢进x64 IDA pro看一看</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>int</span> <span class=kr>__cdecl</span> <span class=nf>main</span><span class=p>(</span><span class=kt>int</span> <span class=n>argc</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>**</span><span class=n>argv</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>**</span><span class=n>envp</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>char</span> <span class=n>v3</span><span class=p>;</span> <span class=c1>// al
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>int</span> <span class=n>i</span><span class=p>;</span> <span class=c1>// [rsp+0h] [rbp-40h]
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>int</span> <span class=n>j</span><span class=p>;</span> <span class=c1>// [rsp+4h] [rbp-3Ch]
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>FILE</span> <span class=o>*</span><span class=n>stream</span><span class=p>;</span> <span class=c1>// [rsp+8h] [rbp-38h]
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>char</span> <span class=n>filename</span><span class=p>[</span><span class=mi>24</span><span class=p>];</span> <span class=c1>// [rsp+10h] [rbp-30h] BYREF
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>unsigned</span> <span class=kr>__int64</span> <span class=n>v9</span><span class=p>;</span> <span class=c1>// [rsp+28h] [rbp-18h]
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=n>v9</span> <span class=o>=</span> <span class=nf>__readfsqword</span><span class=p>(</span><span class=mh>0x28u</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=nf>strlen</span><span class=p>(</span><span class=n>s</span><span class=p>);</span> <span class=o>++</span><span class=n>i</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span> <span class=p>(</span><span class=n>i</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=n>v3</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span>
</span></span><span class=line><span class=cl>      <span class=n>v3</span> <span class=o>=</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=o>*</span><span class=p>(</span><span class=o>&amp;</span><span class=n>t</span> <span class=o>+</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>10</span><span class=p>)</span> <span class=o>=</span> <span class=n>s</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>+</span> <span class=n>v3</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=nf>strcpy</span><span class=p>(</span><span class=n>filename</span><span class=p>,</span> <span class=s>&#34;/tmp/flag.txt&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>stream</span> <span class=o>=</span> <span class=nf>fopen</span><span class=p>(</span><span class=n>filename</span><span class=p>,</span> <span class=s>&#34;w&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>fprintf</span><span class=p>(</span><span class=n>stream</span><span class=p>,</span> <span class=s>&#34;%s</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>u</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=nf>strlen</span><span class=p>(</span><span class=o>&amp;</span><span class=n>t</span><span class=p>);</span> <span class=o>++</span><span class=n>j</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>fseek</span><span class=p>(</span><span class=n>stream</span><span class=p>,</span> <span class=n>p</span><span class=p>[</span><span class=n>j</span><span class=p>],</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>fputc</span><span class=p>(</span><span class=o>*</span><span class=p>(</span><span class=o>&amp;</span><span class=n>t</span> <span class=o>+</span> <span class=n>p</span><span class=p>[</span><span class=n>j</span><span class=p>]),</span> <span class=n>stream</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>fseek</span><span class=p>(</span><span class=n>stream</span><span class=p>,</span> <span class=mi>0LL</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>fprintf</span><span class=p>(</span><span class=n>stream</span><span class=p>,</span> <span class=s>&#34;%s</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>u</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=nf>fclose</span><span class=p>(</span><span class=n>stream</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>remove</span><span class=p>(</span><span class=n>filename</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>应该是一个文件写入的程序，打开一个文件并进行写入</p><p>对程序进行分析应该可以看出三个部分</p><ol><li>初始化变量</li><li>生成flag数据</li><li>写入flag数据</li></ol><p>查看一下静态数据：</p><p><img loading=lazy src=/images/XCTF-REVERSE-novice_writeup/image-20210911072552068.png alt=image-20210911072552068></p><p>根据静态数据和对代码分析的结果，写一个flag生成器：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;string.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>char</span> <span class=n>t</span><span class=p>[]</span> <span class=o>=</span><span class=s>&#34; harifCTF{????????????????????????????????}&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kt>char</span> <span class=n>s</span><span class=p>[]</span> <span class=o>=</span> <span class=s>&#34;c61b68366edeb7bdce3c6820314b7498&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>t</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mh>0x53</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=n>v3</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=nf>strlen</span><span class=p>(</span><span class=n>s</span><span class=p>);</span> <span class=o>++</span><span class=n>i</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span> <span class=p>(</span><span class=n>i</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=n>v3</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span>
</span></span><span class=line><span class=cl>                        <span class=n>v3</span> <span class=o>=</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=o>*</span><span class=p>(</span><span class=n>t</span><span class=o>+</span><span class=n>i</span><span class=o>+</span><span class=mi>10</span><span class=p>)</span> <span class=o>=</span> <span class=n>s</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>+</span><span class=n>v3</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;%s</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span><span class=n>t</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>编译并运行flag生成器就可以生成flag啦！</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>SharifCTF{b70c59275fcfa8aebf2d5911223c6589}
</span></span></code></pre></div><h2 id=0xa-csaw2013reversing2>0xA csaw2013reversing2<a hidden class=anchor aria-hidden=true href=#0xa-csaw2013reversing2>#</a></h2><p>杀软会报毒的程序，首先查一下壳</p><p><img loading=lazy src=/images/XCTF-REVERSE-novice_writeup/image-20210911082611406.png alt=image-20210911082611406></p><p>32位无壳程序，使用IDA pro查看详细信息</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>int</span> <span class=kr>__cdecl</span> <span class=n>__noreturn</span> <span class=nf>main</span><span class=p>(</span><span class=kt>int</span> <span class=n>argc</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>**</span><span class=n>argv</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>**</span><span class=n>envp</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>v3</span><span class=p>;</span> <span class=c1>// ecx
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>CHAR</span> <span class=o>*</span><span class=n>lpMem</span><span class=p>;</span> <span class=c1>// [esp+8h] [ebp-Ch]
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>HANDLE</span> <span class=n>hHeap</span><span class=p>;</span> <span class=c1>// [esp+10h] [ebp-4h]
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=n>hHeap</span> <span class=o>=</span> <span class=nf>HeapCreate</span><span class=p>(</span><span class=mh>0x40000u</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>lpMem</span> <span class=o>=</span> <span class=p>(</span><span class=n>CHAR</span> <span class=o>*</span><span class=p>)</span><span class=nf>HeapAlloc</span><span class=p>(</span><span class=n>hHeap</span><span class=p>,</span> <span class=mi>8u</span><span class=p>,</span> <span class=n>SourceSize</span> <span class=o>+</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>memcpy_s</span><span class=p>(</span><span class=n>lpMem</span><span class=p>,</span> <span class=n>SourceSize</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>unk_409B10</span><span class=p>,</span> <span class=n>SourceSize</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=o>!</span><span class=nf>sub_40102A</span><span class=p>()</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=nf>IsDebuggerPresent</span><span class=p>()</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>MessageBoxA</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>lpMem</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=s>&#34;Flag&#34;</span><span class=p>,</span> <span class=mi>2u</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>HeapFree</span><span class=p>(</span><span class=n>hHeap</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>lpMem</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>HeapDestroy</span><span class=p>(</span><span class=n>hHeap</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>ExitProcess</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=nf>__debugbreak</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=nf>sub_401000</span><span class=p>(</span><span class=n>v3</span> <span class=o>+</span> <span class=mi>4</span><span class=p>,</span> <span class=n>lpMem</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>ExitProcess</span><span class=p>(</span><span class=mh>0xFFFFFFFF</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>都是WIN32api的调用，尝试运行一下程序：</p><p><img loading=lazy src=/images/XCTF-REVERSE-novice_writeup/image-20210911084558336.png alt=image-20210911084558336></p><p>应该是有些关键的语句没有执行</p><p>可以查看下IDA pro的汇编语句</p><p><img loading=lazy src=/images/XCTF-REVERSE-novice_writeup/image-20210913082559422.png alt=image-20210913082559422></p><p>显然是有一个Flag没有进行相应的跳转，显然有着较大的嫌疑，可以尝试去搞一搞让其跳转</p><p>使用OD进行调试修改汇编让其进行跳转，首先定位到Flag</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>000D1092   .  85C0          test    eax, eax
</span></span><span class=line><span class=cl>000D1094      74 23         je      short 000D10B9
</span></span><span class=line><span class=cl>000D1096   &gt;  41            inc     ecx
</span></span><span class=line><span class=cl>000D1097   .  41            inc     ecx
</span></span><span class=line><span class=cl>000D1098   .  41            inc     ecx
</span></span><span class=line><span class=cl>000D1099   .  41            inc     ecx
</span></span><span class=line><span class=cl>000D109A      CC            int3
</span></span><span class=line><span class=cl>000D109B   .  8B55 F4       mov     edx, dword ptr [ebp-C]
</span></span><span class=line><span class=cl>000D109E   .  E8 5DFFFFFF   call    000D1000
</span></span><span class=line><span class=cl>000D10A3      EB 4A         jmp     short 000D10EF
</span></span><span class=line><span class=cl>000D10A5   .  6A 02         push    2                                ; /Style = MB_ABORTRETRYIGNORE|MB_APPLMODAL
</span></span><span class=line><span class=cl>000D10A7   .  68 20780D00   push    000D7820                         ; |Title = &#34;Flag&#34;
</span></span><span class=line><span class=cl>000D10AC   .  FF75 F4       push    dword ptr [ebp-C]                ; |Text
</span></span><span class=line><span class=cl>000D10AF   .  6A 00         push    0                                ; |hOwner = NULL
</span></span><span class=line><span class=cl>000D10B1   .  FF15 E4600D00 call    dword ptr [&lt;&amp;USER32.MessageBoxA&gt;&gt;; \MessageBoxA
</span></span><span class=line><span class=cl>000D10B7   .  EB 14         jmp     short 000D10CD
</span></span><span class=line><span class=cl>000D10B9   &gt;  6A 02         push    2                                ; /Style = MB_ABORTRETRYIGNORE|MB_APPLMODAL
</span></span><span class=line><span class=cl>000D10BB   .  68 20780D00   push    000D7820                         ; |Title = &#34;Flag&#34;
</span></span><span class=line><span class=cl>000D10C0   .  8B45 F4       mov     eax, dword ptr [ebp-C]           ; |
</span></span><span class=line><span class=cl>000D10C3   .  40            inc     eax                              ; |
</span></span><span class=line><span class=cl>000D10C4   .  50            push    eax                              ; |Text
</span></span><span class=line><span class=cl>000D10C5   .  6A 00         push    0                                ; |hOwner = NULL
</span></span><span class=line><span class=cl>000D10C7   .  FF15 E4600D00 call    dword ptr [&lt;&amp;USER32.MessageBoxA&gt;&gt;; \MessageBoxA
</span></span></code></pre></div><p>然后定位到if语句对应的汇编语句</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>000D1083   .  E8 A2FFFFFF   call    000D102A
</span></span><span class=line><span class=cl>000D1088   .  85C0          test    eax, eax
</span></span><span class=line><span class=cl>000D108A   .  75 0A         jnz     short 000D1096
</span></span><span class=line><span class=cl>000D108C   .  FF15 14600D00 call    dword ptr [&lt;&amp;KERNEL32.IsDebugger&gt;; [IsDebuggerPresent
</span></span><span class=line><span class=cl>000D1092   .  85C0          test    eax, eax
</span></span><span class=line><span class=cl>000D1094      74 23         je      short 000D10B9
</span></span><span class=line><span class=cl>000D1096   &gt;  41            inc     ecx
</span></span><span class=line><span class=cl>000D1097   .  41            inc     ecx
</span></span><span class=line><span class=cl>000D1098   .  41            inc     ecx
</span></span><span class=line><span class=cl>000D1099   .  41            inc     ecx
</span></span><span class=line><span class=cl>000D109A      CC            int3
</span></span><span class=line><span class=cl>000D109B   .  8B55 F4       mov     edx, dword ptr [ebp-C]
</span></span><span class=line><span class=cl>000D109E   .  E8 5DFFFFFF   call    000D1000
</span></span><span class=line><span class=cl>000D10A3      EB 4A         jmp     short 000D10EF
</span></span></code></pre></div><p>关键就是对这些汇编语句进行修改来获得flag数据，运行过程中有一个int3断点应该是让程序进行终止的，然后就是je跳转语句和jmp跳转语句了。对je跳转语句进行修改和jmp跳转语句进行修改，设置断点进行调试应该就可以获得flag</p><p>修改过的汇编语句</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>000D1083   .  E8 A2FFFFFF   call    000D102A
</span></span><span class=line><span class=cl>000D1088   .  85C0          test    eax, eax
</span></span><span class=line><span class=cl>000D108A   .  75 0A         jnz     short 000D1096
</span></span><span class=line><span class=cl>000D108C   .  FF15 14600D00 call    dword ptr [&lt;&amp;KERNEL32.IsDebugger&gt;; [IsDebuggerPresent
</span></span><span class=line><span class=cl>000D1092   .  85C0          test    eax, eax
</span></span><span class=line><span class=cl>000D1094      90            nop
</span></span><span class=line><span class=cl>000D1095      90            nop
</span></span><span class=line><span class=cl>000D1096   &gt;  41            inc     ecx
</span></span><span class=line><span class=cl>000D1097   .  41            inc     ecx
</span></span><span class=line><span class=cl>000D1098   .  41            inc     ecx
</span></span><span class=line><span class=cl>000D1099   .  41            inc     ecx
</span></span><span class=line><span class=cl>000D109A      90            nop
</span></span><span class=line><span class=cl>000D109B   .  8B55 F4       mov     edx, dword ptr [ebp-C]
</span></span><span class=line><span class=cl>000D109E   .  E8 5DFFFFFF   call    000D1000
</span></span><span class=line><span class=cl>000D10A3      EB 14         jmp     short 000D10B9
</span></span></code></pre></div><p>然后设置断点进行调试，来获得flag</p><p><img loading=lazy src=/images/XCTF-REVERSE-novice_writeup/image-20210913085300812.png alt=image-20210913085300812></p><p>成功得到flag</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>flag{reversing_is_not_that_hard!}
</span></span></code></pre></div><h2 id=0xb-maze>0xB maze<a hidden class=anchor aria-hidden=true href=#0xb-maze>#</a></h2><p>走迷宫的题目，逆向题目中多少有些趣味的题目，来一起走迷宫吧</p><p>首先查看一下程序信息</p><p><img loading=lazy src=/images/XCTF-REVERSE-novice_writeup/image-20210913085802357.png alt=image-20210913085802357></p><p>64位的程序，使用x64 IDA pro查看一下</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kr>__int64</span> <span class=kr>__fastcall</span> <span class=nf>main</span><span class=p>(</span><span class=kt>int</span> <span class=n>a1</span><span class=p>,</span> <span class=kt>char</span> <span class=o>**</span><span class=n>a2</span><span class=p>,</span> <span class=kt>char</span> <span class=o>**</span><span class=n>a3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>__int64</span> <span class=n>v3</span><span class=p>;</span> <span class=c1>// rbx
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>int</span> <span class=n>v4</span><span class=p>;</span> <span class=c1>// eax
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>char</span> <span class=n>v5</span><span class=p>;</span> <span class=c1>// bp
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>char</span> <span class=n>v6</span><span class=p>;</span> <span class=c1>// al
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>v7</span><span class=p>;</span> <span class=c1>// rdi
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>unsigned</span> <span class=kt>int</span> <span class=n>v9</span><span class=p>;</span> <span class=c1>// [rsp+0h] [rbp-28h] BYREF
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>int</span> <span class=n>v10</span><span class=p>[</span><span class=mi>9</span><span class=p>];</span> <span class=c1>// [rsp+4h] [rbp-24h] BYREF
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=n>v10</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v9</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nf>puts</span><span class=p>(</span><span class=s>&#34;Input flag:&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>scanf</span><span class=p>(</span><span class=s>&#34;%s&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>s1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=nf>strlen</span><span class=p>(</span><span class=o>&amp;</span><span class=n>s1</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>24</span> <span class=o>||</span> <span class=nf>strncmp</span><span class=p>(</span><span class=o>&amp;</span><span class=n>s1</span><span class=p>,</span> <span class=s>&#34;nctf{&#34;</span><span class=p>,</span> <span class=mi>5uLL</span><span class=p>)</span> <span class=o>||</span> <span class=o>*</span><span class=p>(</span><span class=o>&amp;</span><span class=n>byte_6010BF</span> <span class=o>+</span> <span class=mi>24</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>125</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=nl>LABEL_22</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nf>puts</span><span class=p>(</span><span class=s>&#34;Wrong flag!&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>exit</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>v3</span> <span class=o>=</span> <span class=mi>5LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=nf>strlen</span><span class=p>(</span><span class=o>&amp;</span><span class=n>s1</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span> <span class=o>&gt;</span> <span class=mi>5</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=p>(</span> <span class=mi>1</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>v4</span> <span class=o>=</span> <span class=o>*</span><span class=p>(</span><span class=o>&amp;</span><span class=n>s1</span> <span class=o>+</span> <span class=n>v3</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>v5</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span> <span class=n>v4</span> <span class=o>&gt;</span> <span class=mi>78</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span> <span class=p>(</span><span class=kt>unsigned</span> <span class=kr>__int8</span><span class=p>)</span><span class=n>v4</span> <span class=o>==</span> <span class=mi>79</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=n>v6</span> <span class=o>=</span> <span class=nf>sub_400650</span><span class=p>(</span><span class=n>v10</span><span class=p>);</span>
</span></span><span class=line><span class=cl>          <span class=k>goto</span> <span class=n>LABEL_14</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span> <span class=p>(</span><span class=kt>unsigned</span> <span class=kr>__int8</span><span class=p>)</span><span class=n>v4</span> <span class=o>==</span> <span class=mi>111</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=n>v6</span> <span class=o>=</span> <span class=nf>sub_400660</span><span class=p>(</span><span class=n>v10</span><span class=p>);</span>
</span></span><span class=line><span class=cl>          <span class=k>goto</span> <span class=n>LABEL_14</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=k>else</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span> <span class=p>(</span><span class=kt>unsigned</span> <span class=kr>__int8</span><span class=p>)</span><span class=n>v4</span> <span class=o>==</span> <span class=mi>46</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=n>v6</span> <span class=o>=</span> <span class=nf>sub_400670</span><span class=p>(</span><span class=o>&amp;</span><span class=n>v9</span><span class=p>);</span>
</span></span><span class=line><span class=cl>          <span class=k>goto</span> <span class=n>LABEL_14</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span> <span class=p>(</span><span class=kt>unsigned</span> <span class=kr>__int8</span><span class=p>)</span><span class=n>v4</span> <span class=o>==</span> <span class=mi>48</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=n>v6</span> <span class=o>=</span> <span class=nf>sub_400680</span><span class=p>(</span><span class=o>&amp;</span><span class=n>v9</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nl>LABEL_14</span><span class=p>:</span>
</span></span><span class=line><span class=cl>          <span class=n>v5</span> <span class=o>=</span> <span class=n>v6</span><span class=p>;</span>
</span></span><span class=line><span class=cl>          <span class=k>goto</span> <span class=n>LABEL_15</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nl>LABEL_15</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span> <span class=o>!</span><span class=p>(</span><span class=kt>unsigned</span> <span class=kr>__int8</span><span class=p>)</span><span class=nf>sub_400690</span><span class=p>(</span><span class=n>asc_601060</span><span class=p>,</span> <span class=p>(</span><span class=kt>unsigned</span> <span class=kt>int</span><span class=p>)</span><span class=n>v10</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>v9</span><span class=p>)</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>goto</span> <span class=n>LABEL_22</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span> <span class=o>++</span><span class=n>v3</span> <span class=o>&gt;=</span> <span class=nf>strlen</span><span class=p>(</span><span class=o>&amp;</span><span class=n>s1</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span> <span class=n>v5</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nl>LABEL_20</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>v7</span> <span class=o>=</span> <span class=s>&#34;Wrong flag!&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>goto</span> <span class=n>LABEL_21</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=n>asc_601060</span><span class=p>[</span><span class=mi>8</span> <span class=o>*</span> <span class=n>v9</span> <span class=o>+</span> <span class=n>v10</span><span class=p>[</span><span class=mi>0</span><span class=p>]]</span> <span class=o>!=</span> <span class=mi>35</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>goto</span> <span class=n>LABEL_20</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v7</span> <span class=o>=</span> <span class=s>&#34;Congratulations!&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nl>LABEL_21</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=nf>puts</span><span class=p>(</span><span class=n>v7</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=mi>0LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>函数的主要逻辑应该是根据输入的值来进行走迷宫的，走出迷宫即得到flag。程序中肯定存在的有迷宫的地图作为静态数据存储。所以可以尝试查看静态数据：</p><p><img loading=lazy src=/images/XCTF-REVERSE-novice_writeup/image-20210913091057871.png alt=image-20210913091057871></p><p>果然有一个类似迷宫的数据，查看迷宫数据</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>  *******   *  **** * ****  * ***  *#  *** *** ***     *********
</span></span></code></pre></div><p>需要对代码进行分析来进一步得到迷宫的大致样子</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span> <span class=nf>strlen</span><span class=p>(</span><span class=o>&amp;</span><span class=n>s1</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>24</span> <span class=o>||</span> <span class=nf>strncmp</span><span class=p>(</span><span class=o>&amp;</span><span class=n>s1</span><span class=p>,</span> <span class=s>&#34;nctf{&#34;</span><span class=p>,</span> <span class=mi>5uLL</span><span class=p>)</span> <span class=o>||</span> <span class=o>*</span><span class=p>(</span><span class=o>&amp;</span><span class=n>byte_6010BF</span> <span class=o>+</span> <span class=mi>24</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>125</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=nl>LABEL_22</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nf>puts</span><span class=p>(</span><span class=s>&#34;Wrong flag!&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>exit</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span></code></pre></div><p>根据这段代码可以判断出走出迷宫需要18个操作数</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=k>while</span> <span class=p>(</span> <span class=mi>1</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>v4</span> <span class=o>=</span> <span class=o>*</span><span class=p>(</span><span class=o>&amp;</span><span class=n>s1</span> <span class=o>+</span> <span class=n>v3</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>v5</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span> <span class=n>v4</span> <span class=o>&gt;</span> <span class=mi>78</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span> <span class=p>(</span><span class=kt>unsigned</span> <span class=kr>__int8</span><span class=p>)</span><span class=n>v4</span> <span class=o>==</span> <span class=sc>&#39;O&#39;</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=n>v6</span> <span class=o>=</span> <span class=nf>sub_400650</span><span class=p>(</span><span class=n>v10</span><span class=p>);</span>
</span></span><span class=line><span class=cl>          <span class=k>goto</span> <span class=n>LABEL_14</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span> <span class=p>(</span><span class=kt>unsigned</span> <span class=kr>__int8</span><span class=p>)</span><span class=n>v4</span> <span class=o>==</span> <span class=sc>&#39;o&#39;</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=n>v6</span> <span class=o>=</span> <span class=nf>sub_400660</span><span class=p>(</span><span class=n>v10</span><span class=p>);</span>
</span></span><span class=line><span class=cl>          <span class=k>goto</span> <span class=n>LABEL_14</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=k>else</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span> <span class=p>(</span><span class=kt>unsigned</span> <span class=kr>__int8</span><span class=p>)</span><span class=n>v4</span> <span class=o>==</span> <span class=sc>&#39;.&#39;</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=n>v6</span> <span class=o>=</span> <span class=nf>sub_400670</span><span class=p>(</span><span class=o>&amp;</span><span class=n>v9</span><span class=p>);</span>
</span></span><span class=line><span class=cl>          <span class=k>goto</span> <span class=n>LABEL_14</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span> <span class=p>(</span><span class=kt>unsigned</span> <span class=kr>__int8</span><span class=p>)</span><span class=n>v4</span> <span class=o>==</span> <span class=sc>&#39;0&#39;</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=n>v6</span> <span class=o>=</span> <span class=nf>sub_400680</span><span class=p>(</span><span class=o>&amp;</span><span class=n>v9</span><span class=p>);</span>
</span></span></code></pre></div><p>这些是对迷宫操作的判断，根据这些判断可以确定我们如何进行迷宫的操作</p><p>首先根据反汇编的代码进行分析，可以发现有两个关键数据有着比较重要的作用就是<code>v10</code>就<code>v9</code>的数据，根据跟进分析，发现<code>v10</code> 是进行横向操作，发现<code>v9</code> 是纵向操作。然后根据函数内部的加或减来确定 上下左右 的方向。</p><p>对代码进行进一步分析应该就知道对应操作：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>&#39;O&#39;  ←
</span></span><span class=line><span class=cl>&#39;o&#39;  →
</span></span><span class=line><span class=cl>&#39;.&#39;  ↑
</span></span><span class=line><span class=cl>&#39;0&#39;  ↓
</span></span></code></pre></div><p>根据代码的分析，迷宫应该是8x8的迷宫，可以排列出迷宫的样子</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>00******
</span></span><span class=line><span class=cl>*000*00*
</span></span><span class=line><span class=cl>***0*0**
</span></span><span class=line><span class=cl>**00*0**
</span></span><span class=line><span class=cl>*00*#00*
</span></span><span class=line><span class=cl>**0***0*
</span></span><span class=line><span class=cl>**00000*
</span></span><span class=line><span class=cl>********
</span></span></code></pre></div><p>根据目前的分析的结果就可以开心地走迷宫了：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>o0oo00O000oooo..OO
</span></span></code></pre></div><p>迷宫路线即为flag，因此本题的flag为：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>nctf{o0oo00O000oooo..OO}
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=/tags/ctf/>ctf</a></li><li><a href=/tags/writeup/>writeup</a></li><li><a href=/tags/reverse/>Reverse</a></li></ul><nav class=paginav><a class=prev href=/posts/buuctf-reverse-2_writeup/><span class=title>« Prev</span><br><span>BUUCTF REVERSE [9~16]_Writeup</span></a>
<a class=next href=/posts/buuctf-reverse-1_writeup/><span class=title>Next »</span><br><span>BUUCTF REVERSE [1~8]_writeup</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href>Jasmine❀Hiker</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script type=text/x-mathjax-config>
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        processEscapes: true
      }
    });
</script><script src='https://cdn.jsdelivr.net/npm/mathjax@2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML' async></script></body></html>