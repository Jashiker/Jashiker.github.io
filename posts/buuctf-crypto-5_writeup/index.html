<!DOCTYPE html>
<html lang="en" dir="ltr" class="scroll-smooth" data-default-appearance="dark"
  data-auto-appearance="true"><head>
  <meta charset="utf-8" />
  
  <meta http-equiv="content-language" content="en" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <title>BUUCTF CRYPTO (5) writeup &middot; (,,ãƒ»Ï‰ãƒ»,,)</title>
  <meta name="title" content="BUUCTF CRYPTO (5) writeup &middot; (,,ãƒ»Ï‰ãƒ»,,)" />
  
  <meta name="description" content="My awesome website" />
  <meta name="keywords" content="ctf, writeup, crypto, " />
  
  
  <link rel="canonical" href="https://jashiker.github.io/posts/buuctf-crypto-5_writeup/" />
  
  
  
  
  
  
  
  
  
  
  <link type="text/css" rel="stylesheet" href="/css/main.bundle.min.b5c8c1e3bd08e77f2ed48e8db5aacfa745a700b48259d2855ba6a3770bee5f4dfe39e5933d935111c3d7bb33f413f5b9a99aee3e02f329406333cc34868896c6.css"
    integrity="sha512-tcjB470I538u1I6NtarPp0WnALSCWdKFW6ajdwvuX03&#43;OeWTPZNREcPXuzP0E/W5qZruPgLzKUBjM8w0hoiWxg==" />
  
  
  <script type="text/javascript" src="/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js"
    integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj&#43;e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <script defer type="text/javascript" id="script-bundle" src="/js/main.bundle.min.65b5de43825ad54a420102c9ddccece1f1015665fe76e5b399ba259e1de29f6c83ac1b3cf77beed3d29e26604dfebf561a8e1db523cb6add0d6acccc9e8f1307.js"
    integrity="sha512-ZbXeQ4Ja1UpCAQLJ3czs4fEBVmX&#43;duWzmbolnh3in2yDrBs893vu09KeJmBN/r9WGo4dtSPLat0NaszMno8TBw==" data-copy="" data-copied=""></script>
  
  
  
  <script src="/lib/zoom/zoom.min.f592a181a15d2a5b042daa7f746c3721acf9063f8b6acd175d989129865a37d400ae0e85b640f9ad42cd98d1f8ad30931718cf8811abdcc5fcb264400d1a2b0c.js" integrity="sha512-9ZKhgaFdKlsELap/dGw3Iaz5Bj&#43;Las0XXZiRKYZaN9QArg6FtkD5rULNmNH4rTCTFxjPiBGr3MX8smRADRorDA=="></script>
  
  
  
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="manifest" href="/site.webmanifest" />
  
  
  
  
  
  
  
  
  <meta property="og:url" content="https://jashiker.github.io/posts/buuctf-crypto-5_writeup/">
  <meta property="og:site_name" content="(,,ãƒ»Ï‰ãƒ»,,)">
  <meta property="og:title" content="BUUCTF CRYPTO (5) writeup">
  <meta property="og:description" content="My awesome website">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2021-07-01T10:14:15+08:00">
    <meta property="article:modified_time" content="2021-07-01T10:14:15+08:00">
    <meta property="article:tag" content="Ctf">
    <meta property="article:tag" content="Writeup">
    <meta property="article:tag" content="Crypto">

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="BUUCTF CRYPTO (5) writeup">
  <meta name="twitter:description" content="My awesome website">

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "BUUCTF CRYPTO (5) writeup",
    "headline": "BUUCTF CRYPTO (5) writeup",
    
    
    "inLanguage": "en",
    "url" : "https:\/\/jashiker.github.io\/posts\/buuctf-crypto-5_writeup\/",
    "author" : {
      "@type": "Person",
      "name": "Jasmineâ„Hiker"
    },
    "copyrightYear": "2021",
    "dateCreated": "2021-07-01T10:14:15\u002b08:00",
    "datePublished": "2021-07-01T10:14:15\u002b08:00",
    
    "dateModified": "2021-07-01T10:14:15\u002b08:00",
    
    "keywords": ["ctf","writeup","crypto"],
    
    "mainEntityOfPage": "true",
    "wordCount": "5427"
  }]
  </script>


  
  
  <meta name="author" content="Jasmineâ„Hiker" />
  
  
  
  <link href="https://github.com/jashiker" rel="me" />
  
  
  
  

<script src="/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js" integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj&#43;KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script>






















  
  



  
  
  <meta name="theme-color"/>
  
  
</head>
<body
  class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
  <div id="the-top" class="absolute flex self-center">
    <a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
      href="#main-content"><span
        class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a>
  </div>
  
  
  <div class="min-h-[148px]"></div>
<div class="fixed inset-x-0 min-h-[130px] opacity-65 pl-[24px] pr-[24px] bg-gradient-to-b from-neutral from-60% dark:from-neutral-800 to-transparent mix-blend-normal" style="z-index:80"></div>
<div class="fixed inset-x-0 pl-[24px] pr-[24px]" style="z-index:100">
  <div id="menu-blur" class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl shadow-2xl"></div>
  <div class="relative max-w-[64rem] ml-auto mr-auto">
    <div style="padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px"
    class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start gap-x-3">
    
    <div class="flex flex-1 items-center justify-between">
        <nav class="flex space-x-3">

            
            <a href="/" class="text-base font-medium text-gray-500 hover:text-gray-900">(,,ãƒ»Ï‰ãƒ»,,)</a>
            

        </nav>
        <nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12">

            
            
            
  <a href="/posts/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="">
        Blog
    </p>
</a>



            
            
  <a href="/about/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="">
        About
    </p>
</a>



            
            
  <a href="/link/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="">
        Link
    </p>
</a>



            
            

            


            
            <button id="search-button" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            


            
            
            <div
                class=" flex items-center">
                <button id="appearance-switcher" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400">
                    <div class="flex items-center justify-center dark:hidden">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                    </div>
                    <div class="items-center justify-center hidden dark:flex">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                    </div>
                </button>
            </div>
            

        </nav>
        <div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12">

            <span></span>

            


            
            <button id="search-button-mobile" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            

            
            
            <button id="appearance-switcher-mobile" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400 ltr:mr-1 rtl:ml-1">
                <div class="flex items-center justify-center dark:hidden">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                </div>
                <div class="items-center justify-center hidden dark:flex">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                </div>
            </button>
            

        </div>
    </div>
    <div class="-my-2 md:hidden">

        <label id="menu-button" class="block">
            
            <div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
                

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>

  </span>


            </div>
            <div id="menu-wrapper" style="padding-top:5px;"
                class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50">
                <ul
                    class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl">

                    <li id="menu-close-button">
                        <span
                            class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>

</span>
                    </li>

                    

                    
  <li class="mt-1">
    <a href="/posts/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="">
            Blog
        </p>
    </a>
</li>




                    

                    
  <li class="mt-1">
    <a href="/about/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="">
            About
        </p>
    </a>
</li>




                    

                    
  <li class="mt-1">
    <a href="/link/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="">
            Link
        </p>
    </a>
</li>




                    

                </ul>
                
                

            </div>
        </label>
    </div>
</div>





  </div>
</div>
<script>
  window.addEventListener('scroll', function (e) {
    var scroll = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;
    var background_blur = document.getElementById('menu-blur');
    background_blur.style.opacity = (scroll / 300);
  });
</script>

  
  <div class="relative flex flex-col grow">
    <main id="main-content" class="grow">
      


<article>
  

  <header id="single_header" class="mt-5 max-w-prose">
    
    <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
      BUUCTF CRYPTO (5) writeup
    </h1>
    <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
      





  
  







  





  



  



  









  



<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2021-07-01T10:14:15&#43;08:00">1 July 2021</time><span class="px-2 text-primary-500">&middot;</span><span>5427 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">26 mins</span><span class="px-2 text-primary-500">&middot;</span><span>
  
  
    
    
      
      
        
        
      
      
    
  
  <span id="views_posts/BUUCTF-CRYPTO-5_writeup.md" class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400" title="views">loading</span>
  <span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
<path fill="currentColor" d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg>
  </span>

</span>
</span><span class="px-2 text-primary-500">&middot;</span>


<script type="text/javascript" src="/js/zen-mode.min.eea5245cf9244ecbdf2c150d1c8833226c1541cadf6e98f63a7c9192b1a3676df2c3ec603b14f4cfaaa53971fd9d8955640c0f405bf3de2b43ee7a5fb29ae721.js" integrity="sha512-7qUkXPkkTsvfLBUNHIgzImwVQcrfbpj2OnyRkrGjZ23yw&#43;xgOxT0z6qlOXH9nYlVZAwPQFvz3itD7npfsprnIQ=="></script>

<span class="mb-[2px]">
    <span id="zen-mode-button"
          class="text-lg hover:text-primary-500"
          title="Enable zen mode"
          data-title-i18n-disable="Enable zen mode"
          data-title-i18n-enable="Disable zen mode">
        <span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="50px" height="50px">
    <path fill="currentColor" d="M 12.980469 4 C 9.1204688 4 5.9804688 7.14 5.9804688 11 L 6 26 L 9.9804688 26 L 9.9804688 11 C 9.9804688 9.35 11.320469 8 12.980469 8 L 40.019531 8 C 41.679531 8 43.019531 9.35 43.019531 11 L 43.019531 39 C 43.019531 40.65 41.679531 42 40.019531 42 L 29 42 C 29 43.54 28.420938 44.94 27.460938 46 L 40.019531 46 C 43.879531 46 47.019531 42.86 47.019531 39 L 47.019531 11 C 47.019531 7.14 43.879531 4 40.019531 4 L 12.980469 4 z M 7 28 C 4.794 28 3 29.794 3 32 L 3 42 C 3 44.206 4.794 46 7 46 L 23 46 C 25.206 46 27 44.206 27 42 L 27 32 C 27 29.794 25.206 28 23 28 L 7 28 z M 7 32 L 23 32 L 23.001953 42 L 7 42 L 7 32 z"/>
</svg>
  </span>

</span>
    </span>
</span>
  

  
  
</div>








    </div>

    
    
    
    
    

    

    
      
      

      

      

    

  </header>
  
  <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
    
     <div
      class="order-first lg:ml-auto px-0 lg:order-last ltr:lg:pl-8 rtl:lg:pr-8">
      <div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-[140px]">

         <details open id="TOCView"
  class="toc-right mt-0 overflow-y-scroll overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="min-w-[220px] py-2 border-dotted ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#0x0-æµªé‡Œæ·˜æ²™">0x0 æµªé‡Œæ·˜æ²™</a></li>
    <li><a href="#0x1-afctf2018vigenere">0x1 [AFCTF2018]Vigenere</a></li>
    <li><a href="#0x2-npuctf2020è¿™æ˜¯ä»€ä¹ˆ">0x2 [NPUCTF2020]è¿™æ˜¯ä»€ä¹ˆğŸ</a></li>
    <li><a href="#0x3-easyrsa">0x3 easyrsa</a></li>
    <li><a href="#0x4-babyrsa">0x4 babyRSA</a></li>
    <li><a href="#0x5-afctf2018ä½ èƒ½çœ‹å‡ºè¿™æ˜¯ä»€ä¹ˆåŠ å¯†ä¹ˆ">0x5 [AFCTF2018]ä½ èƒ½çœ‹å‡ºè¿™æ˜¯ä»€ä¹ˆåŠ å¯†ä¹ˆ</a></li>
    <li><a href="#0x6-actfæ–°ç”Ÿèµ›2020crypto-rsa3">0x6 [ACTFæ–°ç”Ÿèµ›2020]crypto-rsa3</a></li>
    <li><a href="#0x7-é¸¡è—•æ¤’ç›å‘³">0x7 é¸¡è—•æ¤’ç›å‘³</a></li>
    <li><a href="#0x8-actfæ–°ç”Ÿèµ›2020crypto-classic0">0x8 [ACTFæ–°ç”Ÿèµ›2020]crypto-classic0</a></li>
    <li><a href="#0x9-roarctf2019babyrsa">0x9 [RoarCTF2019]babyRSA</a></li>
    <li><a href="#0xa-afctf2018å¯æ€œçš„rsa">0xA [AFCTF2018]å¯æ€œçš„RSA</a></li>
    <li><a href="#0xb-æ•‘ä¸»æ·å¾„">0xB æ•‘ä¸»æ·å¾„</a></li>
    <li><a href="#0xc-ç½‘é¼æ¯-2020-é’é¾™ç»„boom">0xC [ç½‘é¼æ¯ 2020 é’é¾™ç»„]boom</a></li>
    <li><a href="#0xd-roarctf2019rsa">0xD [RoarCTF2019]RSA</a></li>
    <li><a href="#0xe-afctf2018single">0xE [AFCTF2018]Single</a></li>
    <li><a href="#0xf-wustctf2020bse">0xF [WUSTCTF2020]B@se</a></li>
    <li><a href="#å‚è€ƒ">å‚è€ƒ</a></li>
  </ul>
</nav>
  </div>
</details>
<details class="toc-inside mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden">
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#0x0-æµªé‡Œæ·˜æ²™">0x0 æµªé‡Œæ·˜æ²™</a></li>
    <li><a href="#0x1-afctf2018vigenere">0x1 [AFCTF2018]Vigenere</a></li>
    <li><a href="#0x2-npuctf2020è¿™æ˜¯ä»€ä¹ˆ">0x2 [NPUCTF2020]è¿™æ˜¯ä»€ä¹ˆğŸ</a></li>
    <li><a href="#0x3-easyrsa">0x3 easyrsa</a></li>
    <li><a href="#0x4-babyrsa">0x4 babyRSA</a></li>
    <li><a href="#0x5-afctf2018ä½ èƒ½çœ‹å‡ºè¿™æ˜¯ä»€ä¹ˆåŠ å¯†ä¹ˆ">0x5 [AFCTF2018]ä½ èƒ½çœ‹å‡ºè¿™æ˜¯ä»€ä¹ˆåŠ å¯†ä¹ˆ</a></li>
    <li><a href="#0x6-actfæ–°ç”Ÿèµ›2020crypto-rsa3">0x6 [ACTFæ–°ç”Ÿèµ›2020]crypto-rsa3</a></li>
    <li><a href="#0x7-é¸¡è—•æ¤’ç›å‘³">0x7 é¸¡è—•æ¤’ç›å‘³</a></li>
    <li><a href="#0x8-actfæ–°ç”Ÿèµ›2020crypto-classic0">0x8 [ACTFæ–°ç”Ÿèµ›2020]crypto-classic0</a></li>
    <li><a href="#0x9-roarctf2019babyrsa">0x9 [RoarCTF2019]babyRSA</a></li>
    <li><a href="#0xa-afctf2018å¯æ€œçš„rsa">0xA [AFCTF2018]å¯æ€œçš„RSA</a></li>
    <li><a href="#0xb-æ•‘ä¸»æ·å¾„">0xB æ•‘ä¸»æ·å¾„</a></li>
    <li><a href="#0xc-ç½‘é¼æ¯-2020-é’é¾™ç»„boom">0xC [ç½‘é¼æ¯ 2020 é’é¾™ç»„]boom</a></li>
    <li><a href="#0xd-roarctf2019rsa">0xD [RoarCTF2019]RSA</a></li>
    <li><a href="#0xe-afctf2018single">0xE [AFCTF2018]Single</a></li>
    <li><a href="#0xf-wustctf2020bse">0xF [WUSTCTF2020]B@se</a></li>
    <li><a href="#å‚è€ƒ">å‚è€ƒ</a></li>
  </ul>
</nav>
  </div>
</details>

<script>

  var margin = 200;
  var marginError = 50;

  (function () {
    var $window = $(window);
    var $toc = $('#TOCView');
    var tocHeight = $toc.height();

    function onResize() {
      var windowAndMarginHeight = $window.height() - margin;
      if(tocHeight >= windowAndMarginHeight) {
        $toc.css("overflow-y", "scroll")
        $toc.css("max-height", (windowAndMarginHeight + marginError) + "px")
      } else {
        $toc.css("overflow-y", "hidden")
        $toc.css("max-height", "9999999px")
      }
    }

    $window.on('resize', onResize);
    $(document).ready(onResize);
  })();



</script>
   </div>
      </div>
      

      <div class="min-w-0 min-h-0 max-w-fit">
        
        


        <div class="article-content max-w-prose mb-20">
          <p>å¯†ç å­¦ç™¾é¢˜è®¡åˆ’å¯åŠ¨ï¼è¿›è¡Œå‹‡å¾€ç›´å‰ï¼</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="/images/BUUCTF-CRYPTO-5_writeup/image-20210628200701835.png" alt="image-20210628200701835" />
      
    </figure>
</p>
<p>æœ¬æ¬¡çš„16é“é¢˜ç›®ï¼Œä¹Ÿæ˜¯éå¸¸æœ‰æ„æ€çš„å‘¢ï¼å„ç§å„æ ·çš„å‘¢â€¦â€¦</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="/images/BUUCTF-CRYPTO-5_writeup/image-20210628200448759.png" alt="image-20210628200448759" />
      
    </figure>
</p>


<h2 class="relative group">0x0 æµªé‡Œæ·˜æ²™ 
    <div id="0x0-%E6%B5%AA%E9%87%8C%E6%B7%98%E6%B2%99" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#0x0-%E6%B5%AA%E9%87%8C%E6%B7%98%E6%B2%99" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>çœ‹æ ·å­ï¼Œåº”è¯¥æ˜¯ä¸ªè„‘æ´é¢˜æ²¡é”™äº†</p>
<p>æ¥åº·åº·è¿™é¢˜çš„é¢˜ç›®ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">æˆ‘æœ‰å¯†é›†ææƒ§ç—‡ï¼Œæ‰€ä»¥å¤§å®¶è‡ªæ±‚å¤šç¦å§ï¼ŒæŠŠè·å¾—çš„å•è¯è¿åœ¨ä¸€èµ·æäº¤å³å¯ã€‚ï¼ˆæˆ‘è¿™é‡Œæœ‰ä¸€ä¸²æ•°å­—ï¼š4ï¼Œ8ï¼Œ11ï¼Œ15ï¼Œ16ï¼‰ æ³¨æ„ï¼šå¾—åˆ°çš„ flag è¯·åŒ…ä¸Š flag{} æäº¤
</span></span></code></pre></div><p>è¿™é¢˜ç›®å¥½åƒæœ‰ç‚¹æ„æ€ï¼Œå¯ä»¥ä»é¢˜ç›®ä¸­æç‚¼ä¸€äº›ä¿¡æ¯ï¼š</p>
<ol>
<li>å¯†é›†ææƒ§ç—‡</li>
<li>è·å¾—çš„å•è¯è¿åœ¨ä¸€èµ·æäº¤</li>
<li>æˆ‘è¿™é‡Œæœ‰ä¸€ä¸²æ•°å­—ï¼š4ï¼Œ8ï¼Œ11ï¼Œ15ï¼Œ16</li>
</ol>
<p>æ ¹æ®æç‚¼çš„æ•°æ®è¿›è¡Œåˆ†äº«ï¼Œåº”è¯¥æ˜¯è¯é¢‘ç»Ÿè®¡ç±»çš„é¢˜ç›®ï¼Œè¿™é¢˜æœ‰ç‚¹æ„æ€</p>
<p>çœ‹çœ‹é™„ä»¶æ˜¯å•¥å§ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">tonightsuccessnoticenoticewewesuccesstonightweexamplecryptoshouldwebackspacetonightbackspaceexamplelearnwesublimlearnbackspacetheshouldwelearnfoundsublimsystemexamplesublimfoundlearnshouldmorningsublimsystemuserlearnthecryptomorningexamplenoticetonightlearntonightlearntonightsublimenterusermorningfoundtonightweenterfoundnoticethecryptomorningthebackspacelearntonightlearnsublimtonightlearnfoundenterfoundsuccesstonightsuccessuserfoundmorningtonighttheshouldsublimentertonightenterbackspacelearnexamplenoticeexamplefoundsystemsuccesssublimsuccessshouldtonightcryptowelearncryptofoundshouldsublimsublimweentertonightsuccessshouldentertheentercryptouserbackspaceshouldentersystemsuccesssystementerfoundenterlearnexampletonightnoticemorningusertonightlearnmorningtonightfoundfoundsuccessnoticesystementerlearnexamplebackspaceshouldcryptocryptosublimweexampletonighttheshouldthemorningbackspacelearntonightsystemsuccesssuccessbackspacemorningnoticeuserfoundfoundtonightmorningenterenterthefoundbackspacelearnenterentershouldthesystemfounduserlearnlearnsystemnoticetonighttheshouldlearnuserbackspaceweusernoticeshouldthewefoundsystemwecryptocryptowethebackspacesystementershouldtonightsystemnoticemorningsystemweentermorningfoundsuccessusertonightsuccesstonightbackspaceshouldweenterthewesystemusernoticesystemthelearnexamplelearnfoundlearnnoticeexamplesystemthecryptocryptolearnsystemthecryptoenterlearnexamplemorningmorningweenterentersuccessexampleuserthebackspacenoticesublimenterbackspacesuccessbackspacethesublimexamplesystemtheexamplecryptolearnuserexamplelearnsystemusersuccessenterentersuccesstheuserbackspacelearnsuccessbackspacethesublimshouldwebackspaceexamplesuccesssuccesstonightweusershouldsuccessmorningcryptomorningfoundbackspacesublimshouldentershouldnoticesuccessmorningsuccessexamplelearnshouldsublimlearntonightshoulduserbackspacesublimlearncryptosuccessenternoticetonightmorningtonightwesuccessweuserbackspaceexamplewesystemnoticemorningsystemmorningcryptolearnsystemthethefoundcryptouserlearnusersystemwemorningenterexampleshouldlearncryptofoundenterbackspacelearnenterenterbackspaceshouldbackspacetheshouldthesystemshouldshouldsuccessmorningthefoundsystementersystemtonightcryptowelearnexampleexamplesystementerbackspaceshouldtheentersublimtonightfoundfoundsuccesssuccesssystemsublimcryptoshouldentersublimmorninglearnfoundtonightcryptobackspacesuccesscryptowebackspacefoundshouldnoticeshouldmorningnoticesystemcryptosystemlearnsystemnoticemorningsystementerwemorninglearnsuccessfoundwesuccesswetheusercryptousernoticebackspacesuccessshouldtonightmorningentermorninguserenternoticefoundmorningwetonightsystemthecryptotonightcryptosystemuserthefoundexampletonightusersystemcryptosublimmorninguserthefoundbackspaceshouldsuccesscryptotonightsystemnoticebackspaceusershouldenterthecryptomorningwesublimnoticesuccessnoticeusersuccesstonightlearnweuserenterfounduserexampleshouldshouldtonightwelearnthenoticethewefoundmorningexampleshouldexamplethesuccessnoticeenterfoundthecryptonoticeuserlearnuserweenterfoundmorningsystemweexamplenoticethebackspaceexamplesublimtheusermorningtonightthesuccesscryptosuccessusersuccesstonighttonightwelearnenterenterthemorningentersystemcryptobackspacemorningsystemexamplecryptouserexamplelearnsublimsuccessusersystemfoundmorningshouldcryptotonightsublimtheexamplemorningsystemuserexampleweexamplenoticesuccesssublimnoticecryptoshouldbackspaceshouldthetonightfoundsublimbackspacebackspacetonightshouldbackspacesuccesstonightbackspacesuccessmorningsystemcryptobackspaceentertonighttonightnoticelearnshoulduserfoundexamplesystemthesuccessweusertonightcryptousernoticeenternoticebackspaceusersystemfoundusernoticeshouldlearnuserfoundexampleusermorningshouldsuccessmorningmorningexampleexamplefoundsublimfoundenterbackspacenoticelearnfoundmorningcryptonoticecryptoshouldweshouldtonightcryptobackspacesublimcryptosublimenterentersublimentercryptonoticethethesublimexampleenterentershouldlearncryptoentershouldmorninglearnnoticeuserexamplesublimtonightshouldfoundtonightsuccessshouldmorningfoundtheweuserlearnsublimsystembackspacecryptotheusertonightcryptosublimmorningmorningexamplenoticetheenterlearnshouldmorningsublimfoundtonightsublimsublimexamplefounduserexamplethefoundwemorningnoticefoundcryptosuccesssublimsublimexamplethesuccessexamplenoticesuccessbackspacesublimlearnuserexamplesuccesssuccesssystemsuccessmorningmorninglearnexamplemorningtonightfoundbackspaceenternoticemorningentersuccessmorningusermorningbackspacelearncryptoenteruserenteruserthetonighttonightsuccesslearnenterfoundsuccesssystemfoundbackspaceenterlearnsystemsublimcryptoentermorningwetonightshouldlearnenterfoundcryptonoticelearnlearnshouldfoundsuccessexampletonightthesuccessfoundusertonightenterfoundsuccessshouldmorningusernoticemorningsystemsystemsuccessshouldwelearnenterfoundexamplewethefoundweshouldsystemsystemmorningmorningbackspaceshouldentersublimentertonightsuccesssystemsystemcryptousershouldsublimfoundwetonightnoticeexamplewewesuccessfoundusertonightfoundsystemexamplecryptofoundshouldshouldsuccessenterbackspaceexampletonightthelearnnoticeuserlearnsystemsublimfoundlearnsuccesssystemshouldsublimnoticelearnsystemnoticetonightexamplefoundusernoticeenterlearnnoticecryptousersystemmorningthewesystemfoundfoundshouldsystementerenterbackspacesystemsublimcryptousermorninglearnlearntonightsublimlearnenterenterbackspacesystemuserusercryptoentershouldtheusersublimnoticeexamplemorningexamplesublimsublimbackspacesystemexampleshouldsublimlearnfoundenterbackspacelearnmorningmorningfoundthetonightmorningnoticeenterlearnusersystemtonightbackspaceexamplelearntonightbackspaceweshouldcryptosuccessbackspaceexamplesuccesstheshouldmorninguserbackspacelearnthetheshouldcryptocryptotonightbackspacecryptocryptobackspacebackspacenoticeusertonightentermorningfoundweenterexampleenterfoundusersublimsystemtheexampleexamplesystemsuccessusersublimentermorningbackspacesystemfoundlearnsystemshouldsublimsublimentershouldtheusershouldexampleexampleshouldsuccesswelearnfoundsublimshoulduserweentertonightwenoticesublimsystemlearnshouldfoundsuccessuserentersuccessmorningcryptoenteruserfoundexampletonightlearnexampleexamplefoundlearnsuccesssystembackspacecryptonoticethefoundbackspacelearncryptothelearnlearnexamplesuccessnoticenoticesystemmorningcryptotonightnoticenoticeentersuccesscryptoenterbackspacesublimexampleenterfoundtonightcryptotonightsublimnoticesuccesssublimtheentertonighttheshouldthefoundsystemtonightuserbackspacesuccessshouldwebackspacenoticebackspacebackspacenoticewecryptobackspacebackspaceusertonightlearnsuccessmorningusertonightsuccessshouldbackspacecryptoenterentershouldsublimsystemexamplemorningcryptonoticethesuccessthebackspacenoticelearnsublimlearnsuccesscryptothesuccessenternoticecryptosystemsublimsuccesswebackspaceuserenterlearnuserwewemorningsuccesslearncryptobackspacewecryptosystemlearnenterenteruserexamplefoundsystemcryptousernoticefoundusersublimbackspacewesublimnoticemorningshouldexamplenoticecryptoshouldtonightmorningthefoundsystementerentersystemthecryptobackspacesublimlearnsuccessmorningsublimsystemcryptousersublimwesuccessmorningsublimbackspacecryptobackspacesublimthelearnsuccesssublimlearncryptoweweexamplecryptowenoticelearnfoundbackspacesystemsystemexampleshouldlearnsuccesssublimcryptobackspacetonightbackspacemorningmorningnoticeshouldnoticefoundthetheshouldtheshouldfoundfoundcryptosuccessbackspacesuccessshouldweenternoticeweweshouldmorningfoundusersuccessbackspacewenoticeusersuccessenterenterexamplelearnfoundwetonightusercryptothesublimsublimtonightsuccesslearnbackspacetonightentertonightthesublimnoticewefoundcryptobackspaceenterenterlearnlearntonightexamplesystementersublimnoticecryptoshoulduseruserbackspaceuserwesublimmorningwesystemshouldtonighttheusershouldnoticefoundusernoticeentersublimwethewefoundfoundlearnfoundwecryptosystemexamplemorningcryptocryptosublimtheexamplenoticefoundlearnwelearnmorningtheenterthesystemsublimtonightsuccesssystemlearnshouldenterbackspaceentersuccesssuccessbackspaceexamplenoticeentershouldsublimlearnbackspacetheshouldexamplelearnsystemusersublimbackspacebackspacesuccesswelearntonightexamplewecryptoenterwesystemsystemsublimexamplecryptolearnmorningsublimfoundsublimfoundbackspacefoundtonighttonightnoticesuccesssuccessexampleusersuccesstonightsublimcryptosystemweenterexamplesystemthethenoticesublimtonightbackspacenoticesystemexamplethesuccesstonightmorningsuccesstonightwenoticesublimtonightwelearntonightmorningsublimbackspaceenterthetonightenterwecryptofoundtheenternoticebackspacesuccesswesystemuserexamplebackspaceentersuccesstonightsublimwemorningsuccesssuccesswesublimsuccessnoticesublimfoundlearnlearnweexamplecryptonoticelearnweusershoulduserfoundcryptolearnfoundmorningtonightmorningmorningnoticewecryptowewesuccessfoundsublimweuserentershouldshouldshouldsublimbackspacetonightenterwesublimsuccessshouldfoundthethetonightwecryptoweenterfoundcryptoshouldcryptouseruserfoundentersublimsublimthelearntheshouldnoticebackspacefoundsuccessshouldtonightentermorningsystemmorningtonightwenoticelearnbackspaceexampleusershouldnoticesublimsublimexamplethesuccessnoticesystemmorningnoticecryptosystemsublimcryptosystemsuccessshouldmorningbackspaceshouldmorninglearnnoticenoticeshouldthewewesublimsublimnoticeusersuccessentersystemfoundshouldshouldcryptobackspaceusermorningsystemshouldshouldtonightwesublimuserfoundlearnbackspacethetonightmorningexampleuserthefoundbackspaceshouldtonightcryptocryptofounduserexamplenoticecryptousernoticethenoticeshouldweshouldfoundwemorningcryptosuccesslearnfoundtonightsublimnoticenoticewefoundwewesuccesssublimsublimcryptoweexampletonightsuccessfoundshouldsuccesstonightbackspacesystemshouldwesystemnoticebackspaceusersystembackspacewenoticelearnnoticenoticesuccesslearntonightuserlearnsuccessbackspacesuccesswesystemusercryptonoticethesystemusernoticewethesuccessweshouldfoundshouldcryptomorningtonightwethewesuccesslearntheshouldweexampletonightsuccessnoticenoticemorningfoundmorningfoundusersublimsystemsuccessbackspacesuccessmorninguserthefoundweexamplemorningsublimlearnfoundfoundnoticemorningshouldweuserwemorningexamplesuccesssuccessfoundthetheshouldweusershouldtheshouldexamplenoticefoundsuccesssystemfoundshouldsublimbackspacetonightshouldsystemtonightsuccesslearntonightsystemsublimsuccesscryptobackspacesystemsublimmorningmorningshouldmorninglearnsuccesslearnmorningusermorninglearnexamplecryptoshouldbackspacesublimshouldfoundbackspacesystemsystemweexamplesystemtonightsublimmorningmorninguserfoundcryptolearnbackspaceshouldbackspacenoticesublimfoundthecryptousershouldsuccesssystemsuccessshouldsystembackspacesublimshouldsublimsystembackspaceexampleshouldbackspacesublimnoticelearnsublimuserbackspaceusersublimsuccesssublimuserusernoticeshouldsuccessnoticenoticelearnexamplesystemweexamplesublimbackspacebackspacecryptoshouldusercryptosublimbackspacesublimshouldsystemnoticenoticethesuccesssuccesslearnsystemsublimwenoticelearnusersublimsystemusernoticeuserthesuccesslearnwelearnwenoticecryptolearncryptonoticenoticebackspacecryptothecryptousercryptobackspacesuccesslearnthesystemsuccessthesystemsystemcryptosuccessbackspacesublimlearnsublimcryptobackspacelearnsublimusersublimexamplecryptosublimsystemnoticecryptocryptousertheusernoticebackspacenoticenoticethecryptocryptosystembackspacesublimbackspacecryptocryptobackspacesystemuserthenoticesystemsystemsystemusernoticethecryptouserusersystemtheusercryptoexamplenoticecryptoexamplenoticetheexampleexamplethecryptotheusernoticetheexampleexamplecryptotheexampleexamplethenoticethecryptocryptoexampletheexamplecryptocryptothenoticeexamplecryptonoticetheexampleexampleexamplecryptocryptoexampleexamplethenoticethecryptothethethethethetheexampleexamplethetheexampletheexampletheexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexample
</span></span></code></pre></div><p>å¥½å¤šè¿åœ¨ä¸€èµ·çš„è¯æ±‡ï¼Œåº”è¯¥æ˜¯ä¸€ä¸ªç®€å•NTPé¢˜ç›®ï¼Œä¹Ÿå°±æ˜¯NLPæœ€åŸºç¡€çš„ä¸€ä¸ªæ­¥éª¤ï¼Œåˆ†è¯ã€‚</p>
<p>è¿™é“é¢˜ç›®çš„å¤§è‡´æ€è·¯åº”è¯¥æ˜¯ï¼š</p>
<ol>
<li>åˆ†è¯</li>
<li>è¯é¢‘ç»Ÿè®¡</li>
<li>ç»Ÿè®¡æ’åº</li>
<li>æ ¹æ®æ’åºä½ç½®æ‰¾åˆ°æŒ‡å®šçš„å•è¯</li>
<li>æ‹¼æ¥å•è¯</li>
</ol>
<p>æ ¹æ®è¿™ä¸ªæ€è·¯ï¼Œå†™ä¸ªè„šæœ¬å¤„ç†ä¸€ä¸‹å“ˆï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span> <span class="o">//</span> <span class="n">ç»Ÿè®¡åº“</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">wordninja</span> <span class="o">//</span> <span class="n">è‹±è¯­å•è¯è¯åº“</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span><span class="o">=</span><span class="s2">&#34;tonightsuccessnoticenoticewewesuccesstonightweexamplecryptoshouldwebackspacetonightbackspaceexamplelearnwesublimlearnbackspacetheshouldwelearnfoundsublimsystemexamplesublimfoundlearnshouldmorningsublimsystemuserlearnthecryptomorningexamplenoticetonightlearntonightlearntonightsublimenterusermorningfoundtonightweenterfoundnoticethecryptomorningthebackspacelearntonightlearnsublimtonightlearnfoundenterfoundsuccesstonightsuccessuserfoundmorningtonighttheshouldsublimentertonightenterbackspacelearnexamplenoticeexamplefoundsystemsuccesssublimsuccessshouldtonightcryptowelearncryptofoundshouldsublimsublimweentertonightsuccessshouldentertheentercryptouserbackspaceshouldentersystemsuccesssystementerfoundenterlearnexampletonightnoticemorningusertonightlearnmorningtonightfoundfoundsuccessnoticesystementerlearnexamplebackspaceshouldcryptocryptosublimweexampletonighttheshouldthemorningbackspacelearntonightsystemsuccesssuccessbackspacemorningnoticeuserfoundfoundtonightmorningenterenterthefoundbackspacelearnenterentershouldthesystemfounduserlearnlearnsystemnoticetonighttheshouldlearnuserbackspaceweusernoticeshouldthewefoundsystemwecryptocryptowethebackspacesystementershouldtonightsystemnoticemorningsystemweentermorningfoundsuccessusertonightsuccesstonightbackspaceshouldweenterthewesystemusernoticesystemthelearnexamplelearnfoundlearnnoticeexamplesystemthecryptocryptolearnsystemthecryptoenterlearnexamplemorningmorningweenterentersuccessexampleuserthebackspacenoticesublimenterbackspacesuccessbackspacethesublimexamplesystemtheexamplecryptolearnuserexamplelearnsystemusersuccessenterentersuccesstheuserbackspacelearnsuccessbackspacethesublimshouldwebackspaceexamplesuccesssuccesstonightweusershouldsuccessmorningcryptomorningfoundbackspacesublimshouldentershouldnoticesuccessmorningsuccessexamplelearnshouldsublimlearntonightshoulduserbackspacesublimlearncryptosuccessenternoticetonightmorningtonightwesuccessweuserbackspaceexamplewesystemnoticemorningsystemmorningcryptolearnsystemthethefoundcryptouserlearnusersystemwemorningenterexampleshouldlearncryptofoundenterbackspacelearnenterenterbackspaceshouldbackspacetheshouldthesystemshouldshouldsuccessmorningthefoundsystementersystemtonightcryptowelearnexampleexamplesystementerbackspaceshouldtheentersublimtonightfoundfoundsuccesssuccesssystemsublimcryptoshouldentersublimmorninglearnfoundtonightcryptobackspacesuccesscryptowebackspacefoundshouldnoticeshouldmorningnoticesystemcryptosystemlearnsystemnoticemorningsystementerwemorninglearnsuccessfoundwesuccesswetheusercryptousernoticebackspacesuccessshouldtonightmorningentermorninguserenternoticefoundmorningwetonightsystemthecryptotonightcryptosystemuserthefoundexampletonightusersystemcryptosublimmorninguserthefoundbackspaceshouldsuccesscryptotonightsystemnoticebackspaceusershouldenterthecryptomorningwesublimnoticesuccessnoticeusersuccesstonightlearnweuserenterfounduserexampleshouldshouldtonightwelearnthenoticethewefoundmorningexampleshouldexamplethesuccessnoticeenterfoundthecryptonoticeuserlearnuserweenterfoundmorningsystemweexamplenoticethebackspaceexamplesublimtheusermorningtonightthesuccesscryptosuccessusersuccesstonighttonightwelearnenterenterthemorningentersystemcryptobackspacemorningsystemexamplecryptouserexamplelearnsublimsuccessusersystemfoundmorningshouldcryptotonightsublimtheexamplemorningsystemuserexampleweexamplenoticesuccesssublimnoticecryptoshouldbackspaceshouldthetonightfoundsublimbackspacebackspacetonightshouldbackspacesuccesstonightbackspacesuccessmorningsystemcryptobackspaceentertonighttonightnoticelearnshoulduserfoundexamplesystemthesuccessweusertonightcryptousernoticeenternoticebackspaceusersystemfoundusernoticeshouldlearnuserfoundexampleusermorningshouldsuccessmorningmorningexampleexamplefoundsublimfoundenterbackspacenoticelearnfoundmorningcryptonoticecryptoshouldweshouldtonightcryptobackspacesublimcryptosublimenterentersublimentercryptonoticethethesublimexampleenterentershouldlearncryptoentershouldmorninglearnnoticeuserexamplesublimtonightshouldfoundtonightsuccessshouldmorningfoundtheweuserlearnsublimsystembackspacecryptotheusertonightcryptosublimmorningmorningexamplenoticetheenterlearnshouldmorningsublimfoundtonightsublimsublimexamplefounduserexamplethefoundwemorningnoticefoundcryptosuccesssublimsublimexamplethesuccessexamplenoticesuccessbackspacesublimlearnuserexamplesuccesssuccesssystemsuccessmorningmorninglearnexamplemorningtonightfoundbackspaceenternoticemorningentersuccessmorningusermorningbackspacelearncryptoenteruserenteruserthetonighttonightsuccesslearnenterfoundsuccesssystemfoundbackspaceenterlearnsystemsublimcryptoentermorningwetonightshouldlearnenterfoundcryptonoticelearnlearnshouldfoundsuccessexampletonightthesuccessfoundusertonightenterfoundsuccessshouldmorningusernoticemorningsystemsystemsuccessshouldwelearnenterfoundexamplewethefoundweshouldsystemsystemmorningmorningbackspaceshouldentersublimentertonightsuccesssystemsystemcryptousershouldsublimfoundwetonightnoticeexamplewewesuccessfoundusertonightfoundsystemexamplecryptofoundshouldshouldsuccessenterbackspaceexampletonightthelearnnoticeuserlearnsystemsublimfoundlearnsuccesssystemshouldsublimnoticelearnsystemnoticetonightexamplefoundusernoticeenterlearnnoticecryptousersystemmorningthewesystemfoundfoundshouldsystementerenterbackspacesystemsublimcryptousermorninglearnlearntonightsublimlearnenterenterbackspacesystemuserusercryptoentershouldtheusersublimnoticeexamplemorningexamplesublimsublimbackspacesystemexampleshouldsublimlearnfoundenterbackspacelearnmorningmorningfoundthetonightmorningnoticeenterlearnusersystemtonightbackspaceexamplelearntonightbackspaceweshouldcryptosuccessbackspaceexamplesuccesstheshouldmorninguserbackspacelearnthetheshouldcryptocryptotonightbackspacecryptocryptobackspacebackspacenoticeusertonightentermorningfoundweenterexampleenterfoundusersublimsystemtheexampleexamplesystemsuccessusersublimentermorningbackspacesystemfoundlearnsystemshouldsublimsublimentershouldtheusershouldexampleexampleshouldsuccesswelearnfoundsublimshoulduserweentertonightwenoticesublimsystemlearnshouldfoundsuccessuserentersuccessmorningcryptoenteruserfoundexampletonightlearnexampleexamplefoundlearnsuccesssystembackspacecryptonoticethefoundbackspacelearncryptothelearnlearnexamplesuccessnoticenoticesystemmorningcryptotonightnoticenoticeentersuccesscryptoenterbackspacesublimexampleenterfoundtonightcryptotonightsublimnoticesuccesssublimtheentertonighttheshouldthefoundsystemtonightuserbackspacesuccessshouldwebackspacenoticebackspacebackspacenoticewecryptobackspacebackspaceusertonightlearnsuccessmorningusertonightsuccessshouldbackspacecryptoenterentershouldsublimsystemexamplemorningcryptonoticethesuccessthebackspacenoticelearnsublimlearnsuccesscryptothesuccessenternoticecryptosystemsublimsuccesswebackspaceuserenterlearnuserwewemorningsuccesslearncryptobackspacewecryptosystemlearnenterenteruserexamplefoundsystemcryptousernoticefoundusersublimbackspacewesublimnoticemorningshouldexamplenoticecryptoshouldtonightmorningthefoundsystementerentersystemthecryptobackspacesublimlearnsuccessmorningsublimsystemcryptousersublimwesuccessmorningsublimbackspacecryptobackspacesublimthelearnsuccesssublimlearncryptoweweexamplecryptowenoticelearnfoundbackspacesystemsystemexampleshouldlearnsuccesssublimcryptobackspacetonightbackspacemorningmorningnoticeshouldnoticefoundthetheshouldtheshouldfoundfoundcryptosuccessbackspacesuccessshouldweenternoticeweweshouldmorningfoundusersuccessbackspacewenoticeusersuccessenterenterexamplelearnfoundwetonightusercryptothesublimsublimtonightsuccesslearnbackspacetonightentertonightthesublimnoticewefoundcryptobackspaceenterenterlearnlearntonightexamplesystementersublimnoticecryptoshoulduseruserbackspaceuserwesublimmorningwesystemshouldtonighttheusershouldnoticefoundusernoticeentersublimwethewefoundfoundlearnfoundwecryptosystemexamplemorningcryptocryptosublimtheexamplenoticefoundlearnwelearnmorningtheenterthesystemsublimtonightsuccesssystemlearnshouldenterbackspaceentersuccesssuccessbackspaceexamplenoticeentershouldsublimlearnbackspacetheshouldexamplelearnsystemusersublimbackspacebackspacesuccesswelearntonightexamplewecryptoenterwesystemsystemsublimexamplecryptolearnmorningsublimfoundsublimfoundbackspacefoundtonighttonightnoticesuccesssuccessexampleusersuccesstonightsublimcryptosystemweenterexamplesystemthethenoticesublimtonightbackspacenoticesystemexamplethesuccesstonightmorningsuccesstonightwenoticesublimtonightwelearntonightmorningsublimbackspaceenterthetonightenterwecryptofoundtheenternoticebackspacesuccesswesystemuserexamplebackspaceentersuccesstonightsublimwemorningsuccesssuccesswesublimsuccessnoticesublimfoundlearnlearnweexamplecryptonoticelearnweusershoulduserfoundcryptolearnfoundmorningtonightmorningmorningnoticewecryptowewesuccessfoundsublimweuserentershouldshouldshouldsublimbackspacetonightenterwesublimsuccessshouldfoundthethetonightwecryptoweenterfoundcryptoshouldcryptouseruserfoundentersublimsublimthelearntheshouldnoticebackspacefoundsuccessshouldtonightentermorningsystemmorningtonightwenoticelearnbackspaceexampleusershouldnoticesublimsublimexamplethesuccessnoticesystemmorningnoticecryptosystemsublimcryptosystemsuccessshouldmorningbackspaceshouldmorninglearnnoticenoticeshouldthewewesublimsublimnoticeusersuccessentersystemfoundshouldshouldcryptobackspaceusermorningsystemshouldshouldtonightwesublimuserfoundlearnbackspacethetonightmorningexampleuserthefoundbackspaceshouldtonightcryptocryptofounduserexamplenoticecryptousernoticethenoticeshouldweshouldfoundwemorningcryptosuccesslearnfoundtonightsublimnoticenoticewefoundwewesuccesssublimsublimcryptoweexampletonightsuccessfoundshouldsuccesstonightbackspacesystemshouldwesystemnoticebackspaceusersystembackspacewenoticelearnnoticenoticesuccesslearntonightuserlearnsuccessbackspacesuccesswesystemusercryptonoticethesystemusernoticewethesuccessweshouldfoundshouldcryptomorningtonightwethewesuccesslearntheshouldweexampletonightsuccessnoticenoticemorningfoundmorningfoundusersublimsystemsuccessbackspacesuccessmorninguserthefoundweexamplemorningsublimlearnfoundfoundnoticemorningshouldweuserwemorningexamplesuccesssuccessfoundthetheshouldweusershouldtheshouldexamplenoticefoundsuccesssystemfoundshouldsublimbackspacetonightshouldsystemtonightsuccesslearntonightsystemsublimsuccesscryptobackspacesystemsublimmorningmorningshouldmorninglearnsuccesslearnmorningusermorninglearnexamplecryptoshouldbackspacesublimshouldfoundbackspacesystemsystemweexamplesystemtonightsublimmorningmorninguserfoundcryptolearnbackspaceshouldbackspacenoticesublimfoundthecryptousershouldsuccesssystemsuccessshouldsystembackspacesublimshouldsublimsystembackspaceexampleshouldbackspacesublimnoticelearnsublimuserbackspaceusersublimsuccesssublimuserusernoticeshouldsuccessnoticenoticelearnexamplesystemweexamplesublimbackspacebackspacecryptoshouldusercryptosublimbackspacesublimshouldsystemnoticenoticethesuccesssuccesslearnsystemsublimwenoticelearnusersublimsystemusernoticeuserthesuccesslearnwelearnwenoticecryptolearncryptonoticenoticebackspacecryptothecryptousercryptobackspacesuccesslearnthesystemsuccessthesystemsystemcryptosuccessbackspacesublimlearnsublimcryptobackspacelearnsublimusersublimexamplecryptosublimsystemnoticecryptocryptousertheusernoticebackspacenoticenoticethecryptocryptosystembackspacesublimbackspacecryptocryptobackspacesystemuserthenoticesystemsystemsystemusernoticethecryptouserusersystemtheusercryptoexamplenoticecryptoexamplenoticetheexampleexamplethecryptotheusernoticetheexampleexamplecryptotheexampleexamplethenoticethecryptocryptoexampletheexamplecryptocryptothenoticeexamplecryptonoticetheexampleexampleexamplecryptocryptoexampleexamplethenoticethecryptothethethethethetheexampleexamplethetheexampletheexampletheexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexample</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">lm</span> <span class="o">=</span> <span class="n">wordninja</span><span class="o">.</span><span class="n">LanguageModel</span><span class="p">(</span><span class="s1">&#39;my_dict.txt.gz&#39;</span><span class="p">)</span> <span class="o">//</span> <span class="n">é€šè¿‡è°ƒè¯•å†™å‡ºçš„ç®€å•å­—å…¸</span>
</span></span><span class="line"><span class="cl"><span class="n">data_list</span> <span class="o">=</span> <span class="n">lm</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">data_count</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">data_list</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">index</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">hint_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">16</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">m</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data_count</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">20</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">hint_list</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">m</span> <span class="o">+=</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</span></span></code></pre></div><p>è¿è¡Œä¸€ä¸‹è„šæœ¬ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">weshouldlearnthecrypto
</span></span></code></pre></div><p>æ¸¸æˆç»“æŸï¼å¾—åˆ°flagï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">flag{weshouldlearnthecrypto}
</span></span></code></pre></div>

<h2 class="relative group">0x1 [AFCTF2018]Vigenere 
    <div id="0x1-afctf2018vigenere" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#0x1-afctf2018vigenere" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>ç»´å‰å°¼äºšå¯†ç ï¼Œå¤šè¡¨æ›¿æ¢å¯†ç ã€‚æ¥ç§ç§é¢˜ç›®çš„é™„ä»¶ï¼š</p>
<p>ä¸¤ä¸ªé™„ä»¶æ–‡ä»¶ï¼Œä¸€ä¸ªåŠ å¯†çš„<code>flag_encode.txt</code>å’ŒåŠ å¯†ç®—æ³•çš„<code>Encode.c</code></p>
<p>Encode.c</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nf">freopen</span><span class="p">(</span><span class="s">&#34;flag.txt&#34;</span><span class="p">,</span><span class="s">&#34;r&#34;</span><span class="p">,</span><span class="n">stdin</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="nf">freopen</span><span class="p">(</span><span class="s">&#34;flag_encode.txt&#34;</span><span class="p">,</span><span class="s">&#34;w&#34;</span><span class="p">,</span><span class="n">stdout</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="n">key</span><span class="p">[]</span> <span class="o">=</span> <span class="cm">/*SADLY SAYING! Key is eaten by Monster!*/</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="nf">strlen</span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="n">ch</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">while</span><span class="p">((</span><span class="n">ch</span> <span class="o">=</span> <span class="nf">getchar</span><span class="p">())</span> <span class="o">!=</span> <span class="n">EOF</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="n">ch</span><span class="o">&gt;=</span><span class="sc">&#39;a&#39;</span><span class="o">&amp;&amp;</span><span class="n">ch</span><span class="o">&lt;=</span><span class="sc">&#39;z&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">			<span class="nf">putchar</span><span class="p">((</span><span class="n">ch</span><span class="o">-</span><span class="sc">&#39;a&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">[</span><span class="n">index</span><span class="o">%</span><span class="n">len</span><span class="p">]</span><span class="o">-</span><span class="sc">&#39;a&#39;</span><span class="p">)</span><span class="o">%</span><span class="mi">26</span><span class="o">+</span><span class="sc">&#39;a&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			<span class="o">++</span><span class="n">index</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">ch</span><span class="o">&gt;=</span><span class="sc">&#39;A&#39;</span><span class="o">&amp;&amp;</span><span class="n">ch</span><span class="o">&lt;=</span><span class="sc">&#39;Z&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">			<span class="nf">putchar</span><span class="p">((</span><span class="n">ch</span><span class="o">-</span><span class="sc">&#39;A&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">[</span><span class="n">index</span><span class="o">%</span><span class="n">len</span><span class="p">]</span><span class="o">-</span><span class="sc">&#39;a&#39;</span><span class="p">)</span><span class="o">%</span><span class="mi">26</span><span class="o">+</span><span class="sc">&#39;A&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			<span class="o">++</span><span class="n">index</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nf">putchar</span><span class="p">(</span><span class="n">ch</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>flag_encode.txt</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">Yzyj ia zqm Cbatky kf uavin rbgfno ig hnkozku fyyefyjzy sut gha pruyte gu famooybn bhr vqdcpipgu jaaju obecu njde pupfyytrj cpez cklb wnbzqmr ntf li wsfavm azupy nde cufmrf uh lba enxcp, tuk uwjwrnzn inq ksmuh sggcqoa zq obecu zqm Lncu gz Jagaam aaj qx Hwthxn&#39;a Gbj gfnetyk cpez, g fwwang xnapriv li phr uyqnvupk ib mnttqnq xgioerry cpag zjws ohbaul drinsla tuk liufku obecu ovxey zjwg po gnn aecgtsneoa.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Cn poyj vzyoe gxdbhf zq ty oeyl-ndiqkpl, ndag gut mrt cjy yrrgcmd rwwsf, phnz cpel gtw yjdbcnl bl zjwcn Cekjboe cklb yeezjqn htcdcannhum Rvmjlm, phnz juoam vzyoe nxn Tisk, Navarge jvd gng honshoc wf Ugrhcjefy. â€” Cpag zq kyyuek cpefk taadtf, Mxdeetowhps nxn qnfzklopeq gvwnt Sgf, xarvbrvg gngal fufz ywwrxu xlkm gnn koaygfn kf gnn ooiktfyz, â€” Tugc ehrtgnyn aae Owrz uh Yireetvmng hguiief jnateaelcre bl cpefk gfxo, ig ob bhr Xkybp os zqm Prurdy po nrcmr bx vg uxoyobp ig, gpv nk iaycqthzg fys Gbbnznzkpl, fwyvtp qtf lqmhzagoxv oa ywub lrvtlqpyku shz oemjvimopy cps cufmrf op koyh suau, af zq lbam fnjtl fkge gksg rrseye vg ybfric bhrot Kubege jvd Ugrhcjefy. Yzuqkpuy, enqknl, wvrn vcytnzn bhnz Igparasnvtf rqfa asggktifngv mdohrm vog hg ubwntkm noe rkybp aaj czaaykwhp cnabms; ntf swyoejrvgye cdf axckaqeaig zuph fnnen gncl gwnxowl aek ogla dvyywsrj vg mqfska, ehvrg wpelf gam shlhwlwbyk cpaa zq jcchg zqmmfknnyo bl gkwlvyjahc tuk owrzy vg qdipn cpel gtw uychycwmrj. Dmn shrt j toam vjuen bl jjufku shz ufaaxagoqfm, lueydqnt opnuninhug tuk usga Oopnkt rbkfwas n jnaitt vg ladhin bhrs wfxar nhbwlhzg Vyopbzram, vz kk ndevx aqguz, kl co tukrz dhza, li pheuf wfs ywub Coikavmrtv, shz tb vawvvjg fys Ghgals sut lbaie ldbuek uwwqrvzh. â€” Aupn jsm xert cpe cgvayjt faoneegpuy kf gnnae Pungheef; gwl shij am joj zqm nrigkmetl cqqcu iqfmprnowa tuko li wlgka bhrot xinmrx Bgsgkok ib Gbbnznzkpl. Nde uobboee qx nde cxnaeaz Mahc os Mamag Htanwia ob i hvyvglu os xnxenzgv cjjhxrms ntf mmqrcgcqoay, cdf daiowo ia jkjyyt bhsmcg zjw yotnhuqsusgfn kf nt jjsbrwly Pyegwvy bbgj ndefk Bbagku. Li lrbbn bhvy, nwn Bapzb je fadecptrj cw a pgpvcz wbxul.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Hr nck lafhynl hvy Ckmang zx Tajy, vzy iofz fpoykugga aaj wmcryuslu fbx cpe caddcy gbum.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Pe ugu xinbvjmmn uou Yireetxzs gu rsmo Lncb wf vsowxeagk jvd cxgkment ovxoezcfwa, uarnas fauhyjdrj rv tukkj ileegcqoa zkdf dif Gbaeaz uziqlq hn wbggkfyz; aaj fpea yq kooprtmmd, uk jsm qtgkaty akidyytrj cw agzgfx po gnnu.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Hr nck lafhynl tb vckm ktuka Tajy hgl phr glkozsqvupibt xn lnxiw xesgxrktf uh hykpyk, dvlryu lbksr vnwpyk ygohd ekuqndakkb phr xrohg uh Jylrrynvtnzkgh en gnn Tetoudupuek, j zitnv ahasgovibyk vg ndez gwl fbxoaxwbyk cw tlxcfno oarh.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Pe ugu uuhlrj cwgrzjwl hetobtagoxw vkdvkb it crcuyo uaabcay, apuiifbxcibyk, cfx zifzjvt sxqe nde qkywsvzqjs kf gnnqr Caddcy Rrixzdf, lqj nde fuum phxrgma os ljbitakfa phrs rvtb iqejhintlm wvzj zco mrgbcrry.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Jw bws qobaoybgv Lapekbmnggvapa Hbabms ekrwupeqrh, noe urhioiam fqtu scffu fvxvvefy jam enigbqoay qf nde eopptf uh lba pruyte.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Uk jsm nesabmd sut s fknt zrue, nlvwl oupn mqsfunmneoay, cw cnauw iphrxb bo ok gdyytrj, fpeekdq nde Ykpqsygvapa Pbcnzs, vtesjwbyk xn Aatkzchagoxv, hnbg jypuetnl tb zjw Jaocrn it ygtyy boe zqmie kzwlyifk; cpe Fzcly nezgrviam kf nde zkjv tvsg wrlofkm bo nrn lba dntpmrf uh ahrafoxv feuo ocphbac, inq iqfpqlfoxvs jovzcj.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Hr nja eajgspkuekm bo cxgnyjt gnn xocansneoa uo bhryg Knwtry; owr gncl jqrcubm ooyvjoytvtp bhr Rcom boe Tjbuegnatwtvuw wf Sutwccnrxb; zesauahc tb vjas bzjwlo tb kwkohxcyy phroa uitxclcknf nrbhrx, cfx navyrvg gng uijdvzrwnf uh fys Acvawpeoclcknf uo Taaju.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Zy daf ukateaelyz tuk Jlmvtkknnagoxv os Pwknecr hh zesauahc hvy Jasrtv li Hajy owr ryvsvhifnrvg Wafaweaee Ywwrxu.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Zy daf sjle Wafyyo drvnvdrtv gh dif Crtl nrqfy boe zqm trtwjy kf gnnqr blhawas, ntm bhr gogojt ntm xalsgfn kf gnnqr fgnsleef.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">luig vy cxwpf{Jnxwobuqg_O_Cogiqi!}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Hr nck ynepznl a zanlcpuqk xn Nrc Qxzecry, jvd fkpl betuka awnxok ib Oslrkeey vg bwrnyb wue vggjhe ntm mag uwl ndevx bcbfzcfwa.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Hr nja krvv sgknt ab, qn goowm kf ckjke, Fzcfxent Gauiry yandohz cpe Pupkyjt bl xcr ykiamhagaams.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Uk jsm wfsklbeq zq jyjdrx cpe Zonanwrl owleckpvyjt bl jvd farwleoe zx bhr Iknch Pbcnz.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Hr nck wkmoowmd jovz iphrxb bo fadbyyt hy cw a watamzipzrwn sutwccn gu xcr pupknethzrwn, ntf mhwcxtxelrjiwx xy baa tajy; iapent nra Afygfn po gnnqr Nivk ib pekcmnqkf Dycifrjbibt:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Hgl munxcmrvti dungr hxliry qx unmrj czobvu sgknt ab:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Noe vtgnacgowo tuko, ts w mbit Brvgn xlkm cawqsusgfn boe gwg Mhxfwlo wuolp tuka kbkuyj lwmzov gh phr Owpaoovshps bl cpefk Ulupef:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Lxz chzvahc osl xcr Gxcvy sign jtl cgtlm kf gnn eoerf:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Xin izvxaiam Vsras bt da wvzjgop ohx Lwnfkpl:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Zkr qkyziiopy oo ia sjvy pguwm, kf gnn jeakhan kf Gxril oe Lmlu:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Fbx czaayrglpiam da breqfx Oeny cw br ztayz fbx yzegkpvyz oslnvcry:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Hgl wbbrrahvti lba fekn Ayfzge ib Eamuqsu Rcom en n tnqguhqmlent Vawvvtew, yotnhuqsuopy ndeekrv aa Gttcprnxh ooiktfgang, gwl earcjaent oca Bbapvuniry bw af zq jyjdrx rb ag upuy wn rdjupyk cfx big owateaowhp fbx rvteufmwent zqm snsg svooyacm rhrg ahpo gnnae Pungheef
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Lxz tnqkfa wwne xcr Pncjnarf, gkwlvyjahc ohx vwsg bcdowbyk Uiwf gpv uhtrxrvg sapvuieazjtll zjw Zkrzy xn ohx Igparasnvtf:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Lqj mqsckwliam qml kwa Rnoifrclonef, gwl drinslent zqmmfknnyo iabnatrj yand pbcnz tb rgycolnzn noe au ah wly ijaef cjsnoorbnz.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Hr nck uxdvijbeq Mqnynnzkwb hrxg, ts zeprjziam wk iqt bl qqs Cxqlyytvuw inq ccycjg Jga ignopkn qs.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Uk qis crwfxarrj xcr fkck, lwvnmnl ohx eguotf, hdzng uwj nkway, jvd qkullkyrj cpe yoxwm kf baa xebvnw.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Ba if gc bhvy vaga tegwapbxvahc lnxpm Aeskwm kf suamitt Owlyeagaqef zq uiipykjb tuk yglgs bl mmagn, fwmklnzrwn, ntf lsnaath, ilekcvs xetaw eign ealyuzycinpku gz Yrhkuby &amp; Cktxczy fijzcrra hunayrnteq op lba mbyc jaehcjiqs nmna, aaj vgnwlye dvwbxvzs phr Nnid bl c ucriyoimd agvaij.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Hr nja cbtullwiakm wue lgdfkw Pocqzrtu lugea Ijxtvbg gh phr nroh Fkck nk brga Irzy cyuenfz cpevx Egojtee, cw briqey phr kgmchzkgharf uo bhrot xleeajb inq Htwndrrt, xz tb lcdf phrsbmliku ts phroa Paaju.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Zy daf kgkigkf viiefzrk iaywjlacgoxvs nsqfaot hy, jvd ugu whzenbxcrrj vg vniam xv tuk kfbwbvzjvtf uh gon feuwbirxu, lba mrxlqlryu Ahzint Bivnmgk qdofk tvojt tmfa os cjzfnxg, am wn htmqsgopyoesukm lefztmwpibt xn ayr cyyo, srdna aaj eghzigoxvs.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Vt gnyny fzjoe bl vzyoe Bvyzefykgho Wr njde Ckvaneoakm noe Xgvlasf ow bhr sqkn duzhum trxok: Iqr ekymagkf Hypigoxvs ugxw vaea gwawrxgv ijll hh zeckclyz iapdzy. N Vtahye, jnxae pncjuytrx ra tuau eunkrj kg eiktq uyt jnrkh zga vybiak j Byegpl, co ualrb tb hg lba rhrnz os g hjya pruyte.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Aut zure Jk kmea ccfnent ow itgkplcknf zx wue Htanesu hamtuxgf. Qa hnbn eaetgv ndez lawm goow nk tvsn wf nzvwgltf hh bhrot dycifrjbuek vg yttrtm in htyslnaazjjlr pwjcodvicqoa uxwl qs. Jk qivr xgecjdrj cpez uh lba cvxlcmfzcfwas bl xcr rskylwtvuw inq yglnhezkwb hrxg. Oy daik jxprgnwx po gnnqr agvapa jhycqcr gpv gwgagwqmvza, shz wr njde pupboneq zqmm oe vzy piry xn ohx eggioa qrvdekf li zifgeww gngky qshxyitvupk, qdipn fwuyj kfyriggkty vtvwlnucz xcr pupfyytvuwa aaj eglnefvxvdrtew. Ndel zxw hnbg tyan qkjn tb zjw pkipk xn jhyvawa aaj xn cbtushcuvtrby. Jk ommp, tukamfbxg, swmuvkbke vt vzy jepkbaige, yzcyh qkwwuaigk iqr Fkyirnzkgh, wnq nxtd gnge, uo wr nxtd gng jyot bl vinxopv, Yjezona ia Ccj, cj Prglm Feogfxo.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Wr, zqmrrlqjy, phr Xnxrrygfnwtvbna os zjw ojigkm Atnzgk ib Azkaqcn, op Yyjeegu Koamtwmo, Afynubykf, sjlenrrvg gu vzy Oucxnue Wafyy kf gnn eoerf xin tuk amcgovmxa os udz iazgfneoay, mw, ia zjw Hwmr, gwl bl Gwlbkrvzh wf gng yikd Ckxxlr uh lbasr Ixtoaogk, mklrswty caddcoh ntm leprcjy, Phnz cpefk wfcpeq Ixtoaogk une, ntm wf Eoizn kutnc bo ok Hjya aaj Rvdrvgfxang Ycitry, vzup tukh irr Gdkihvrj ozoz gnd Uhlrmrinpk vg nde Oxrbifn Ejisn, ntm bhnz cdf loyocqcnr eghjepzrwn okvoyan gnnu aaj vzy Otnzn wf Txgsn Xrvzjqn, vy cfx kutnc bo ok vgnwlye mqsfunnyz; aaj cpag gu Xlae ntm Qnqkrwhzeaz Bbagku, lbay ugem fhrn Hisee zx teie Ysl, yoaiucdr Vgswa, cbtczapz Cdfeaaina, efzctfesu Ixumrxew, ujd gu mw ayr qlbar Nica aaj Vzcjgf cqqcu Opvyleajnvt Fzclyo mne xn rvmjl xk. â€” Aaj owr gng kolpbxc wf gnkk Xacygaitvup, ocph n lrzm eknaujcr uw bhr vtgnacgoxv os Jkncje Cxxdiqkpuy, se zaccayra hfadtk cw enij gndee udz Lvbgk, iqr Suabuaku, shz ohx bicekf Zijoe.
</span></span></code></pre></div><p>ç›´æ¥å»ç»´å‰å°¼äºšå¯†ç ç ´è§£ç½‘ç«™è¿›è¡Œç ´è§£å°±å¥½ï¼Œè¿›è¡Œç ´è§£å¾—åˆ°ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">When in the Course of human events it becomes necessary for one people to dissolve the political bands which have connected them with another and to assume among the powers of the earth, the separate and equal station to which the Laws of Nature and of Nature&#39;s God entitle them, a decent respect to the opinions of mankind requires that they should declare the causes which impel them to the separation.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">We hold these truths to be self-evident, that all men are created equal, that they are endowed by their Creator with certain unalienable Rights, that among these are Life, Liberty and the pursuit of Happiness. â€” That to secure these rights, Governments are instituted among Men, deriving their just powers from the consent of the governed, â€” That whenever any Form of Government becomes destructive of these ends, it is the Right of the People to alter or to abolish it, and to institute new Government, laying its foundation on such principles and organizing its powers in such form, as to them shall seem most likely to effect their Safety and Happiness. Prudence, indeed, will dictate that Governments long established should not be changed for light and transient causes; and accordingly all experience hath shewn that mankind are more disposed to suffer, while evils are sufferable than to right themselves by abolishing the forms to which they are accustomed. But when a long train of abuses and usurpations, pursuing invariably the same Object evinces a design to reduce them under absolute Despotism, it is their right, it is their duty, to throw off such Government, and to provide new Guards for their future security. â€” Such has been the patient sufferance of these Colonies; and such is now the necessity which constrains them to alter their former Systems of Government. The history of the present King of Great Britain is a history of repeated injuries and usurpations, all having in direct object the establishment of an absolute Tyranny over these States. To prove this, let Facts be submitted to a candid world.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">He has refused his Assent to Laws, the most wholesome and necessary for the public good.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">He has forbidden his Governors to pass Laws of immediate and pressing importance, unless suspended in their operation till his Assent should be obtained; and when so suspended, he has utterly neglected to attend to them.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">He has refused to pass other Laws for the accommodation of large districts of people, unless those people would relinquish the right of Representation in the Legislature, a right inestimable to them and formidable to tyrants only.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">He has called together legislative bodies at places unusual, uncomfortable, and distant from the depository of their Public Records, for the sole purpose of fatiguing them into compliance with his measures.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">He has dissolved Representative Houses repeatedly, for opposing with manly firmness his invasions on the rights of the people.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">He has refused for a long time, after such dissolutions, to cause others to be elected, whereby the Legislative Powers, incapable of Annihilation, have returned to the People at large for their exercise; the State remaining in the mean time exposed to all the dangers of invasion from without, and convulsions within.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">He has endeavoured to prevent the population of these States; for that purpose obstructing the Laws for Naturalization of Foreigners; refusing to pass others to encourage their migrations hither, and raising the conditions of new Appropriations of Lands.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">He has obstructed the Administration of Justice by refusing his Assent to Laws for establishing Judiciary Powers.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">He has made Judges dependent on his Will alone for the tenure of their offices, and the amount and payment of their salaries.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">flag is afctf{Whooooooo_U_Gotcha!}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">He has erected a multitude of New Offices, and sent hither swarms of Officers to harass our people and eat out their substance.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">He has kept among us, in times of peace, Standing Armies without the Consent of our legislatures.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">He has affected to render the Military independent of and superior to the Civil Power.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">He has combined with others to subject us to a jurisdiction foreign to our constitution, and unacknowledged by our laws; giving his Assent to their Acts of pretended Legislation:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">For quartering large bodies of armed troops among us:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">For protecting them, by a mock Trial from punishment for any Murders which they should commit on the Inhabitants of these States:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">For cutting off our Trade with all parts of the world:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">For imposing Taxes on us without our Consent:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">For depriving us in many cases, of the benefit of Trial by Jury:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">For transporting us beyond Seas to be tried for pretended offences:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">For abolishing the free System of English Laws in a neighbouring Province, establishing therein an Arbitrary government, and enlarging its Boundaries so as to render it at once an example and fit instrument for introducing the same absolute rule into these Colonies
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">For taking away our Charters, abolishing our most valuable Laws and altering fundamentally the Forms of our Governments:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">For suspending our own Legislatures, and declaring themselves invested with power to legislate for us in all cases whatsoever.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">He has abdicated Government here, by declaring us out of his Protection and waging War against us.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">He has plundered our seas, ravaged our coasts, burnt our towns, and destroyed the lives of our people.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">He is at this time transporting large Armies of foreign Mercenaries to compleat the works of death, desolation, and tyranny, already begun with circumstances of Cruelty &amp; Perfidy scarcely paralleled in the most barbarous ages, and totally unworthy the Head of a civilized nation.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">He has constrained our fellow Citizens taken Captive on the high Seas to bear Arms against their Country, to become the executioners of their friends and Brethren, or to fall themselves by their Hands.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">He has excited domestic insurrections amongst us, and has endeavoured to bring on the inhabitants of our frontiers, the merciless Indian Savages whose known rule of warfare, is an undistinguished destruction of all ages, sexes and conditions.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">In every stage of these Oppressions We have Petitioned for Redress in the most humble terms: Our repeated Petitions have been answered only by repeated injury. A Prince, whose character is thus marked by every act which may define a Tyrant, is unfit to be the ruler of a free people.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Nor have We been wanting in attentions to our British brethren. We have warned them from time to time of attempts by their legislature to extend an unwarrantable jurisdiction over us. We have reminded them of the circumstances of our emigration and settlement here. We have appealed to their native justice and magnanimity, and we have conjured them by the ties of our common kindred to disavow these usurpations, which would inevitably interrupt our connections and correspondence. They too have been deaf to the voice of justice and of consanguinity. We must, therefore, acquiesce in the necessity, which denounces our Separation, and hold them, as we hold the rest of mankind, Enemies in War, in Peace Friends.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">We, therefore, the Representatives of the united States of America, in General Congress, Assembled, appealing to the Supreme Judge of the world for the rectitude of our intentions, do, in the Name, and by Authority of the good People of these Colonies, solemnly publish and declare, That these united Colonies are, and of Right ought to be Free and Independent States, that they are Absolved from all Allegiance to the British Crown, and that all political connection between them and the State of Great Britain, is and ought to be totally dissolved; and that as Free and Independent States, they have full Power to levy War, conclude Peace, contract Alliances, establish Commerce, and to do all other Acts and Things which Independent States may of right do. â€” And for the support of this Declaration, with a firm reliance on the protection of Divine Providence, we mutually pledge to each other our Lives, our Fortunes, and our sacred Honor.
</span></span></code></pre></div><p>åœ¨ç ´è§£å¾—åˆ°æ–‡å­—ä¸­æ‰¾åˆ°flagï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">afctf{Whooooooo_U_Gotcha!}
</span></span></code></pre></div>

<h2 class="relative group">0x2 [NPUCTF2020]è¿™æ˜¯ä»€ä¹ˆğŸ 
    <div id="0x2-npuctf2020%E8%BF%99%E6%98%AF%E4%BB%80%E4%B9%88" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#0x2-npuctf2020%E8%BF%99%E6%98%AF%E4%BB%80%E4%B9%88" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>çœ‹é¢˜ç›®åº”è¯¥æ˜¯ä¸ªè„‘æ´é¢˜ï¼Œå¤å…¸å¯†ç å­¦é¢˜ç›®ï¼Œç§ç§é™„ä»¶å§ï¼š</p>
<p>é™„ä»¶æ˜¯ä¸€ä¸ª<code>attachment</code>æ–‡ä»¶ï¼Œæ²¡æœ‰æ–‡ä»¶æ‰©å±•åâ€¦â€¦é‚£å°±å…ˆæ¢æµ‹ä¸€ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">file attachment
</span></span></code></pre></div><p>å¾—åˆ°æ¢æµ‹è¾“å‡ºï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">attachment: Zip archive data, at least v2.0 to extract
</span></span></code></pre></div><p>åº”è¯¥æ˜¯ä¸€ä¸ªå‹ç¼©æ–‡ä»¶ï¼Œä¿®æ”¹æ–‡ä»¶åä¸º<code>attachment.zip</code>ï¼Œç„¶åè¿›è¡Œè§£å‹ï¼Œå¾—åˆ°äº†ä¸€ä¸ªå›¾ç‰‡ï¼š</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="/images/BUUCTF-CRYPTO-5_writeup/flag.jpg" alt="flag" />
      
    </figure>
</p>
<p>ï¼ˆè¿™æ˜¯æ‚é¡¹é¢˜ç›®ï¼Œè¶Šåšè¶Šä¸åƒå¯†ç å­¦ï¼‰</p>
<p>è¿™ä¸ªå›¾ç‰‡åº”è¯¥å°±æ˜¯å¯†ç ï¼Œè®¤çœŸè§‚å¯Ÿä¸€ä¸‹å›¾ç‰‡ï¼Œå‘ç°å›¾ç‰‡åº•éƒ¨æœ‰å¯†æ–‡ã€‚</p>
<p>å¯¹å¯†æ–‡è¿›è¡Œåˆ†æï¼š</p>
<ol>
<li>æ—¥å†çš„å‘¨æ˜¯æŒ‰è‹±æ–‡æ¥è¿›è¡Œæ˜¾ç¤ºçš„</li>
<li>å¯†æ–‡æ•°ç»„ä¸­çš„é¦–å­—æ¯å¥½åƒå¯¹åº”ç€è‹±æ–‡çš„å‘¨</li>
</ol>
<p>å› æ­¤å¯ä»¥æ ¹æ®ä»¥ä¸‹æ€è·¯è¿›è¡Œè§£é¢˜ï¼š</p>
<ol>
<li>æ ¹æ®å¯†ç éœ€è¦å¯¹åº”æ•°å­—</li>
<li>å°†æ•°å­—æ˜ å°„åˆ°å­—æ¯è¡¨</li>
<li>è®²å­—æ¯æ‹¼æ¥</li>
</ol>
<p>æ ¹æ®æ€è·¯ï¼Œå†™ä¸ªè„šæœ¬æ±‚è§£ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">string</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="s2">&#34;F1 W1 S22 S21 T12 S11 W1 S13&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">encode_cal</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">encode_dict</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;M&#39;</span><span class="p">:[],</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;T1&#39;</span><span class="p">:[],</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;W&#39;</span><span class="p">:[],</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;T2&#39;</span><span class="p">:[],</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;F&#39;</span><span class="p">:[],</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;S1&#39;</span><span class="p">:[],</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;S2&#39;</span><span class="p">:[]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">dict_index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;T1&#39;</span><span class="p">,</span><span class="s1">&#39;W&#39;</span><span class="p">,</span><span class="s1">&#39;T2&#39;</span><span class="p">,</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="s1">&#39;S1&#39;</span><span class="p">,</span><span class="s1">&#39;S2&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">index</span> <span class="o">=</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">encode_dict</span><span class="p">[</span><span class="n">dict_index</span><span class="p">[(</span><span class="n">index</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">%</span><span class="mi">7</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">result</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span> <span class="o">+=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_lowercase</span><span class="p">[</span><span class="n">encode_dict</span><span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">==</span><span class="mi">3</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span> <span class="o">+=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_lowercase</span><span class="p">[</span><span class="n">encode_dict</span><span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]][</span><span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">result</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">c_list</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag</span> <span class="o">=</span> <span class="n">encode_cal</span><span class="p">(</span><span class="n">c_list</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span></code></pre></div><p>è¿è¡Œè„šæœ¬ï¼Œæ¸¸æˆç»“æŸï¼</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">calendar
</span></span></code></pre></div>

<h2 class="relative group">0x3 easyrsa 
    <div id="0x3-easyrsa" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#0x3-easyrsa" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>rsaé¢˜ç›®ï¼Œæ¥ï¼Œè®©æˆ‘ä»¬æš´æ‰“å‡ºé¢˜äººï¼</p>
<p>é™„ä»¶æ˜¯ä¸ªpythonæºç ç¨‹åº</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">getPrime</span><span class="p">,</span><span class="n">bytes_to_long</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Derivative</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">fractions</span> <span class="kn">import</span> <span class="n">Fraction</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">secret</span> <span class="kn">import</span> <span class="n">flag</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">=</span><span class="n">getPrime</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">q</span><span class="o">=</span><span class="n">getPrime</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">e</span><span class="o">=</span><span class="mi">65537</span>
</span></span><span class="line"><span class="cl"><span class="n">n</span><span class="o">=</span><span class="n">p</span><span class="o">*</span><span class="n">q</span>
</span></span><span class="line"><span class="cl"><span class="n">z</span><span class="o">=</span><span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Derivative</span><span class="p">(</span><span class="n">arctan</span><span class="p">(</span><span class="n">p</span><span class="p">),</span><span class="n">p</span><span class="p">))</span><span class="o">-</span><span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Derivative</span><span class="p">(</span><span class="n">arth</span><span class="p">(</span><span class="n">q</span><span class="p">),</span><span class="n">q</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">m</span><span class="o">=</span><span class="n">bytes_to_long</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span><span class="o">=</span><span class="nb">pow</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">output:
</span></span></span><span class="line"><span class="cl"><span class="s1">7922547866857761459807491502654216283012776177789511549350672958101810281348402284098310147796549430689253803510994877420135537268549410652654479620858691324110367182025648788407041599943091386227543182157746202947099572389676084392706406084307657000104665696654409155006313203957292885743791715198781974205578654792123191584957665293208390453748369182333152809882312453359706147808198922916762773721726681588977103877454119043744889164529383188077499194932909643918696646876907327364751380953182517883134591810800848971719184808713694342985458103006676013451912221080252735948993692674899399826084848622145815461035
</span></span></span><span class="line"><span class="cl"><span class="s1">32115748677623209667471622872185275070257924766015020072805267359839059393284316595882933372289732127274076434587519333300142473010344694803885168557548801202495933226215437763329280242113556524498457559562872900811602056944423967403777623306961880757613246328729616643032628964072931272085866928045973799374711846825157781056965164178505232524245809179235607571567174228822561697888645968559343608375331988097157145264357626738141646556353500994924115875748198318036296898604097000938272195903056733565880150540275369239637793975923329598716003350308259321436752579291000355560431542229699759955141152914708362494482
</span></span></span><span class="line"><span class="cl"><span class="s1">15310745161336895413406690009324766200789179248896951942047235448901612351128459309145825547569298479821101249094161867207686537607047447968708758990950136380924747359052570549594098569970632854351825950729752563502284849263730127586382522703959893392329333760927637353052250274195821469023401443841395096410231843592101426591882573405934188675124326997277775238287928403743324297705151732524641213516306585297722190780088180705070359469719869343939106529204798285957516860774384001892777525916167743272419958572055332232056095979448155082465977781482598371994798871917514767508394730447974770329967681767625495394441
</span></span></span><span class="line"><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;</span>
</span></span></code></pre></div><p>ç®€å•å®¡è®¡ä¸€ä¸‹ï¼Œå‘ç°å°±æ˜¯é“æ•°å­¦é¢˜ï¼Œå¾®åˆ†æ–¹ç¨‹çš„é¢˜ç›®ã€‚è¿™pythonç¨‹åºçš„å…³é”®ä»£ç ä¹Ÿåªæœ‰ä¸€è¡Œï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">z</span><span class="o">=</span><span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Derivative</span><span class="p">(</span><span class="n">arctan</span><span class="p">(</span><span class="n">p</span><span class="p">),</span><span class="n">p</span><span class="p">))</span><span class="o">-</span><span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Derivative</span><span class="p">(</span><span class="n">arth</span><span class="p">(</span><span class="n">q</span><span class="p">),</span><span class="n">q</span><span class="p">))</span>
</span></span></code></pre></div><p>åº”è¯¥å°±æ˜¯æ±‚è§£æ–¹ç¨‹çš„äº‹æƒ…ï¼Œå› ä¸ºæ¶‰åŠæ•°å­¦è¿ç®—ï¼Œæ‰€ä»¥å†™ä¸ªsageè„šæœ¬æ±‚è§£å§</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">long_to_bytes</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="mi">7922547866857761459807491502654216283012776177789511549350672958101810281348402284098310147796549430689253803510994877420135537268549410652654479620858691324110367182025648788407041599943091386227543182157746202947099572389676084392706406084307657000104665696654409155006313203957292885743791715198781974205578654792123191584957665293208390453748369182333152809882312453359706147808198922916762773721726681588977103877454119043744889164529383188077499194932909643918696646876907327364751380953182517883134591810800848971719184808713694342985458103006676013451912221080252735948993692674899399826084848622145815461035</span>
</span></span><span class="line"><span class="cl"><span class="n">z</span> <span class="o">=</span> <span class="mi">32115748677623209667471622872185275070257924766015020072805267359839059393284316595882933372289732127274076434587519333300142473010344694803885168557548801202495933226215437763329280242113556524498457559562872900811602056944423967403777623306961880757613246328729616643032628964072931272085866928045973799374711846825157781056965164178505232524245809179235607571567174228822561697888645968559343608375331988097157145264357626738141646556353500994924115875748198318036296898604097000938272195903056733565880150540275369239637793975923329598716003350308259321436752579291000355560431542229699759955141152914708362494482</span>
</span></span><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="mi">15310745161336895413406690009324766200789179248896951942047235448901612351128459309145825547569298479821101249094161867207686537607047447968708758990950136380924747359052570549594098569970632854351825950729752563502284849263730127586382522703959893392329333760927637353052250274195821469023401443841395096410231843592101426591882573405934188675124326997277775238287928403743324297705151732524641213516306585297722190780088180705070359469719869343939106529204798285957516860774384001892777525916167743272419958572055332232056095979448155082465977781482598371994798871917514767508394730447974770329967681767625495394441</span>
</span></span><span class="line"><span class="cl"><span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">var</span><span class="p">(</span><span class="s1">&#39;p, q&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">f1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">diff</span><span class="p">(</span><span class="n">arctan</span><span class="p">(</span><span class="n">p</span><span class="p">),</span><span class="n">p</span><span class="p">))</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">diff</span><span class="p">(</span><span class="n">arctanh</span><span class="p">(</span><span class="n">q</span><span class="p">),</span><span class="n">q</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">f2</span> <span class="o">=</span> <span class="n">p</span><span class="o">*</span><span class="n">q</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">solve</span><span class="p">([</span><span class="n">f1</span><span class="o">==</span><span class="n">z</span><span class="p">,</span><span class="n">f2</span><span class="o">==</span><span class="n">n</span><span class="p">],(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">q</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)[</span><span class="mi">5</span><span class="p">:])</span>
</span></span><span class="line"><span class="cl"><span class="n">q</span> <span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">q</span><span class="p">)[</span><span class="mi">5</span><span class="p">:])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">d</span> <span class="o">=</span> <span class="n">inverse_mod</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">phi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">m</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="n">long_to_bytes</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>  
</span></span></code></pre></div><blockquote>
<p>ç”±äºsagemathæ˜¯åŸºäºpython3çš„å¼€æºæ•°å­¦è½¯ä»¶ï¼Œè¿›è¡Œsageè¿è¡Œsageè„šæœ¬æ˜¯ä¼šè½¬æ¢æˆpythonæ ¼å¼è¿›è¡Œè¿è¡Œï¼Œä»£ç éå¸¸åƒpython3</p>
</blockquote>
<p>è¿è¡Œè„šæœ¬ï¼Œæš´æ‰“å‡ºé¢˜äººï¼</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">b&#39;BJD{Advanced_mathematics_is_too_hard!!!}&#39;
</span></span></code></pre></div>

<h2 class="relative group">0x4 babyRSA 
    <div id="0x4-babyrsa" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#0x4-babyrsa" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>åˆä¸€ä¸ªRSAé¢˜ç›®ï¼Œå¸Œæœ›è¿™ä¸ªä¸å•å•åªæ˜¯æ•°å­¦è¿ç®—äº†ï¼Œçœ‹çœ‹é¢˜ç›®ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">flag</span> <span class="kn">import</span> <span class="n">flag</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">nextPrime</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">n</span> <span class="o">+=</span> <span class="mi">2</span> <span class="k">if</span> <span class="n">n</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="ow">not</span> <span class="n">isPrime</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">n</span> <span class="o">+=</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">n</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">q</span> <span class="o">=</span> <span class="n">nextPrime</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span>
</span></span><span class="line"><span class="cl"><span class="n">e</span> <span class="o">=</span> <span class="mh">0x10001</span>
</span></span><span class="line"><span class="cl"><span class="n">d</span> <span class="o">=</span> <span class="n">inverse</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">bytes_to_long</span><span class="p">(</span><span class="n">flag</span><span class="o">.</span><span class="n">encode</span><span class="p">()),</span> <span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># d = 19275778946037899718035455438175509175723911466127462154506916564101519923603308900331427601983476886255849200332374081996442976307058597390881168155862238533018621944733299208108185814179466844504468163200369996564265921022888670062554504758512453217434777820468049494313818291727050400752551716550403647148197148884408264686846693842118387217753516963449753809860354047619256787869400297858568139700396567519469825398575103885487624463424429913017729585620877168171603444111464692841379661112075123399343270610272287865200880398193573260848268633461983435015031227070217852728240847398084414687146397303110709214913</span>
</span></span><span class="line"><span class="cl"><span class="c1"># c = 5382723168073828110696168558294206681757991149022777821127563301413483223874527233300721180839298617076705685041174247415826157096583055069337393987892262764211225227035880754417457056723909135525244957935906902665679777101130111392780237502928656225705262431431953003520093932924375902111280077255205118217436744112064069429678632923259898627997145803892753989255615273140300021040654505901442787810653626524305706316663169341797205752938755590056568986738227803487467274114398257187962140796551136220532809687606867385639367743705527511680719955380746377631156468689844150878381460560990755652899449340045313521804</span>
</span></span></code></pre></div><p>è¿™é“é¢˜ç›®çš„è¾“å‡ºæ˜¯dã€cï¼Œåœ¨ç®—æ³•ç¨‹åºé‡Œé¢æš´éœ²å‡ºäº†eã€‚ä½†æ˜¯nä¸çŸ¥é“ï¼Œè¿™å°±æœ‰ç‚¹éº»çƒ¦äº†ã€‚ç®€å•æ¨å¯¼ä¸€ä¸‹å…¬å¼ï¼š
$$
\phi = (p-1)\times(q-1)
$$</p>
<p>$$
d \equiv e^{-1} \text{mod}\phi
$$</p>
<p>$$
d \cdot e \equiv 1\text{mod} \phi
$$</p>
<p>$$
d\cdot e -1 = k \cdot(p-1)\cdot(q-1)
$$
æ ¹æ®æ¨å¯¼ï¼Œå¯ä»¥è‚¯å®šçš„æ˜¯è¿™é“é¢˜ç›®éœ€è¦è¿›è¡Œçˆ†ç ´ã€‚ä¸ºäº†æé«˜çˆ†ç ´æ•ˆç‡ï¼Œéœ€è¦è¿›è¡Œç¼©å°èŒƒå›´æ¥è¿›è¡Œæ›´å¿«æ±‚è§£ã€‚ç¼©å°èŒƒå›´éœ€è¦å…ˆè¿›è¡Œåˆ¤æ–­ï¼špå’Œqéƒ½æ˜¯1024ä½ï¼Œnå°±æ˜¯2048ä½ã€‚è¿›è¡Œç®€å•çš„æµ‹è¯•å‘ç°ed-1æ˜¯2064ä½ï¼Œé‚£ä¹ˆå¯ä»¥åˆ¤æ–­å‡ºkä¸€å®šæ˜¯å°äº16ä½çš„ï¼Œæ ¹æ®ç›®å‰çš„æ¨æ–­æ¥å†™è„šæœ¬è¿›è¡Œæ±‚è§£ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">libnum</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sympy</span>
</span></span><span class="line"><span class="cl"><span class="n">e</span> <span class="o">=</span> <span class="mh">0x10001</span>
</span></span><span class="line"><span class="cl"><span class="n">d</span> <span class="o">=</span> <span class="mi">19275778946037899718035455438175509175723911466127462154506916564101519923603308900331427601983476886255849200332374081996442976307058597390881168155862238533018621944733299208108185814179466844504468163200369996564265921022888670062554504758512453217434777820468049494313818291727050400752551716550403647148197148884408264686846693842118387217753516963449753809860354047619256787869400297858568139700396567519469825398575103885487624463424429913017729585620877168171603444111464692841379661112075123399343270610272287865200880398193573260848268633461983435015031227070217852728240847398084414687146397303110709214913</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="mi">5382723168073828110696168558294206681757991149022777821127563301413483223874527233300721180839298617076705685041174247415826157096583055069337393987892262764211225227035880754417457056723909135525244957935906902665679777101130111392780237502928656225705262431431953003520093932924375902111280077255205118217436744112064069429678632923259898627997145803892753989255615273140300021040654505901442787810653626524305706316663169341797205752938755590056568986738227803487467274114398257187962140796551136220532809687606867385639367743705527511680719955380746377631156468689844150878381460560990755652899449340045313521804</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ed_1</span> <span class="o">=</span> <span class="n">e</span><span class="o">*</span><span class="n">d</span><span class="o">-</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span><span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">16</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">ed_1</span> <span class="o">%</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">phi</span> <span class="o">=</span> <span class="n">ed_1</span><span class="o">//</span><span class="n">k</span>
</span></span><span class="line"><span class="cl">        <span class="n">base</span> <span class="o">=</span> <span class="n">libnum</span><span class="o">.</span><span class="n">nroot</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">p</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">nextprime</span><span class="p">(</span><span class="n">base</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">q</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">prevprime</span><span class="p">(</span><span class="n">base</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">k</span> <span class="o">==</span> <span class="n">ed_1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">n</span> <span class="o">=</span> <span class="n">p</span><span class="o">*</span><span class="n">q</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">m</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="n">libnum</span><span class="o">.</span><span class="n">n2s</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span> <span class="n">flag</span>
</span></span></code></pre></div><p>æ±‚è§£æ–¹å¼æ¯”è¾ƒæš´åŠ›ï¼Œæ‰§è¡Œè„šæœ¬å°±æ‹¿åˆ°flagäº†ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">NCTF{70u2_nn47h_14_v3ry_gOO0000000d}
</span></span></code></pre></div>

<h2 class="relative group">0x5 [AFCTF2018]ä½ èƒ½çœ‹å‡ºè¿™æ˜¯ä»€ä¹ˆåŠ å¯†ä¹ˆ 
    <div id="0x5-afctf2018%E4%BD%A0%E8%83%BD%E7%9C%8B%E5%87%BA%E8%BF%99%E6%98%AF%E4%BB%80%E4%B9%88%E5%8A%A0%E5%AF%86%E4%B9%88" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#0x5-afctf2018%E4%BD%A0%E8%83%BD%E7%9C%8B%E5%87%BA%E8%BF%99%E6%98%AF%E4%BB%80%E4%B9%88%E5%8A%A0%E5%AF%86%E4%B9%88" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>è„‘æ´é¢˜ï¼Œçœ‹çœ‹é¢˜ç›®æ¨æµ‹ä¸€ä¸‹è¿™æ˜¯ä»€ä¹ˆåŠ å¯†ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">p=0x928fb6aa9d813b6c3270131818a7c54edb18e3806942b88670106c1821e0326364194a8c49392849432b37632f0abe3f3c52e909b939c91c50e41a7b8cd00c67d6743b4f
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">q=0xec301417ccdffa679a8dcc4027dd0d75baf9d441625ed8930472165717f4732884c33f25d4ee6a6c9ae6c44aedad039b0b72cf42cab7f80d32b74061
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">e=0x10001
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">c=0x70c9133e1647e95c3cb99bd998a9028b5bf492929725a9e8e6d2e277fa0f37205580b196e5f121a2e83bc80a8204c99f5036a07c8cf6f96c420369b4161d2654a7eccbdaf583204b645e137b3bd15c5ce865298416fd5831cba0d947113ed5be5426b708b89451934d11f9aed9085b48b729449e461ff0863552149b965e22b6
</span></span></code></pre></div><p>å¥½å¸¸è§„çš„RSAé¢˜ç›®ï¼Œè¿™æ˜¯ç­¾åˆ°é¢˜ç›®å§</p>
<p>å†™ä¸ªè„šæœ¬è§£å†³ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">libnum</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">=</span><span class="mh">0x928fb6aa9d813b6c3270131818a7c54edb18e3806942b88670106c1821e0326364194a8c49392849432b37632f0abe3f3c52e909b939c91c50e41a7b8cd00c67d6743b4f</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">q</span><span class="o">=</span><span class="mh">0xec301417ccdffa679a8dcc4027dd0d75baf9d441625ed8930472165717f4732884c33f25d4ee6a6c9ae6c44aedad039b0b72cf42cab7f80d32b74061</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">e</span><span class="o">=</span><span class="mh">0x10001</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">c</span><span class="o">=</span><span class="mh">0x70c9133e1647e95c3cb99bd998a9028b5bf492929725a9e8e6d2e277fa0f37205580b196e5f121a2e83bc80a8204c99f5036a07c8cf6f96c420369b4161d2654a7eccbdaf583204b645e137b3bd15c5ce865298416fd5831cba0d947113ed5be5426b708b89451934d11f9aed9085b48b729449e461ff0863552149b965e22b6</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="n">p</span><span class="o">*</span><span class="n">q</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">d</span> <span class="o">=</span> <span class="n">libnum</span><span class="o">.</span><span class="n">invmod</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">phi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">m</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="n">libnum</span><span class="o">.</span><span class="n">n2s</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span> <span class="n">flag</span>
</span></span></code></pre></div><p>è¿è¡Œè„šæœ¬ï¼Œæ‹¿åˆ°flagï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">afctf{R54_|5_$0_$imp13}
</span></span></code></pre></div>

<h2 class="relative group">0x6 [ACTFæ–°ç”Ÿèµ›2020]crypto-rsa3 
    <div id="0x6-actf%E6%96%B0%E7%94%9F%E8%B5%9B2020crypto-rsa3" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#0x6-actf%E6%96%B0%E7%94%9F%E8%B5%9B2020crypto-rsa3" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>RSAç®—æ³•çš„é¢˜ç›®ï¼Œæœ‰ç‚¹æ„æ€å“¦ï¼(*^_^*)</p>
<p>ç…ä¸€ç…é¢˜ç›®é™„ä»¶ï¼š</p>
<p>æœ‰ä¸¤ä¸ªé™„ä»¶ï¼Œæ¯”è¾ƒå¸¸è§„çš„å½¢å¼ï¼Œä¸€ä¸ªæ˜¯<code>output.txt</code>çš„è¾“å‡ºæ–‡ä»¶ï¼Œä¸€ä¸ª<code>rsa3.py</code>çš„ç®—æ³•æ–‡ä»¶</p>
<p>rsa3.pyï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">flag</span> <span class="kn">import</span> <span class="n">FLAG</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Cryptodome.Util.number</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">gmpy2</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">random</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">e</span><span class="o">=</span><span class="mi">65537</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">q</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">gmpy2</span><span class="o">.</span><span class="n">next_prime</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="n">p</span><span class="o">*</span><span class="n">q</span>
</span></span><span class="line"><span class="cl"><span class="n">m</span> <span class="o">=</span> <span class="n">bytes_to_long</span><span class="p">(</span><span class="n">FLAG</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span></span></code></pre></div><p>output.txtï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">177606504836499246970959030226871608885969321778211051080524634084516973331441644993898029573612290095853069264036530459253652875586267946877831055147546910227100566496658148381834683037366134553848011903251252726474047661274223137727688689535823533046778793131902143444408735610821167838717488859902242863683
</span></span><span class="line"><span class="cl">1457390378511382354771000540945361168984775052693073641682375071407490851289703070905749525830483035988737117653971428424612332020925926617395558868160380601912498299922825914229510166957910451841730028919883807634489834128830801407228447221775264711349928156290102782374379406719292116047581560530382210049
</span></span></code></pre></div><p>éå¸¸å¸¸è§„çš„RSAé¢˜ç›®ï¼Œç»™å‡ºäº†nï¼Œcï¼Œeã€‚åŠ å¯†ç®—æ³•ä¹Ÿæ¯”è¾ƒå¸¸è§„ï¼Œå…¶ä¸­på’Œqçš„æ•°å€¼æ¯”è¾ƒæ¥è¿‘ï¼Œå¯ä»¥ç›´æ¥å¯¹nå¼€æ–¹æ¥å¾—åˆ°på’Œqçš„æ•°å€¼ã€‚æ ¹æ®è¿™ä¸€æ€è·¯ï¼Œå†™ä¸ªè„šæœ¬æ±‚è§£ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">libnum</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sympy</span>
</span></span><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="mi">177606504836499246970959030226871608885969321778211051080524634084516973331441644993898029573612290095853069264036530459253652875586267946877831055147546910227100566496658148381834683037366134553848011903251252726474047661274223137727688689535823533046778793131902143444408735610821167838717488859902242863683</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="mi">1457390378511382354771000540945361168984775052693073641682375071407490851289703070905749525830483035988737117653971428424612332020925926617395558868160380601912498299922825914229510166957910451841730028919883807634489834128830801407228447221775264711349928156290102782374379406719292116047581560530382210049</span>
</span></span><span class="line"><span class="cl"><span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">base</span> <span class="o">=</span> <span class="n">libnum</span><span class="o">.</span><span class="n">nroot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">prevprime</span><span class="p">(</span><span class="n">base</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">q</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">nextprime</span><span class="p">(</span><span class="n">base</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">assert</span><span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="n">q</span> <span class="o">==</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">d</span> <span class="o">=</span> <span class="n">libnum</span><span class="o">.</span><span class="n">invmod</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">phi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">m</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="n">libnum</span><span class="o">.</span><span class="n">n2s</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span> <span class="n">flag</span>
</span></span></code></pre></div><p>è¿è¡Œè„šæœ¬ï¼Œå¾—åˆ°flagï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">actf{p_and_q_should_not_be_so_close_in_value}
</span></span></code></pre></div>

<h2 class="relative group">0x7 é¸¡è—•æ¤’ç›å‘³ 
    <div id="0x7-%E9%B8%A1%E8%97%95%E6%A4%92%E7%9B%90%E5%91%B3" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#0x7-%E9%B8%A1%E8%97%95%E6%A4%92%E7%9B%90%E5%91%B3" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>é¢˜ç›®æ¯”è¾ƒå¥‡æ€ªï¼Œé‚£çœ‹çœ‹é¢˜ç›®ç©¶ç«Ÿä»€ä¹ˆæ ·çš„é¢˜ç›®å§ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">å…¬å¸é£Ÿå ‚æœ€æ–°å‡ºäº†ä¸€ç§å°åƒï¼Œå«é¸¡è—•æ¤’ç›å‘³æ±‰å ¡ï¼Œå”®ä»·å…«å—é’±ï¼Œä¸ºäº†ä¿ƒé”€ï¼Œä¸Šé¢æœ‰ä¸€ä¸ªéªŒè¯ç ï¼Œè¾“å…¥åå¯ä»¥å†æ¢å–ä¸€ä¸ªæ±‰å ¡ã€‚ä½†æ˜¯é—®é¢˜æ˜¯æ¯ä¸ªéªŒè¯ç å‡ ä¹éƒ½æœ‰é”™è¯¯,è€Œä¸”æ‰“å°çš„æ—¶å€™å€’äº†ä¸€ä¸‹ã€‚å°æ˜ä¹°åˆ°äº†ä¸€ä¸ªæ±‰å ¡ï¼Œå‡†å¤‡è¿˜åŸéªŒè¯ç ï¼Œå› ä¸ºä¸€ä¸ªåƒä¸é¥±å•ŠéªŒè¯ç å¦‚ä¸‹ï¼š1100 1010 0000 ,è€Œä¸”æ‰“å°çš„æ—¶å€™å€’äº†ä¸€ä¸‹ã€‚æŠŠç­”æ¡ˆå“ˆå¸Œä¸€ä¸‹å°±å¯ä»¥æäº¤äº†ã€‚(ç­”æ¡ˆä¸ºæ­£ç¡®å€¼(ä¸åŒ…æ‹¬æ•°å­—ä¹‹é—´çš„ç©ºæ ¼)çš„32ä½md5å€¼çš„å°å†™å½¢å¼) æ³¨æ„ï¼šå¾—åˆ°çš„ flag è¯·åŒ…ä¸Š flag{} æäº¤
</span></span></code></pre></div><p>å¯ä»¥ä»é¢˜ç›®ä¸­æç‚¼å‡ºä¸€äº›å…³é”®ä¿¡æ¯ï¼š</p>
<ol>
<li>éªŒè¯ç ï¼š1100 1010 0000</li>
<li>æ‰“å°çš„æ—¶å€™å€’äº†ä¸€ä¸‹</li>
<li>å“ˆå¸Œæäº¤ã€‚(ç­”æ¡ˆä¸ºæ­£ç¡®å€¼(ä¸åŒ…æ‹¬æ•°å­—ä¹‹é—´çš„ç©ºæ ¼)çš„32ä½md5å€¼çš„å°å†™å½¢å¼)</li>
<li>è€Œä¸”æ‰“å°çš„æ—¶å€™å€’äº†ä¸€ä¸‹</li>
</ol>
<p>è¿™äº›ä¿¡æ¯å’‹çœ‹ä¸å‡ºæ¥ä»€ä¹ˆä¸œè¥¿å‘€ï¼Œå˜¤å˜¤å˜¤~</p>
<p>ä»”ç»†çœ‹çœ‹é¢˜ç›®ï¼Œé¸¡è—•æ¤’ç›å‘³æ˜¯ä¸æ˜¯å¾ˆåƒæ˜¯å¥‡å¶æ ¡éªŒä½ï¼Œåº”è¯¥æ˜¯è¿™ä¸ªã€‚å¯ä»¥æ²¿ç€å¥‡å¶æ ¡éªŒä½çš„è¿™ä¸ªæ–¹å‘æ²¿ç€æ–¹å‘èµ°ä¸€ä¸‹ï¼Œçœ‹çœ‹èƒ½å¦æ‰¾åˆ°çªç ´çš„å…¥å£ã€‚æ²¿ç€å¥‡å¶æ ¡éªŒä½è¿›è¡Œæ¢ç´¢ï¼Œå‘ç°æœ‰ä¸ªæµ·æ˜æ ¡éªŒç çš„ä¸œè¥¿ï¼Œè€Œä¸”è¿˜æœ‰ä¸€ä¸ªæµ·æ˜çº é”™ç ã€‚è¿™é“é¢˜ç›®ï¼Œåº”è¯¥æ˜¯ä½¿ç”¨æµ·æ˜çº é”™ç æ¥è¿›è¡Œçº é”™çš„ï¼Œé‚£ä¹ˆä»€ä¹ˆæ˜¯æµ·æ˜ç å‘¢ï¼Ÿå¯ä»¥çœ‹çœ‹è¿™ç¯‡<a href="https://zhuanlan.zhihu.com/p/278326197#:~:text=%E6%B5%B7%E6%98%8E%E7%A0%81%E5%88%A9%E7%94%A8%E7%9B%91%E7%9D%A3%E5%85%AC%E5%BC%8F%E5%AF%B9%E6%95%B0%E6%8D%AE%E8%BF%9B%E8%A1%8C%E4%BA%A4%E5%8F%89%E6%A0%A1%E9%AA%8C%EF%BC%8C%E5%88%A9%E7%94%A8%E7%9B%91%E7%9D%A3%E5%85%AC%E5%BC%8F%E7%9A%84%E7%89%B9%E6%80%A7%E5%8F%AF%E4%BB%A5%E7%9B%B4%E6%8E%A5%E5%AE%9A%E4%BD%8D%E5%87%BA%E9%94%99%E6%95%B0%E6%8D%AE%E7%9A%84%E4%BD%8D%E7%BD%AE%E3%80%82.%20%E5%9B%A0%E4%B8%BA%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%95%B0%E6%8D%AE%E4%B8%AD%E6%95%B0%E6%8D%AE%E7%9A%84%E5%8F%96%E5%80%BC%E5%8F%AA%E6%9C%89%E4%B8%A4%E7%A7%8D%E7%8A%B6%E6%80%810%E5%92%8C1%EF%BC%8C%E5%9B%A0%E6%AD%A4%E5%8F%AA%E8%A6%81%E7%9F%A5%E9%81%93%E5%87%BA%E9%94%99%E7%9A%84%E4%BD%8D%E7%BD%AE%EF%BC%8C%E4%BF%AE%E6%94%B9%E5%B0%B1%E5%8F%98%E5%BE%97%E9%9D%9E%E5%B8%B8%E7%9A%84%E5%AE%B9%E6%98%93%EF%BC%8C%E5%8F%AA%E8%A6%81%E5%AF%B9%E5%87%BA%E9%94%99%E4%BD%8D%E7%BD%AE%E7%9A%84%E6%95%B0%E6%8D%AE%E5%8F%96%E5%8F%8D%E5%B0%B1%E5%8F%AF%E4%BB%A5%E8%BE%BE%E5%88%B0%E7%BA%A0%E6%AD%A3%E7%9A%84%E7%9B%AE%E7%9A%84%E3%80%82.%20%E4%BE%8B%E5%A6%82%E6%8E%A5%E6%94%B6%E7%AB%AF%E6%94%B6%E4%BA%86%E4%B8%80%E4%B8%B2%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%95%B0%E6%8D%AE101011%EF%BC%8C%E7%BB%8F%E8%BF%87%E6%B5%B7%E6%98%8E%E7%A0%81%E8%AE%A1%E7%AE%97%E5%90%8E%E5%BE%97%E5%88%B0%E7%9A%84%E6%95%B0%E5%AD%97%E6%98%AF3%EF%BC%8C%E8%AF%B4%E6%98%8E%E6%95%B0%E6%8D%AE%E4%B8%AD%E7%9A%84%E7%AC%AC3%E4%BD%8D%E7%9A%84%E6%95%B0%E6%8D%AE%E5%87%BA%E7%8E%B0%E4%BA%86%E9%94%99%E8%AF%AF%EF%BC%8C%E7%BA%A0%E6%AD%A3%E6%97%B6%E5%8F%AA%E9%9C%80%E8%A6%81%E6%8A%8A%E7%AC%AC%E4%B8%89%E4%BD%8D%E7%9A%841%E5%8F%96%E5%8F%8D%E5%8F%98%E6%88%900%E5%8D%B3%E5%8F%AF%EF%BC%8C%E7%BA%A0%E6%AD%A3%E5%90%8E%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%B8%B2%E6%98%AF100011%E3%80%82.,%E5%85%AC%E5%BC%8F%20%281%29%E4%B8%AD%E6%B5%B7%E6%98%8E%E7%A0%81%E8%99%BD%E7%84%B6%E5%8F%AF%E4%BB%A5%E5%AE%9E%E7%8E%B0%E6%95%B0%E6%8D%AE%E7%9A%84%E7%BA%A0%E9%94%99%EF%BC%8C%E4%BD%86%E6%98%AF%E5%8F%AA%E8%83%BD%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E6%AF%94%E7%89%B9%E6%95%B0%E6%8D%AE%E7%9A%84%E7%BA%A0%E9%94%99%E3%80%82.%20%E5%A6%82%E6%9E%9C%E6%95%B0%E6%8D%AE%E4%B8%AD%E6%9C%89%E5%A4%9A%E4%B8%AA%E6%AF%94%E7%89%B9%E5%90%8C%E6%97%B6%E5%87%BA%E7%8E%B0%E9%94%99%E8%AF%AF%EF%BC%8C%E5%B0%B1%E5%BF%85%E9%A1%BB%E4%BD%BF%E7%94%A8%E6%9B%B4%E5%8A%A0%E5%A4%8D%E6%9D%82%E7%9A%84%E6%B5%B7%E6%98%8E%E5%85%AC%E5%BC%8F%E3%80%82." target="_blank">çŸ¥ä¹æ–‡ç« </a>å¤§è‡´åŸç†éƒ½æœ‰äº†ï¼Œæ ¹æ®è¿™ç¯‡æ–‡ç« é˜è¿°çš„åŸç†è¿›è¡Œè„šæœ¬ç¼–å†™ï¼Œåº”è¯¥å°±å¯ä»¥æ‰¾å‡ºç­”æ¡ˆäº†ã€‚å†™ä¸‹è„šæœ¬ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">hashlib</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="s2">&#34;110010100000&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">c_r</span> <span class="o">=</span> <span class="n">c</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">c_list</span> <span class="o">=</span><span class="p">[]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">c_r</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">c_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">h1</span> <span class="o">=</span> <span class="n">c_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">^</span><span class="n">c_list</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">^</span><span class="n">c_list</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">^</span><span class="n">c_list</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">^</span><span class="n">c_list</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">^</span> <span class="n">c_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">h2</span> <span class="o">=</span> <span class="n">c_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">^</span><span class="n">c_list</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">^</span><span class="n">c_list</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">^</span><span class="n">c_list</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">^</span><span class="n">c_list</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">^</span> <span class="n">c_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">h3</span> <span class="o">=</span> <span class="n">c_list</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">^</span><span class="n">c_list</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">^</span><span class="n">c_list</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">^</span><span class="n">c_list</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">^</span> <span class="n">c_list</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">h4</span> <span class="o">=</span> <span class="n">c_list</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">^</span><span class="n">c_list</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">^</span><span class="n">c_list</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">^</span><span class="n">c_list</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">^</span> <span class="n">c_list</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">mistake_bit</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">h4</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">h3</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">h2</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">h1</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">c_list</span><span class="p">[</span><span class="n">mistake_bit</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">c_list</span><span class="p">[</span><span class="n">mistake_bit</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">c_list</span><span class="p">[</span><span class="n">mistake_bit</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">m</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">c_list</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">m</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">m</span> <span class="o">=</span> <span class="n">m</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span> <span class="n">flag</span>
</span></span></code></pre></div><p>è¿è¡Œä¸€ä¸‹è„šæœ¬ï¼Œflagå°±æœ‰äº†ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">d14084c7ceca6359eaac6df3c234dd3b
</span></span></code></pre></div>

<h2 class="relative group">0x8 [ACTFæ–°ç”Ÿèµ›2020]crypto-classic0 
    <div id="0x8-actf%E6%96%B0%E7%94%9F%E8%B5%9B2020crypto-classic0" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#0x8-actf%E6%96%B0%E7%94%9F%E8%B5%9B2020crypto-classic0" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>çœ‹é¢˜ç›®å°±çŸ¥é“ï¼Œè¿™ä¸ªæ˜¯å¤å…¸å¯†ç å­¦çš„é¢˜ç›®ï¼Œçœ‹çœ‹ç©¶ç«Ÿæ˜¯åœ¨è€ƒå¯Ÿäº›ä»€ä¹ˆå¤å…¸å¯†ç å§ï¼š</p>
<p>é™„ä»¶æ–‡ä»¶é‡Œé¢æœ‰ä¸‰ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ª<code>cipher</code>æ–‡æœ¬æ–‡ä»¶ï¼Œä¸€ä¸ª<code>hint.txt</code>æç¤ºæ–‡ä»¶å’Œä¸€ä¸ª<code>howtoencrypt.zip</code>åŠ å¯†å‹ç¼©æ–‡ä»¶ã€‚</p>
<p>hint.txt:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">å“¼ï¼Œå‹ç¼©åŒ…çš„å¯†ç ï¼Ÿè¿™æ˜¯å°Zç«¥é‹çš„ç”Ÿæ—¥å§==
</span></span></code></pre></div><p>åº”è¯¥æ˜¯å‹ç¼©åŒ…æ–‡ä»¶çš„æç¤ºå†…å®¹</p>
<p>å¦ä¸€ä¸ªcipheræ–‡ä»¶éœ€è¦è¿›è¡Œæ¢æµ‹ä¸€ä¸‹ï¼Œä½¿ç”¨<code>file</code>å‘½ä»¤ç®€å•æ¢æµ‹ä¸€ä¸‹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">cipher: International EBCDIC text, with no line terminators
</span></span></code></pre></div><p>æ˜¯ä¸€ä¸ªçº¯æ–‡æœ¬æ–‡ä»¶ï¼Œè¿™æ ·å¯ä»¥ä½¿ç”¨è®°äº‹æœ¬ç›´æ¥æ‰“å¼€ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">Ygvdmq[lYate[elghqvakl}
</span></span></code></pre></div><p>è¿™ä¸ªæç¤ºåº”è¯¥å‘Šè¯‰å‹ç¼©æ–‡ä»¶çš„å¯†ç é•¿åº¦ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨å‹ç¼©çˆ†ç ´å·¥å…·è¿›è¡Œçˆ†ç ´ï¼Œç»è¿‡çˆ†ç ´å¯ä»¥å¾—åˆ°å¯†ç æ˜¯<code>19990306</code>ã€‚ä½¿ç”¨å¯†ç è¿›è¡Œè§£å‹å¾—åˆ°ä¸€ä¸ªcè¯­è¨€æºç¨‹åºï¼Œåº”è¯¥æ˜¯åŠ å¯†ç®—æ³•ã€‚</p>
<p>classic0.cï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span><span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">char</span> <span class="n">flag</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span> <span class="o">=</span> <span class="o">***</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">25</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^=</span> <span class="mh">0x7</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%c&#34;</span><span class="p">,</span><span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>æ ¹æ®è¿™ä¸ªcç¨‹åºç®—æ³•è®¾è®¡ä¸€ä¸ªé€†ç®—æ³•åº”è¯¥å°±å¯ä»¥è¿›è¡Œæ±‚è§£ï¼Œè¿™é‡Œå†™ä¸ªcè¯­è¨€é€†ç®—æ³•ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">flag</span><span class="p">[</span><span class="mi">25</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">FILE</span> <span class="o">*</span><span class="n">fp</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">fp</span> <span class="o">=</span> <span class="nf">fopen</span><span class="p">(</span><span class="s">&#34;cipher.txt&#34;</span><span class="p">,</span><span class="s">&#34;r&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">fgets</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="n">fp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">25</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^=</span> <span class="mh">0x7</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%c&#34;</span><span class="p">,</span> <span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nf">fclose</span><span class="p">(</span><span class="n">fp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>ç¼–è¯‘å¹¶æ‰§è¡Œå¾—åˆ°flagï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">actf{my_naive_encrytion}
</span></span></code></pre></div>

<h2 class="relative group">0x9 [RoarCTF2019]babyRSA 
    <div id="0x9-roarctf2019babyrsa" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#0x9-roarctf2019babyrsa" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>RSAé¢˜ç›®ï¼Œçœ‹çœ‹è¿™æ¬¡åˆæœ‰ä»€ä¹ˆæ ·çš„æƒŠå–œï¼</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sympy</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">random</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">myGetPrime</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">A</span><span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">513</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">B</span><span class="o">=</span><span class="n">A</span><span class="o">-</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">1e3</span><span class="p">,</span><span class="mf">1e5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">sympy</span><span class="o">.</span><span class="n">nextPrime</span><span class="p">((</span><span class="n">B</span><span class="err">!</span><span class="p">)</span><span class="o">%</span><span class="n">A</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">=</span><span class="n">myGetPrime</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">#A1=21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467234407</span>
</span></span><span class="line"><span class="cl"><span class="c1">#B1=21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467140596</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">q</span><span class="o">=</span><span class="n">myGetPrime</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">#A2=16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858418927</span>
</span></span><span class="line"><span class="cl"><span class="c1">#B2=16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858351026</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">=</span><span class="n">myGetPrime</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">n</span><span class="o">=</span><span class="n">p</span><span class="o">*</span><span class="n">q</span><span class="o">*</span><span class="n">r</span>
</span></span><span class="line"><span class="cl"><span class="c1">#n=85492663786275292159831603391083876175149354309327673008716627650718160585639723100793347534649628330416631255660901307533909900431413447524262332232659153047067908693481947121069070451562822417357656432171870951184673132554213690123308042697361969986360375060954702920656364144154145812838558365334172935931441424096270206140691814662318562696925767991937369782627908408239087358033165410020690152067715711112732252038588432896758405898709010342467882264362733</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span><span class="o">=</span><span class="nb">pow</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#e=0x1001</span>
</span></span><span class="line"><span class="cl"><span class="c1">#c=75700883021669577739329316795450706204502635802310731477156998834710820770245219468703245302009998932067080383977560299708060476222089630209972629755965140317526034680452483360917378812244365884527186056341888615564335560765053550155758362271622330017433403027261127561225585912484777829588501213961110690451987625502701331485141639684356427316905122995759825241133872734362716041819819948645662803292418802204430874521342108413623635150475963121220095236776428</span>
</span></span><span class="line"><span class="cl"><span class="c1">#so,what is the flag?</span>
</span></span></code></pre></div><p>ä»£ç æŒºé•¿çš„ï¼Œè€ƒå¯Ÿçš„å†…å®¹æ˜¯é˜¶ä¹˜ï¼Ÿæ˜¯ä¸æ˜¯è¦è€ƒè™‘ä¸€ä¸‹é€’å½’çš„æ–¹å¼è¿›è¡Œæ±‚è§£ï¼Ÿé‚£ä¼°è®¡æ…¢çš„ä¸å¾—äº†ï¼Œè‚¯å®šæœ‰æ›´å¥½çš„ç®—æ³•è¿›è¡Œæ±‚è§£ï¼Œåƒåœ¾çš„æˆ‘å»ç¿»ç¿»äº†ç‹å°äº‘é™¢å£«å†™çš„æ•°å­¦ä¹¦ï¼Œå‘ç°æœ‰ä¸ªå«å¨å°”é€Šå®šç†çš„ä¸œè¥¿å¯ä»¥ç”¨äºç®—æ³•çš„æ±‚è§£ï¼Œè¿™é“é¢˜ç›®å°±æ˜¯è€ƒå¯Ÿå¨å°”é€Šå®šç†çš„å†…å®¹ã€‚</p>
<p>å¨å°”é€Šå®šç†çš„å†…å®¹å¾ˆç®€å•ï¼š
$$
(p-1)! \equiv -1 (\text{mod} p)
$$
å…¶ä¸­pä¸ºç´ æ•°</p>
<p>æ ¹æ®å¨å°”é€Šå®šç†å°±å¯ä»¥å¯¹è¿™é“é¢˜ç›®è¿›è¡Œç®€å•çš„æ¨å¯¼æ±‚è§£ï¼š</p>
<p>é¦–å…ˆï¼Œäº†è§£ä¸€ä¸‹ç®—æ³•çš„åŠ å¯†è¿‡ç¨‹ï¼š
$$
p \equiv B_1! \text{mod}A_1
$$</p>
<p>$$
q\equiv B_2! \text{mod}A_2
$$</p>
<p>$$
r \equiv B_3! \text{mod}A_3
$$</p>
<p>$$
n = p \cdot q \cdot r
$$</p>
<p>$$
c \equiv m ^e \text{mod} n
$$</p>
<p>åŠ å¯†è¿‡ç¨‹ä¹Ÿæ˜¯éå¸¸æ¸…æ™°ï¼Œé—®é¢˜æ˜¯å¦‚ä½•æ›´å¿«åœ°è®¡ç®—å‡ºpå’Œqçš„æ•°å€¼ï¼Œè¿™é‡Œå°±éœ€è¦ç”¨åˆ°å¨å°”é€Šå®šç†æ¥è¿›è¡Œç›¸åº”çš„è®¡ç®—ï¼š</p>
<p>æ ¹æ®ä»£ç ä¸­çš„ç®—æ³•ï¼Œå¯ä»¥çœ‹å‡ºæœ‰ä¸€å¥ä»£ç è¡¨æ˜ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">B</span><span class="o">=</span><span class="n">A</span><span class="o">-</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">1e3</span><span class="p">,</span><span class="mf">1e5</span><span class="p">)</span>
</span></span></code></pre></div><p>å› æ­¤ï¼Œè¿™é‡Œå¯ä»¥æ ¹æ®è¿™ä¸€ä¿¡æ¯ä½¿ç”¨å¨å°”é€Šå®šç†è¿›è¡Œæ¨å¯¼ï¼š
$$
(A-1)! \equiv -1\text{mod}A
$$</p>
<p>$$
(A-1)\cdot(A-2)\cdot(A-3)\dots(B+1)\cdot(B)\dots2\cdot1\equiv-1\text{mod} A
$$</p>
<p>$$
(A-1)\cdot(A-2)\cdot(A-3)\dots(B+1)\cdot(B!)\equiv-1\text{mod} A
$$</p>
<p>$$
(A-1)\cdot(A-2)\cdot(A-3)\dots(B+1)\cdot(B!)\equiv(A-1)\text{mod} A
$$</p>
<p>$$
(A-2)\cdot(A-3)\dots(B+1)\cdot(B!)\equiv1\text{mod} A
$$</p>
<p>å› æ­¤è¦æ±‚<code>(B!)%A</code>å¯ä»¥é€šè¿‡æ±‚$(A-2)\cdot(A-1)\dots(B+1)$çš„é€†å…ƒæ¥è¿›è¡Œä¼˜åŒ–æ±‚è§£ï¼Œæé«˜è¿ç®—çš„æ•ˆç‡ï¼Œè¿™æ ·åˆ†æå®Œï¼Œè¿™é“é¢˜ç›®çš„å¤§è‡´æ€è·¯ä¹Ÿå°±æœ‰äº†ã€‚æ ¹æ®è¿™ä¸ªæ€è·¯ï¼Œå†™ä¸ªè„šæœ¬æ±‚è§£å°±å¥½ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">libnum</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sympy</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">wilson</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">tmp</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">B</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">A</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">tmp</span> <span class="o">*=</span> <span class="n">i</span>
</span></span><span class="line"><span class="cl">        <span class="n">tmp</span> <span class="o">%=</span> <span class="n">A</span>
</span></span><span class="line"><span class="cl">    <span class="n">tmp_inv</span> <span class="o">=</span> <span class="n">libnum</span><span class="o">.</span><span class="n">invmod</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">nextprime</span><span class="p">(</span><span class="n">tmp_inv</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">result</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">A1</span><span class="o">=</span><span class="mi">21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467234407</span>
</span></span><span class="line"><span class="cl"><span class="n">B1</span><span class="o">=</span><span class="mi">21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467140596</span>
</span></span><span class="line"><span class="cl"><span class="n">A2</span><span class="o">=</span><span class="mi">16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858418927</span>
</span></span><span class="line"><span class="cl"><span class="n">B2</span><span class="o">=</span><span class="mi">16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858351026</span>
</span></span><span class="line"><span class="cl"><span class="n">n</span><span class="o">=</span><span class="mi">85492663786275292159831603391083876175149354309327673008716627650718160585639723100793347534649628330416631255660901307533909900431413447524262332232659153047067908693481947121069070451562822417357656432171870951184673132554213690123308042697361969986360375060954702920656364144154145812838558365334172935931441424096270206140691814662318562696925767991937369782627908408239087358033165410020690152067715711112732252038588432896758405898709010342467882264362733</span>
</span></span><span class="line"><span class="cl"><span class="n">e</span><span class="o">=</span><span class="mh">0x1001</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span><span class="o">=</span><span class="mi">75700883021669577739329316795450706204502635802310731477156998834710820770245219468703245302009998932067080383977560299708060476222089630209972629755965140317526034680452483360917378812244365884527186056341888615564335560765053550155758362271622330017433403027261127561225585912484777829588501213961110690451987625502701331485141639684356427316905122995759825241133872734362716041819819948645662803292418802204430874521342108413623635150475963121220095236776428</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="n">wilson</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="n">B1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">q</span> <span class="o">=</span> <span class="n">wilson</span><span class="p">(</span><span class="n">A2</span><span class="p">,</span> <span class="n">B2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">n</span> <span class="o">//</span><span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="n">q</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">d</span> <span class="o">=</span> <span class="n">libnum</span><span class="o">.</span><span class="n">invmod</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">phi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">m</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="n">libnum</span><span class="o">.</span><span class="n">n2s</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span> <span class="n">flag</span>
</span></span></code></pre></div><p>è¿è¡Œè„šæœ¬ï¼Œæ‹¿åˆ°flag</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">RoarCTF{wm-CongrAtu1ation4-1t4-ju4t-A-bAby-R4A}
</span></span></code></pre></div><p>è¿™é“é¢˜ç›®è¿˜æ˜¯æŒºæœ‰æ„æ€çš„ï¼Œè€ƒçš„å†…å®¹æ¯”è¾ƒç»¼åˆï¼Œæ˜¯ä¸€é“ä¸é”™çš„RSAé¢˜ç›®ã€‚</p>


<h2 class="relative group">0xA [AFCTF2018]å¯æ€œçš„RSA 
    <div id="0xa-afctf2018%E5%8F%AF%E6%80%9C%E7%9A%84rsa" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#0xa-afctf2018%E5%8F%AF%E6%80%9C%E7%9A%84rsa" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>è¿™æ¬¡åˆæœ‰ä»€ä¹ˆèŠ±æ ·å‘¢ï¼Ÿå¯æ€œçš„RSA</p>
<p>ç§ç§é¢˜ç›®ï¼š</p>
<p>é™„ä»¶é‡Œé¢æœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ª<code>flag.enc</code>çš„å¯†æ–‡æ–‡ä»¶å’Œä¸€ä¸ª<code>public.enc</code>çš„å…¬é’¥æ–‡ä»¶</p>
<p>è¿™é“é¢˜ç›®çš„æ€è·¯åº”è¯¥æ˜¯è¯»å–å…¬é’¥æ–‡ä»¶ï¼Œç„¶åå¯¹å…¬é’¥æ–‡ä»¶ä¸­çš„modulusè¿›è¡Œå¤§æ•°åˆ†è§£ï¼Œæœ€åä½¿ç”¨å®é™…åº”ç”¨çš„ä¼šç”¨åˆ°çš„å¡«å……æ–¹æ³•è¿›è¡Œè§£å¯†ã€‚</p>
<p>æ€è·¯å¾ˆç®€å•ï¼Œæ ¹æ®æ€è·¯å†™ä¸ªè„šæœ¬ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.PublicKey</span> <span class="kn">import</span> <span class="n">RSA</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">PKCS1_OAEP</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">base64</span> <span class="kn">import</span> <span class="n">b64decode</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sympy.ntheory.factor_</span> <span class="kn">import</span> <span class="n">smoothness</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sympy</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">libnum</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;public.key&#34;</span><span class="p">,</span><span class="s2">&#34;rb&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">rsakey</span> <span class="o">=</span> <span class="n">RSA</span><span class="o">.</span><span class="n">importKey</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="n">n</span> <span class="o">=</span> <span class="n">rsakey</span><span class="o">.</span><span class="n">n</span>
</span></span><span class="line"><span class="cl">    <span class="n">e</span> <span class="o">=</span> <span class="n">rsakey</span><span class="o">.</span><span class="n">e</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">factorint</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="n">long</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">q</span> <span class="o">=</span> <span class="n">long</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">d</span> <span class="o">=</span> <span class="n">libnum</span><span class="o">.</span><span class="n">invmod</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">phi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">key_info</span> <span class="o">=</span> <span class="n">RSA</span><span class="o">.</span><span class="n">construct</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">key</span> <span class="o">=</span> <span class="n">RSA</span><span class="o">.</span><span class="n">importKey</span><span class="p">(</span><span class="n">key_info</span><span class="o">.</span><span class="n">exportKey</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="n">key</span> <span class="o">=</span> <span class="n">PKCS1_OAEP</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;flag.enc&#34;</span><span class="p">,</span><span class="s2">&#34;rb&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">c</span> <span class="o">=</span> <span class="n">b64decode</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span> <span class="n">flag</span>
</span></span></code></pre></div><p>è¿è¡Œè„šæœ¬ï¼Œå¾—åˆ°flagï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">afctf{R54_|5_$0_B0rin9}
</span></span></code></pre></div><p>è¿™é“é¢˜ç›®æ¯”è¾ƒåå‘äºåº”ç”¨æ–¹é¢ï¼Œæ¶‰åŠåˆ°äº†RSAçš„åŠ å¯†ç®—æ³•å¡«å……æ–¹æ³•ï¼Œä¸å†æ˜¯è£¸éœ²å†å¤–é¢çš„RSAç®—æ³•ã€‚å¯ä»¥è¿›ä¸€æ­¥äº†è§£ä¸€ä¸‹ã€‚</p>


<h2 class="relative group">0xB æ•‘ä¸»æ·å¾„ 
    <div id="0xb-%E6%95%91%E4%B8%BB%E6%8D%B7%E5%BE%84" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#0xb-%E6%95%91%E4%B8%BB%E6%8D%B7%E5%BE%84" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>æ•‘ä¸»æ·å¾„ï¼Œåº”è¯¥æ˜¯ä¸€ä¸ªè„‘æ´é¢˜ç›®ï¼Œçœ‹çœ‹é¢˜ç›®ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">ä¸€ä¸ªåå«CPUçš„ç¥ç§˜å¤§é™†æœ‰26ä¸ªå›½å®¶ï¼Œæœ‰äº›å›½å®¶ä¹‹é—´ä¼šæœ‰ä¸€æ¡æ— å‘è·¯ï¼Œæ¯æ¡è·¯å¾„éƒ½æœ‰ä¸åŒçš„é•¿åº¦å’Œä¸€æ®µç¥ç§˜ä»£ç ï¼Œæ•‘ä¸–ä¸»å°¼å¥¥è¦ä»å›½å®¶1å‡ºå‘ï¼Œèµ¶å¾€å›½å®¶26æ‹¯æ•‘å¤§é™†ï¼Œè¯·ä½ å¸®åŠ©æ•‘ä¸–ä¸»é€‰æ‹©æœ€çŸ­è·¯å¾„ï¼Œè€Œèµ°è¿‡çš„è·¯çš„ç¥ç§˜ä»£ç è¿æ¥èµ·æ¥ä¾¿æ˜¯flagã€‚ ä»¥ä¸‹æ˜¯æ•°è¡Œæ•°æ®ï¼Œæ¯è¡Œç¬¬ä¸€ä¸ªï¼Œç¬¬äºŒä¸ªæ•°å­—ä»£è¡¨è¿™æ¡è·¯çš„ä¸¤ä¸ªç«¯ç‚¹å›½å®¶ï¼Œç¬¬ä¸‰ä¸ªæ•°å­—ä»£è¡¨è·¯é€”é•¿åº¦ï¼Œæœ€åä¸€ä¸ªå­—ç¬¦ä¸²ä¾¿æ˜¯ç¥ç§˜ä»£ç ã€‚è·¯åœ¨é™„ä»¶ä¸­~ å¸®åŠ©æ•‘ä¸–ä¸»å°¼å¥¥å§ï¼Œä»–å¿«è¢«å“å°¿äº†ã€‚ã€‚ã€‚ æ³¨æ„ï¼šå¾—åˆ°çš„ flag è¯·åŒ…ä¸Š flag{} æäº¤
</span></span></code></pre></div><p>çœ‹æ ·å­åº”è¯¥æ˜¯å¹¿åº¦ä¼˜å…ˆç®—æ³•çš„åº”ç”¨ï¼Œé¢˜ç›®ä¸­åªè¯´åˆ°äº†è·ç¦»ï¼Œæ²¡æœ‰æ¶‰åŠæƒé‡ï¼Œåº”è¯¥å°±æ˜¯å¹¿åº¦ä¼˜å…ˆç®—æ³•ï¼Œçœ‹çœ‹é™„ä»¶æ˜¯ä»€ä¹ˆå§ï¼</p>
<pre tabindex="0"><code>1 2 100 FLAG{
2 3 87 AFQWE
2 4 57 ETKLS
2 5 50 WEIVK
2 6 51 AWEIW
3 7 94 QIECJF
3 8 78 QSXKE
3 9 85 QWEIH
4 13 54 WQOJF
4 14 47 KDNVE
4 15 98 QISNV
5 10 43 AEWJV
5 11 32 QWKXF
5 12 44 ASJVL
6 16 59 ASJXJ
6 17 92 QJXNV
6 18 39 SCJJF
6 23 99 SJVHF
7 19 99 WJCNF
8 20 96 SKCNG
9 20 86 SJXHF
10 21 60 SJJCH
11 21 57 SJHGG
12 22 47 SJCHF
14 10 55 EJFHG
16 17 59 ASJVH
18 12 53 SJFHG
18 24 93 SHFVG
21 22 33 SJFHB
19 25 88 ASHHF
20 25 96 SJVHG
22 25 23 SJVHJ
25 26 75 SDEV}
</code></pre><p>æ ¹æ®é™„ä»¶æ–‡ä»¶ç»˜åˆ¶ä¸ªå›¾ï¼Œä¹Ÿæ–¹ä¾¿è¿›è¡Œå¹¿åº¦ä¼˜å…ˆç®—æ³•çš„ä½¿ç”¨å’Œè®¡ç®—ï¼š</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="/images/BUUCTF-CRYPTO-5_writeup/image-20210630202812243.png" alt="image-20210630202812243" />
      
    </figure>
</p>
<p>æ ¹æ®å›¾ç¤ºæ¥ä½¿ç”¨å¹¿åº¦ä¼˜å…ˆç®—æ³•çš„è®¾è®¡ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨æ¯”è¾ƒç»å…¸çš„Dijkstraç®—æ³•æ¥æ±‚è§£æœ€ä¼˜é—®é¢˜ï¼Œä½¿ç”¨pythonè¿›è¡Œç®—æ³•å®ç°ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">Dijkstra</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">RG</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">reverse</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">dist</span> <span class="o">=</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl">    <span class="n">previous</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">RG</span><span class="o">.</span><span class="n">nodes</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">        <span class="n">dist</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">previous</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">dist</span><span class="p">[</span><span class="n">end</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">u</span> <span class="o">=</span> <span class="n">end</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">u</span> <span class="o">!=</span> <span class="n">start</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">u</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">dist</span><span class="o">.</span><span class="n">get</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">distu</span> <span class="o">=</span> <span class="n">dist</span><span class="p">[</span><span class="n">u</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="k">del</span> <span class="n">dist</span><span class="p">[</span><span class="n">u</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">RG</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">u</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">dist</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">alt</span> <span class="o">=</span> <span class="n">distu</span> <span class="o">+</span> <span class="n">RG</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">alt</span> <span class="o">&lt;</span> <span class="n">dist</span><span class="p">[</span><span class="n">v</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">dist</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">alt</span>
</span></span><span class="line"><span class="cl">                    <span class="n">previous</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span>
</span></span><span class="line"><span class="cl">    <span class="n">path</span> <span class="o">=</span> <span class="p">(</span><span class="n">start</span><span class="p">,)</span>
</span></span><span class="line"><span class="cl">    <span class="n">last</span> <span class="o">=</span> <span class="n">start</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">last</span> <span class="o">!=</span> <span class="n">end</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">nxt</span> <span class="o">=</span> <span class="n">previous</span><span class="p">[</span><span class="n">last</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">path</span> <span class="o">+=</span> <span class="p">(</span><span class="n">nxt</span><span class="p">,)</span>
</span></span><span class="line"><span class="cl">        <span class="n">last</span> <span class="o">=</span> <span class="n">nxt</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">path</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">datalist</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="n">datadict</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;data.txt&#34;</span><span class="p">,</span><span class="s2">&#34;rb&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\r\n</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">datalist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">datalist</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">datadict</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&#34;-&#34;</span><span class="o">+</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="n">weight</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl"><span class="n">rs</span> <span class="o">=</span> <span class="n">Dijkstra</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">26</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rs</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag</span> <span class="o">+=</span> <span class="n">datadict</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">rs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">+</span><span class="s2">&#34;-&#34;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">rs</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span> <span class="n">flag</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span> <span class="n">flag</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span></span></code></pre></div><p>è¿è¡Œè„šæœ¬ï¼Œå³å¯è·å¾—flagï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">FLAG{WEIVKASJVLSJCHFSJVHJSDEV}
</span></span><span class="line"><span class="cl">flag{weivkasjvlsjchfsjvhjsdev}
</span></span></code></pre></div>

<h2 class="relative group">0xC [ç½‘é¼æ¯ 2020 é’é¾™ç»„]boom 
    <div id="0xc-%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E9%9D%92%E9%BE%99%E7%BB%84boom" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#0xc-%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E9%9D%92%E9%BE%99%E7%BB%84boom" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>è¿™é“é¢˜ç›®ï¼Œboomçš„æ„æ€çˆ†ç‚¸ï¼Œè¿™é“é¢˜ç›®åº”è¯¥ä¼šæœ‰ç‚¹æ„æ€ã€‚</p>
<p>æ¥çœ‹çœ‹é¢˜ç›®å‘€ï¼š</p>
<p>çœ‹åˆ°é™„ä»¶å†…å®¹æ˜¯ä¸€ä¸ªexeæ–‡ä»¶ï¼Œå¯æ‰§è¡Œæ–‡ä»¶ï¼Œæœ‰ç‚¹åƒæ˜¯é€†å‘é¢˜ç›®ã€‚é¦–å…ˆæ‰§è¡Œä¸€ä¸‹exeç¨‹åºï¼Œçœ‹çœ‹ç¨‹åºä¼šç»™æˆ‘ä»¬å±•ç¤ºä»€ä¹ˆæ ·çš„æ•ˆæœï¼Ÿ</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="/images/BUUCTF-CRYPTO-5_writeup/image-20210630213025137.png" alt="image-20210630213025137" />
      
    </figure>
</p>
<p>æŒ‰ä¸€ä¸‹ä»»æ„é”®ï¼š</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="/images/BUUCTF-CRYPTO-5_writeup/image-20210630213049828.png" alt="image-20210630213049828" />
      
    </figure>
</p>
<p>åº”è¯¥æ˜¯ä¸€ä¸ªè¿›è¡Œç­”é¢˜çš„exeç¨‹åºï¼Œè¿™é‡Œæœ‰ä¸¤æ¡è·¯å¯ä»¥èµ°ï¼Œç¬¬ä¸€æ¡è·¯å°±æ˜¯é€šè¿‡ç­”é¢˜æ¥æ‹¿åˆ°flagï¼Œè€Œç¬¬äºŒæ¡è·¯å°±æ˜¯é€šè¿‡é€†å‘å·¥å…·è¿›è¡Œé€†å‘ã€‚ä¸‹é¢ç»˜åˆ¶ä¸€ä¸ªæ‹“æ‰‘å›¾æ¥çœ‹çœ‹è¿™é“é¢˜ç›®çš„æ€è·¯ï¼š</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="/images/BUUCTF-CRYPTO-5_writeup/image-20210630214244533.png" alt="image-20210630214244533" />
      
    </figure>
</p>
<p>æ— è®ºæ€ä¹ˆèµ°ï¼Œéƒ½éœ€è¦è§£å†³é¢˜ç›®çš„é—®é¢˜ï¼Œè¿™é“é¢˜ç›®çš„æœ¬æ„åº”è¯¥æ˜¯è€ƒå¯Ÿæ•°å­¦æŠ€èƒ½ï¼Œè¿™é“é¢˜ç›®å°±ä½¿ç”¨IDAé€†å‘å·¥å…·è¿›è¡Œåˆ†æï¼Œæ‰“å¼€IDAçœ‹åˆ°ä¼ªä»£ç ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">Str</span><span class="p">[</span><span class="mi">50</span><span class="p">];</span> <span class="c1">// [esp+24h] [ebp-128h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="n">v6</span><span class="p">[</span><span class="mi">50</span><span class="p">];</span> <span class="c1">// [esp+56h] [ebp-F6h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">_DWORD</span> <span class="n">v7</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span> <span class="c1">// [esp+88h] [ebp-C4h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">v8</span><span class="p">[</span><span class="mi">22</span><span class="p">];</span> <span class="c1">// [esp+C8h] [ebp-84h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">v9</span><span class="p">;</span> <span class="c1">// [esp+120h] [ebp-2Ch] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v10</span><span class="p">;</span> <span class="c1">// [esp+12Ch] [ebp-20h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v11</span><span class="p">;</span> <span class="c1">// [esp+130h] [ebp-1Ch] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v12</span><span class="p">;</span> <span class="c1">// [esp+134h] [ebp-18h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v13</span><span class="p">;</span> <span class="c1">// [esp+138h] [ebp-14h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [esp+13Ch] [ebp-10h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nf">__main</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="nf">menu</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="nf">system</span><span class="p">(</span><span class="s">&#34;pause&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">system</span><span class="p">(</span><span class="s">&#34;cls&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">70</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">229</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">239</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">230</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">22</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">90</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mi">90</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mi">251</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="mi">54</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="mi">18</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="mi">23</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="mi">68</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="mi">106</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="mi">45</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">=</span> <span class="mi">189</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;first:this string md5:46e5efe6165a5afb361217446a2dbd01&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scanf</span><span class="p">(</span><span class="s">&#34;%s&#34;</span><span class="p">,</span> <span class="n">Str</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">MD5Init</span><span class="p">(</span><span class="n">v8</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span> <span class="o">=</span> <span class="nf">strlen</span><span class="p">(</span><span class="n">Str</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">MD5Update</span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">v8</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span> <span class="n">v3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">MD5Final</span><span class="p">(</span><span class="n">v8</span><span class="p">,</span> <span class="n">v6</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v13</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">15</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">v6</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">v7</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">v13</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">v13</span> <span class="o">!=</span> <span class="mi">1</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Game over&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">system</span><span class="p">(</span><span class="s">&#34;pause&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Great next level&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">system</span><span class="p">(</span><span class="s">&#34;pause&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">system</span><span class="p">(</span><span class="s">&#34;cls&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;This time:Here are have some formulas&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;3x-y+z=185&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;2x+3y-z=321&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;x+y+z=173&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;input: x = &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scanf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v12</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;input: y = &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scanf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v11</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;input : z = &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scanf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">v12</span> <span class="o">-</span> <span class="n">v11</span> <span class="o">+</span> <span class="n">v10</span> <span class="o">!=</span> <span class="mi">185</span> <span class="o">||</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">v12</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">v11</span> <span class="o">-</span> <span class="n">v10</span> <span class="o">!=</span> <span class="mi">321</span> <span class="o">||</span> <span class="n">v11</span> <span class="o">+</span> <span class="n">v12</span> <span class="o">+</span> <span class="n">v10</span> <span class="o">!=</span> <span class="mi">173</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Game over&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Great last level coming...&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;pause&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">system</span><span class="p">(</span><span class="s">&#34;cls&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Last time: Kill it&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;x*x+x-7943722218936282=0&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;input x: &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scanf</span><span class="p">(</span><span class="s">&#34;%lld&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v9</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">v9</span> <span class="o">*</span> <span class="p">(</span><span class="n">v9</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="mh">0x1C38C5F50DD7DALL</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Game over&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Great This is your FLAG&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>å¯ä»¥ä»é€†å‘çš„ä¼ªä»£ç ä¸­æ‰¾åˆ°ä¸€äº›æ¯”è¾ƒå…³é”®çš„ä»£ç ï¼š</p>
<p>åŸå§‹å†…å­˜æ•°æ®</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl">  <span class="nf">system</span><span class="p">(</span><span class="s">&#34;pause&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">system</span><span class="p">(</span><span class="s">&#34;cls&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">70</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">229</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">239</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">230</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">22</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">90</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mi">90</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mi">251</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="mi">54</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="mi">18</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="mi">23</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="mi">68</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="mi">106</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="mi">45</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">=</span> <span class="mi">189</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span></code></pre></div><p>level 1å…³é”®ä»£ç </p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="nf">puts</span><span class="p">(</span><span class="s">&#34;first:this string md5:46e5efe6165a5afb361217446a2dbd01&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scanf</span><span class="p">(</span><span class="s">&#34;%s&#34;</span><span class="p">,</span> <span class="n">Str</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">MD5Init</span><span class="p">(</span><span class="n">v8</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span> <span class="o">=</span> <span class="nf">strlen</span><span class="p">(</span><span class="n">Str</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">MD5Update</span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">v8</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span> <span class="n">v3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">MD5Final</span><span class="p">(</span><span class="n">v8</span><span class="p">,</span> <span class="n">v6</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v13</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">15</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">v6</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">v7</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">v13</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">v13</span> <span class="o">!=</span> <span class="mi">1</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Game over&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">system</span><span class="p">(</span><span class="s">&#34;pause&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Great next level&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">system</span><span class="p">(</span><span class="s">&#34;pause&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">system</span><span class="p">(</span><span class="s">&#34;cls&#34;</span><span class="p">);</span>
</span></span></code></pre></div><p>level 2å…³é”®ä»£ç </p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;This time:Here are have some formulas&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;3x-y+z=185&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;2x+3y-z=321&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;x+y+z=173&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;input: x = &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scanf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v12</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;input: y = &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scanf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v11</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;input : z = &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scanf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">v12</span> <span class="o">-</span> <span class="n">v11</span> <span class="o">+</span> <span class="n">v10</span> <span class="o">!=</span> <span class="mi">185</span> <span class="o">||</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">v12</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">v11</span> <span class="o">-</span> <span class="n">v10</span> <span class="o">!=</span> <span class="mi">321</span> <span class="o">||</span> <span class="n">v11</span> <span class="o">+</span> <span class="n">v12</span> <span class="o">+</span> <span class="n">v10</span> <span class="o">!=</span> <span class="mi">173</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Game over&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Great last level coming...&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;pause&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">system</span><span class="p">(</span><span class="s">&#34;cls&#34;</span><span class="p">);</span>
</span></span></code></pre></div><p>level 3å…³é”®ä»£ç </p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Last time: Kill it&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;x*x+x-7943722218936282=0&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;input x: &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scanf</span><span class="p">(</span><span class="s">&#34;%lld&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v9</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">v9</span> <span class="o">*</span> <span class="p">(</span><span class="n">v9</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="mh">0x1C38C5F50DD7DALL</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Game over&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Great This is your FLAG&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>æ ¹æ®ä¸‰ä¸ªå…³é”®ä»£ç è¿›è¡Œä»£ç å®¡è®¡ï¼Œä»£ç å®¡è®¡è¿˜æ˜¯è€åŸºæœ¬åŠŸäº†</p>
<p>level 1çš„å…³é”®ä»£ç æ˜¯åˆ¤æ–­md5å€¼çš„ï¼Œä½¿ç”¨[cmd5](<a href="https://cmd5.com/" target="_blank">md5åœ¨çº¿è§£å¯†ç ´è§£,md5è§£å¯†åŠ å¯† (cmd5.com)</a>)å°±å¯ä»¥è§£å‡ºï¼Œå³ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">Str</span> <span class="o">=</span> <span class="s">&#34;en5oy&#34;</span><span class="p">;</span>
</span></span></code></pre></div><p>level 2çš„å…³é”®ä»£ç æ˜¯è§£æ–¹ç¨‹ç»„ï¼Œä½¿ç”¨sageæ±‚è§£ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">var</span><span class="p">(</span><span class="s2">&#34;x y z&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="n">solve</span><span class="p">([</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="o">+</span><span class="n">z</span><span class="o">==</span><span class="mi">185</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="o">-</span><span class="n">z</span><span class="o">==</span><span class="mi">321</span><span class="p">,</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">+</span><span class="n">z</span><span class="o">==</span><span class="mi">173</span><span class="p">],</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
</span></span></code></pre></div><p>è¿è¡Œå°±å¯ä»¥æ±‚è§£å¾—å‡ºxï¼Œyå’Œzçš„å€¼ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">[[</span><span class="n">x</span> <span class="o">==</span> <span class="mi">74</span><span class="p">,</span> <span class="n">y</span> <span class="o">==</span> <span class="mi">68</span><span class="p">,</span> <span class="n">z</span> <span class="o">==</span> <span class="mi">31</span><span class="p">]]</span>
</span></span></code></pre></div><p>å› æ­¤ï¼Œå¯ä»¥å¾—åˆ°ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">v12</span> <span class="o">==</span> <span class="mi">74</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">v11</span> <span class="o">==</span> <span class="mi">68</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">v10</span> <span class="o">==</span> <span class="mi">31</span><span class="p">;</span>
</span></span></code></pre></div><p>leve 3çš„å…³é”®ä»£ç å°±æ˜¯è§£ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹æˆ–è€…å¯ä»¥ç®€åŒ–ï¼Œå°±æ˜¯è§£<code>v9 * (v9 + 1) == 7943722218936282</code>ï¼Œå¯ä»¥ä½¿ç”¨sageç›´æ¥è¿›è¡Œæ±‚è§£ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"> <span class="n">solve</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">7943722218936282</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
</span></span></code></pre></div><p>è¿è¡Œå¯å¾—ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"> <span class="p">[</span><span class="n">x</span> <span class="o">==</span> <span class="mi">89127561</span><span class="p">,</span> <span class="n">x</span> <span class="o">==</span> <span class="o">-</span><span class="mi">89127562</span><span class="p">]</span>
</span></span></code></pre></div><p>ç”±æ­¤ï¼Œå¯ä»¥å¾—åˆ°ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">v9</span> <span class="o">==</span> <span class="mi">89127561</span><span class="p">;</span>
</span></span></code></pre></div><p>ç„¶åè¿›è¡Œç»„åˆå°±å¯ä»¥å¾—åˆ°flagï¼š</p>
<pre tabindex="0"><code>flag{en5oy_746831_89127561}
</code></pre>

<h2 class="relative group">0xD [RoarCTF2019]RSA 
    <div id="0xd-roarctf2019rsa" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#0xd-roarctf2019rsa" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>åˆæ¥äº†ä¸€é“RSAé¢˜ç›®ï¼Œçœ‹çœ‹æœ‰äº›ä»€ä¹ˆä¸œè¥¿å§ï¼</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">A=(((y%x)**5)%(x%y))**2019+y**316+(y+1)/x
</span></span><span class="line"><span class="cl">p=next_prime(z*x*y)
</span></span><span class="line"><span class="cl">q=next_prime(z)
</span></span><span class="line"><span class="cl">A =  2683349182678714524247469512793476009861014781004924905484127480308161377768192868061561886577048646432382128960881487463427414176114486885830693959404989743229103516924432512724195654425703453612710310587164417035878308390676612592848750287387318129424195208623440294647817367740878211949147526287091298307480502897462279102572556822231669438279317474828479089719046386411971105448723910594710418093977044179949800373224354729179833393219827789389078869290217569511230868967647963089430594258815146362187250855166897553056073744582946148472068334167445499314471518357535261186318756327890016183228412253724
</span></span><span class="line"><span class="cl">n =  117930806043507374325982291823027285148807239117987369609583515353889814856088099671454394340816761242974462268435911765045576377767711593100416932019831889059333166946263184861287975722954992219766493089630810876984781113645362450398009234556085330943125568377741065242183073882558834603430862598066786475299918395341014877416901185392905676043795425126968745185649565106322336954427505104906770493155723995382318346714944184577894150229037758434597242564815299174950147754426950251419204917376517360505024549691723683358170823416757973059354784142601436519500811159036795034676360028928301979780528294114933347127
</span></span><span class="line"><span class="cl">c =  41971850275428383625653350824107291609587853887037624239544762751558838294718672159979929266922528917912189124713273673948051464226519605803745171340724343705832198554680196798623263806617998072496026019940476324971696928551159371970207365741517064295956376809297272541800647747885170905737868568000101029143923792003486793278197051326716680212726111099439262589341050943913401067673851885114314709706016622157285023272496793595281054074260451116213815934843317894898883215362289599366101018081513215120728297131352439066930452281829446586562062242527329672575620261776042653626411730955819001674118193293313612128
</span></span></code></pre></div><p>è¿™é“é¢˜ç›®æ¶‰åŠåˆ°äº†æ¨¡çº¿æ€§æ–¹ç¨‹ï¼Œéœ€è¦è€ƒè™‘æ¨¡çº¿æ€§æ–¹ç¨‹è¯¥å¦‚ä½•è¿›è¡Œæ±‚è§£ã€‚ç›®å‰ï¼Œæˆ‘å°šæœªæ‰¾åˆ°é™¤äº†çˆ†ç ´å¤–çš„è§£æ³•ï¼Œå› æ­¤ï¼Œè¿™æ¬¡å°±ç”¨çˆ†ç ´æ¥æ±‚è§£ï¼Œä½†æ˜¯è¦ç”¨çˆ†ç ´æ±‚è§£å°±å¿…ç„¶éœ€è¦è€ƒè™‘çˆ†ç ´æ—¶é—´ï¼Œå¦‚ä½•æ¥ç¼©çŸ­çˆ†ç ´æ—¶é—´ã€‚</p>
<p>å†æ¥çœ‹çœ‹é¢˜ç›®ï¼š</p>
<p>é¢˜ç›®ç»™å®šäº†$A$ ã€$n$ ã€$c$ ï¼Œä¸”æ»¡è¶³</p>
<p>$$
A = [ (y \text{ % } x ) ^ 5 \text{ % } ( x \text{ % } y ) ] ^ {2019} + y ^ {316} + \frac{y+1}{x}
$$</p>
<p>æ ¹æ®æ–¹ç¨‹å¯ä»¥å¾—çŸ¥ $x | y+1$ å› æ­¤ï¼Œå¯ä»¥æ¨æ–­å‡ºæ¥ $ y \equiv -1 \text{mod}x$ ã€‚è€Œä¸”ç”±äº $ y+1$ æ¯” $x$ å¤§ï¼Œå› æ­¤ï¼Œåº”è¯¥æœ‰$x%y=x$ ã€‚äºæ˜¯ï¼š</p>
<p>$$
[(y\text{ % }x)^5\text{ % }(x\text{ % }y)]^{2019} = (x-1)^{2019}
$$</p>
<p>å› æ­¤ï¼Œå¯ä»¥å¾—åˆ°ï¼š</p>
<p>$$
A = (x-1)^{2019} + y^{316} + \frac{y+1}{x}
$$</p>
<p>é€šè¿‡è§‚å¯Ÿå‘ç°$A$çš„å€¼æ˜¯ä¸€ä¸ª2015ä¸ªbitçš„æ•°ã€‚è€Œä¸”ï¼š</p>
<p>$$
A \geq (x-1)^{2019}
$$</p>
<p>æ˜¾ç„¶åªæœ‰ï¼š</p>
<p>$$
x \leq 2
$$</p>
<p>å› æ­¤è¿›è¡Œè®¨è®º$x=1 $å’Œ$x =2$è¿™ä¸¤ç§æƒ…å†µæ—¶ï¼Œå‘ç°å­˜åœ¨æœ‰å”¯ä¸€è§£ï¼Œå³ï¼š</p>
<p>$$
(x,y) = (2,83)
$$</p>
<p>ç°åœ¨$ x $å’Œ$ y $çŸ¥é“äº†ï¼Œçœ‹ä¸€ä¸‹ç®—æ³•çš„å…¶ä»–ç»†èŠ‚å§</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">p</span><span class="o">=</span><span class="n">next_prime</span><span class="p">(</span><span class="n">z</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">q</span><span class="o">=</span><span class="n">next_prime</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</span></span></code></pre></div><p>ç”±äºå·²ç»çŸ¥é“äº†$x$å’Œ$y$ ï¼Œå› æ­¤ï¼Œå¯ä»¥çŸ¥é“ï¼š
$$
n = p \cdot q
$$</p>
<p>$$
n = z\cdot x \cdot y \cdot z
$$</p>
<p>å› æ­¤å¯ä»¥æ¨å‡ºï¼š
$$
q \approx \sqrt{\frac{n}{x\cdot y}}
$$</p>
<p>$$
p \approx x\cdot y \cdot q
$$</p>
<p>äºæ˜¯å¯ä»¥é€šè¿‡çˆ†ç ´æ±‚å‡º $p$ å’Œ $q$  æ¥è¿›è¡Œæ±‚è§£ï¼Œä½†æ˜¯é¢˜ç›®æ²¡æœ‰å‘ŠçŸ¥ $e$ ï¼Œå¯ä»¥å…ˆçŒœæµ‹ $e = 65537$ ã€‚æ ¹æ®è¿™ä¸ªæ€è·¯å†™ä¸ªå®Œæ•´è„šæœ¬ï¼š^1^</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">libnum</span><span class="o">,</span> <span class="nn">gmpy2</span><span class="o">,</span> <span class="nn">itertools</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">A</span> <span class="o">=</span>  <span class="mi">2683349182678714524247469512793476009861014781004924905484127480308161377768192868061561886577048646432382128960881487463427414176114486885830693959404989743229103516924432512724195654425703453612710310587164417035878308390676612592848750287387318129424195208623440294647817367740878211949147526287091298307480502897462279102572556822231669438279317474828479089719046386411971105448723910594710418093977044179949800373224354729179833393219827789389078869290217569511230868967647963089430594258815146362187250855166897553056073744582946148472068334167445499314471518357535261186318756327890016183228412253724</span>
</span></span><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span>  <span class="mi">117930806043507374325982291823027285148807239117987369609583515353889814856088099671454394340816761242974462268435911765045576377767711593100416932019831889059333166946263184861287975722954992219766493089630810876984781113645362450398009234556085330943125568377741065242183073882558834603430862598066786475299918395341014877416901185392905676043795425126968745185649565106322336954427505104906770493155723995382318346714944184577894150229037758434597242564815299174950147754426950251419204917376517360505024549691723683358170823416757973059354784142601436519500811159036795034676360028928301979780528294114933347127</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span>  <span class="mi">41971850275428383625653350824107291609587853887037624239544762751558838294718672159979929266922528917912189124713273673948051464226519605803745171340724343705832198554680196798623263806617998072496026019940476324971696928551159371970207365741517064295956376809297272541800647747885170905737868568000101029143923792003486793278197051326716680212726111099439262589341050943913401067673851885114314709706016622157285023272496793595281054074260451116213815934843317894898883215362289599366101018081513215120728297131352439066930452281829446586562062242527329672575620261776042653626411730955819001674118193293313612128</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">x</span> <span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">83</span>
</span></span><span class="line"><span class="cl"><span class="n">A_t</span> <span class="o">=</span> <span class="p">(((</span><span class="n">y</span><span class="o">%</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">5</span><span class="p">)</span><span class="o">%</span><span class="p">(</span><span class="n">x</span><span class="o">%</span><span class="n">y</span><span class="p">))</span><span class="o">**</span><span class="mi">2019</span><span class="o">+</span><span class="n">y</span><span class="o">**</span><span class="mi">316</span><span class="o">+</span><span class="p">(</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">x</span>
</span></span><span class="line"><span class="cl"><span class="k">assert</span> <span class="n">A_t</span> <span class="o">==</span> <span class="n">A</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">gmpy2</span><span class="o">.</span><span class="n">iroot</span><span class="p">(</span><span class="n">n</span><span class="o">//</span><span class="mi">166</span><span class="p">,</span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">n</span><span class="o">%</span><span class="n">q</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="n">n</span><span class="o">//</span><span class="n">q</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">assert</span> <span class="n">n</span> <span class="o">==</span> <span class="n">p</span><span class="o">*</span><span class="n">q</span>
</span></span><span class="line"><span class="cl"><span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>
</span></span><span class="line"><span class="cl"><span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">d</span> <span class="o">=</span> <span class="n">gmpy2</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">m</span> <span class="o">=</span> <span class="n">gmpy2</span><span class="o">.</span><span class="n">powmod</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="n">libnum</span><span class="o">.</span><span class="n">n2s</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span> <span class="n">flag</span>
</span></span></code></pre></div><p>è¿è¡Œè„šæœ¬ï¼Œå³å¯å¾—åˆ°flagï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">RoarCTF{wm-l1l1ll1l1l1l111ll}
</span></span></code></pre></div><p>è¿™é“é¢˜ç›®çš„æ±‚è§£æ–¹æ³•æ˜¯ä¼˜é›…ä¸æš´åŠ›ç›¸ç»“åˆçš„ï¼Œèƒ½å±•ç°å‡ºä¸€ç§ç‰¹åˆ«çš„ç¾æ„Ÿï¼Œæ•°å­¦æ¨å¯¼çš„ä¼˜é›…å’Œè›®åŠ›æ”»å‡»çš„æš´åŠ›ã€‚é‡è›®ä¸ä¼˜é›…ï¼Œå±•ç°å‡ºå¯†ç å­¦ç‹¬æœ‰ç¾ï¼Œé¢˜ç›®è¿˜æ˜¯æŒºä¸é”™çš„ã€‚</p>


<h2 class="relative group">0xE [AFCTF2018]Single 
    <div id="0xe-afctf2018single" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#0xe-afctf2018single" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>å•ä¸€çš„ï¼Œçœ‹çœ‹é¢˜ç›®ç»™äº†æˆ‘ä»¬ä»€ä¹ˆåŒ…è£¹å§ï¼</p>
<p>ä¸€ä¸ª<code>Cipher.txt</code>å¯†æ–‡æ–‡ä»¶å’Œä¸€ä¸ª<code>Encode.cpp</code>åŠ å¯†æ–‡ä»¶ã€‚</p>
<p>Encode.cpp</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">freopen</span><span class="p">(</span><span class="s">&#34;Plain.txt&#34;</span><span class="p">,</span><span class="s">&#34;r&#34;</span><span class="p">,</span><span class="n">stdin</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">freopen</span><span class="p">(</span><span class="s">&#34;Cipher.txt&#34;</span><span class="p">,</span><span class="s">&#34;w&#34;</span><span class="p">,</span><span class="n">stdout</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">map</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span> <span class="kt">char</span><span class="o">&gt;</span> <span class="n">f</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">arr</span><span class="p">[</span><span class="mi">26</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">26</span><span class="p">;</span><span class="o">++</span><span class="n">i</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">		<span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">random_shuffle</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span><span class="n">arr</span><span class="o">+</span><span class="mi">26</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">26</span><span class="p">;</span><span class="o">++</span><span class="n">i</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">		<span class="n">f</span><span class="p">[</span><span class="sc">&#39;a&#39;</span><span class="o">+</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="sc">&#39;a&#39;</span><span class="o">+</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">		<span class="n">f</span><span class="p">[</span><span class="sc">&#39;A&#39;</span><span class="o">+</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="sc">&#39;A&#39;</span><span class="o">+</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="n">ch</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">while</span><span class="p">((</span><span class="n">ch</span><span class="o">=</span><span class="n">getchar</span><span class="p">())</span><span class="o">!=</span><span class="n">EOF</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">count</span><span class="p">(</span><span class="n">ch</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">			<span class="n">putchar</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">ch</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">putchar</span><span class="p">(</span><span class="n">ch</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Cipher.txt</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">Jmqrida rva Lfmz (JRL) eu m uqajemf seny xl enlxdomrexn uajiderc jxoqarerexnu. Rvada mda rvdaa jxooxn rcqau xl JRLu: Paxqmdyc, Mrrmjs-Yalanja mny oekay.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Paxqmdyc-urcfa JRLu vmu m jxiqfa xl giaurexnu (rmusu) en dmnza xl jmrazxdeau. Lxd akmoqfa, Wab, Lxdanuej, Jdcqrx, Benmdc xd uxoarvenz afua. Ramo jmn zmen uxoa qxenru lxd atadc uxftay rmus. Oxda qxenru lxd oxda jxoqfejmray rmusu iuimffc. Rva nakr rmus en jvmen jmn ba xqanay xnfc mlrad uxoa ramo uxfta qdatexiu rmus. Rvan rva zmoa reoa eu xtad uio xl qxenru uvxwu cxi m JRL wenad. Lmoxiu akmoqfa xl uijv JRL eu Yaljxn JRL gimfu.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Waff, mrrmjs-yalanja eu mnxrvad enradaurenz seny xl jxoqarerexnu. Vada atadc ramo vmu xwn narwxds(xd xnfc xna vxur) werv tifnmdmbfa uadtejau. Cxid ramo vmu reoa lxd qmrjvenz cxid uadtejau mny yatafxqenz akqfxeru iuimffc. Ux, rvan xdzmnehadu jxnnajru qmdrejeqmnru xl jxoqarerexn mny rva wmdzmoa urmdru! Cxi uvxify qdxrajr xwn uadtejau lxd yalanja qxenru mny vmjs xqqxnanru lxd mrrmjs qxenru. Veurxdejmffc rveu eu m ledur rcqa xl JRLu, atadcbxyc snxwu mbxir YAL JXN JRL - uxoarvenz fesa m Wxdfy Jiq xl mff xrvad jxoqarerexnu.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Oekay jxoqarerexnu omc tmdc qxuuebfa lxdomru. Er omc ba uxoarvenz fesa wmdzmoa werv uqajemf reoa lxd rmus-bmuay afaoanru (a.z. IJUB eJRL).
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">JRL zmoau xlran rxijv xn omnc xrvad muqajru xl enlxdomrexn uajiderc: jdcqrxzdmqvc, urazx, benmdc mnmfcueu, datadua anzanaadenz, oxbefa uajiderc mny xrvadu. Zxxy ramou zanadmffc vmta urdxnz useffu mny akqadeanja en mff rvaua euuiau.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Iuimffc, lfmz eu uxoa urdenz xl dmnyxo ymrm xd rakr en uxoa lxdomr. Akmoqfa mljrl{Xv_I_lxiny_er_neja_rDc}
</span></span></code></pre></div><p>çœ‹æ ·å­ï¼Œåº”è¯¥æ˜¯ä¸€ä¸ªæ›¿æ¢åŠ å¯†çš„é¢˜ç›®ã€‚å¯ä»¥ç›´æ¥æ‰”è¿›<a href="https://quipqiup.com/" target="_blank">è¯é¢‘åˆ†æç½‘ç«™</a>è¿›è¡Œè¯é¢‘åˆ†ææ¥æ±‚è§£ï¼Œå¾—åˆ°æ±‚è§£ç»“æœï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">	Capture the Flag (CTF) is a special kind of information security competitions. There are three common types of CTFs: Jeopardy, Attack-Defence and mixed. Jeopardy-style CTFs has a couple of questions (tasks) in range of categories. For example, Web, Forensic, Crypto, Binary or something else. Team can gain some points for every solved task. More points for more complicated tasks usually. The next task in chain can be opened only after some team solve previous task. Then the game time is over sum of points shows you a CTF winer. Famous example of such CTF is Defcon CTF quals. Well, attack-defence is another interesting kind of competitions. Here every team has own network(or only one host) with vulnarable services. Your team has time for patching your services and developing exploits usually. So, then organizers connects participants of competition and the wargame starts! You should protect own services for defence points and hack opponents for attack points. Historically this is a first type of CTFs, everybody knows about DEF CON CTF - something like a World Cup of all other competitions. Mixed competitions may vary possible formats. It may be something like wargame with special time for task-based elements (e.g. UCSB iCTF). CTF games often touch on many other aspects of information security: cryptography, stego, binary analysis, reverse engeneering, mobile security and others. Good teams generally have strong skills and experience in all these issues. Usually, flag is some string of random data or text in some format. Example afctf{Oh_U_found_it_nice_tRy}
</span></span></code></pre></div><p>å¿«ç§ï¼Œflagå°±åœ¨æœ€åä¸€è¡Œï¼è¿™é¢˜å°±è¿™ä¹ˆå®Œäº†ï¼Œæœ‰å·¥å…·çœŸæ˜¯å¥½(*^_^*)</p>


<h2 class="relative group">0xF [WUSTCTF2020]B@se 
    <div id="0xf-wustctf2020bse" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#0xf-wustctf2020bse" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>çœ‹é¢˜ç›®ï¼Œåº”è¯¥æ˜¯ä¸€é“BASEçš„é¢˜ç›®ã€‚çœ‹çœ‹é™„ä»¶ä¼šç»™äº›ä»€ä¹ˆå§ï¼</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">å¯†æ–‡ï¼šMyLkTaP3FaA7KOWjTmKkVjWjVzKjdeNvTnAjoH9iZOIvTeHbvD==
</span></span><span class="line"><span class="cl">JASGBWcQPRXEFLbCDIlmnHUVKTYZdMovwipatNOefghq56rs****kxyz012789+/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">oh holy shit, something is missing...
</span></span></code></pre></div><p>è¿™é“é¢˜ç›®çš„åº”è¯¥æ˜¯å˜æ¢äº†ç¼–ç è¡¨çš„base64ï¼Œä¿®æ”¹å¹¶æ›¿æ¢ä¸€ä¸‹ä½¿ç”¨base64è¿›è¡Œè§£å¯†ï¼Œä½†æ˜¯å˜æ¢åçš„ç¼–ç è¡¨ä¸­æœ‰å››ä¸ªå­—æ¯æ˜¯é¡ºåºä½ç½®ï¼Œå› æ­¤å¯èƒ½ä¼šæœ‰24ç§å¯èƒ½çš„æƒ…å†µã€‚éœ€è¦è¿›è¡Œçˆ†ç ´ï¼Œé¦–å…ˆè¦çŸ¥é“æ˜¯é‚£äº›å­—ç¬¦ç¼ºå¤±äº†ï¼Œç„¶åå¯¹ç¼ºå¤±å­—ç¬¦çš„æ•°ç»„è¿›è¡Œçˆ†ç ´ï¼Œç„¶ååœ¨ä½¿ç”¨base64æ›¿æ¢æ¥è¿›è¡Œbase64çš„æ±‚è§£ã€‚æ ¹æ®è¿™ä¸ªæ€è·¯æ¥å†™ä¸ªè„šæœ¬ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">base64</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">string</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">itertools</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">base64_stand</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">uppercase</span><span class="o">+</span><span class="n">string</span><span class="o">.</span><span class="n">lowercase</span><span class="o">+</span><span class="n">string</span><span class="o">.</span><span class="n">digits</span><span class="o">+</span><span class="s2">&#34;+/&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">new_base64</span> <span class="o">=</span> <span class="s2">&#34;JASGBWcQPRXEFLbCDIlmnHUVKTYZdMovwipatNOefghq56rs****kxyz012789+/&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">lose_letters</span> <span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="s2">&#34;MyLkTaP3FaA7KOWjTmKkVjWjVzKjdeNvTnAjoH9iZOIvTeHbvD==&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">flags</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">base64_change</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span> <span class="o">+=</span> <span class="n">s</span><span class="p">[</span><span class="n">n</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span> <span class="o">+=</span> <span class="n">i</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">result</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">result</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">base64_stand</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">test</span> <span class="o">=</span> <span class="n">new_base64</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">test</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">lose_letters</span> <span class="o">+=</span> <span class="n">i</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">permutations</span><span class="p">(</span><span class="n">lose_letters</span><span class="p">,</span><span class="mi">4</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">    <span class="n">m</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">base64_new</span> <span class="o">=</span> <span class="n">new_base64</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;****&#34;</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag</span> <span class="o">=</span> <span class="n">base64_change</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">base64_stand</span><span class="p">,</span> <span class="n">base64_new</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">flag</span> <span class="ow">and</span> <span class="s2">&#34;2020&#34;</span> <span class="ow">in</span> <span class="n">flag</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">flags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">flag</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">flags</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span> <span class="n">flag</span>
</span></span></code></pre></div><p>è¿è¡Œè„šæœ¬ï¼Œå¾—åˆ°å¯èƒ½çš„flagï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">wctf2020{base64_1s_v3ry_e@sy_and_fuN}
</span></span><span class="line"><span class="cl">wctf2020{bare64_!r_v2ry_e@ry_and_fuN}
</span></span></code></pre></div><p>ç»è¿‡æµ‹è¯•ï¼Œflagåº”è¯¥æ˜¯ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">wctf2220{base64_1s_v3ry_e@sy_and_fuN}
</span></span></code></pre></div><p>æœ¬é¢˜åˆ°æ­¤ç»“æŸï¼</p>


<h2 class="relative group">å‚è€ƒ 
    <div id="%E5%8F%82%E8%80%83" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E5%8F%82%E8%80%83" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<ol>
<li><a href="https://www.ruanx.net/rsa-solutions/" target="_blank">CTF RSAé¢˜è§£é›† (ruanx.net)</a></li>
</ol>

          
          
          
        </div>
        
        

        
        

          
      </div>
     
      
      
        
        
          
          
        
      <script>
        var oid = "views_posts\/BUUCTF-CRYPTO-5_writeup.md"
        var oid_likes = "likes_posts\/BUUCTF-CRYPTO-5_writeup.md"
      </script>
      
      
      <script type="text/javascript" src="/js/page.min.0860cf4e04fa2d72cc33ddba263083464d48f67de06114529043cb4623319efed4f484fd7f1730df5abea0e2da6f3538855634081d02f2d6e920b956f063e823.js" integrity="sha512-CGDPTgT6LXLMM926JjCDRk1I9n3gYRRSkEPLRiMxnv7U9IT9fxcw31q&#43;oOLabzU4hVY0CB0C8tbpILlW8GPoIw=="></script>
      
  
    </section>
  <footer class="pt-8 max-w-prose print:hidden">

    
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="flex group mr-3" href="/posts/buuctf-crypto-4_writeup/">
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >BUUCTF CRYPTO (4) writeup</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2021-06-26T17:20:25&#43;08:00">26 June 2021</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
            <a class="flex text-right group ml-3" href="/posts/buuctf-crypto-6_writeup/">
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >BUUCTF CRYPTO (6) writeup</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2021-07-08T16:26:32&#43;08:00">8 July 2021</time>
                  
                </span>
              </span>
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
            </a>
          
        </span>
      </div>
    </div>
  


    
  </footer>
</article>

      <div id="top-scroller" class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0">
  <a href="#the-top"
    class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top" title="Scroll to top">
    &uarr;
  </a>
</div>
    </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
  
  <div class="flex items-center justify-between">

    
    
    <p class="text-sm text-neutral-500 dark:text-neutral-400">
      &copy;
      2025
      Jasmineâ„Hiker
    </p>
    

    
    
    <p class="text-xs text-neutral-500 dark:text-neutral-400">
      
      
      Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://blowfish.page/" target="_blank" rel="noopener noreferrer">Blowfish</a>
    </p>
    

  </div>
  <script>
    
    mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
      margin: 24,
      background: 'rgba(0,0,0,0.5)',
      scrollOffset: 0,
    })
    
  </script>
  
  
  <script type="text/javascript" src="/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js" integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh&#43;sCQ0E53ghYrxgYqw&#43;0GCRyIEpA=="></script>
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]"
  data-url="https://jashiker.github.io/"
  style="z-index:500"
>
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"
  >
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0"
        />
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)"
      >
        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>


      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

  </div>
</body>

</html>
