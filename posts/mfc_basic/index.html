<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>MFC基础 笔记 | OPdbgBytes</title>
<meta name="keywords" content="Windows, “Note&#34;">
<meta name="description" content="MFC 默认UNICODE编码
CTIME类 获取时间的类对象，可以通过类方法获取时间
使用方法
CTime m_Time = CTime::GetCurrentTime(); int nYear = m_Time.GetYear(); int nMonth = m_Time.GetMonth(); int nDay = m_Time.GetDay(); int nHour = m_Time.GetHour(); int nMinute = m_Time.GetMinute(); int nSecond = m_Time.GetSecond(); MFC三种开发模式  SDK &ndash;&gt; Win32 MFC &ndash;&gt; MFC 托管 &ndash;&gt; CLR  字符串 ASCII char CHAR UNICODE wchar_t WCHAR T TCHAR
CString类 定义与初始化
CString str(L&#34;大大大&#34;); CString str1; str1 = L&#34;小小小&#34;; CString str2 = str1; CString str3 = L&#39;A&#39;; CString str4(L&#34;A&#34;,66); 格式化字符串">
<meta name="author" content="Me">
<link rel="canonical" href="https://www.codetea.top/posts/mfc_basic/">

<script>
  MathJax = {
    tex: {
      inlineMath: [["$", "$"]],
    },
    displayMath: [
      ["$$", "$$"],
      ["\[\[", "\]\]"],
    ],
    svg: {
      fontCache: "global",
    },
  };
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
></script>

<link crossorigin="anonymous" href="/assets/css/stylesheet.0b739a2e2c5e5656e4bcd5f0b2268d063addaf81d89ec3987d6af8f04decdc97.css" integrity="sha256-C3OaLixeVlbkvNXwsiaNBjrdr4HYnsOYfWr48E3s3Jc=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.acb54fd32bbc1982428b8850317e45d076b95012730a5936667e6bc21777692a.js" integrity="sha256-rLVP0yu8GYJCi4hQMX5F0Ha5UBJzClk2Zn5rwhd3aSo="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://www.codetea.top/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://www.codetea.top/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://www.codetea.top/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://www.codetea.top/apple-touch-icon.png">
<link rel="mask-icon" href="https://www.codetea.top/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="MFC基础 笔记" />
<meta property="og:description" content="MFC 默认UNICODE编码
CTIME类 获取时间的类对象，可以通过类方法获取时间
使用方法
CTime m_Time = CTime::GetCurrentTime(); int nYear = m_Time.GetYear(); int nMonth = m_Time.GetMonth(); int nDay = m_Time.GetDay(); int nHour = m_Time.GetHour(); int nMinute = m_Time.GetMinute(); int nSecond = m_Time.GetSecond(); MFC三种开发模式  SDK &ndash;&gt; Win32 MFC &ndash;&gt; MFC 托管 &ndash;&gt; CLR  字符串 ASCII char CHAR UNICODE wchar_t WCHAR T TCHAR
CString类 定义与初始化
CString str(L&#34;大大大&#34;); CString str1; str1 = L&#34;小小小&#34;; CString str2 = str1; CString str3 = L&#39;A&#39;; CString str4(L&#34;A&#34;,66); 格式化字符串" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.codetea.top/posts/mfc_basic/" /><meta property="og:image" content="https://www.codetea.top/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-02-22T18:30:22&#43;08:00" />
<meta property="article:modified_time" content="2022-02-22T18:30:22&#43;08:00" /><meta property="og:site_name" content="ExampleSite" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://www.codetea.top/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"/>

<meta name="twitter:title" content="MFC基础 笔记"/>
<meta name="twitter:description" content="MFC 默认UNICODE编码
CTIME类 获取时间的类对象，可以通过类方法获取时间
使用方法
CTime m_Time = CTime::GetCurrentTime(); int nYear = m_Time.GetYear(); int nMonth = m_Time.GetMonth(); int nDay = m_Time.GetDay(); int nHour = m_Time.GetHour(); int nMinute = m_Time.GetMinute(); int nSecond = m_Time.GetSecond(); MFC三种开发模式  SDK &ndash;&gt; Win32 MFC &ndash;&gt; MFC 托管 &ndash;&gt; CLR  字符串 ASCII char CHAR UNICODE wchar_t WCHAR T TCHAR
CString类 定义与初始化
CString str(L&#34;大大大&#34;); CString str1; str1 = L&#34;小小小&#34;; CString str2 = str1; CString str3 = L&#39;A&#39;; CString str4(L&#34;A&#34;,66); 格式化字符串"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://www.codetea.top/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "MFC基础 笔记",
      "item": "https://www.codetea.top/posts/mfc_basic/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "MFC基础 笔记",
  "name": "MFC基础 笔记",
  "description": "MFC 默认UNICODE编码\nCTIME类 获取时间的类对象，可以通过类方法获取时间\n使用方法\nCTime m_Time = CTime::GetCurrentTime(); int nYear = m_Time.GetYear(); int nMonth = m_Time.GetMonth(); int nDay = m_Time.GetDay(); int nHour = m_Time.GetHour(); int nMinute = m_Time.GetMinute(); int nSecond = m_Time.GetSecond(); MFC三种开发模式  SDK \u0026ndash;\u0026gt; Win32 MFC \u0026ndash;\u0026gt; MFC 托管 \u0026ndash;\u0026gt; CLR  字符串 ASCII char CHAR UNICODE wchar_t WCHAR T TCHAR\nCString类 定义与初始化\nCString str(L\u0026#34;大大大\u0026#34;); CString str1; str1 = L\u0026#34;小小小\u0026#34;; CString str2 = str1; CString str3 = L\u0026#39;A\u0026#39;; CString str4(L\u0026#34;A\u0026#34;,66); 格式化字符串",
  "keywords": [
    "Windows", "“Note\""
  ],
  "articleBody": "MFC 默认UNICODE编码\nCTIME类 获取时间的类对象，可以通过类方法获取时间\n使用方法\nCTime m_Time = CTime::GetCurrentTime(); int nYear = m_Time.GetYear(); int nMonth = m_Time.GetMonth(); int nDay = m_Time.GetDay(); int nHour = m_Time.GetHour(); int nMinute = m_Time.GetMinute(); int nSecond = m_Time.GetSecond(); MFC三种开发模式  SDK – Win32 MFC – MFC 托管 – CLR  字符串 ASCII char CHAR UNICODE wchar_t WCHAR T TCHAR\nCString类 定义与初始化\nCString str(L\"大大大\"); CString str1; str1 = L\"小小小\"; CString str2 = str1; CString str3 = L'A'; CString str4(L\"A\",66); 格式化字符串\nCString str; int nFlag = 100; char strz[] = \"Hello World!\"; str.Format(L\"char = %S int = %d\", strz, nFlag); 字符串长度获取\nint count = str.GetLength(); 判断字符串为空\nbool flag = str.IsEmpty(); 字符串拼接\nCString A(L\"A\"); CString B(L\"B\"); A = A + B; 切片操作\nCString A(L\"ABCDEFGH\"); CString B = A.Left(2); CString C = A.Mid(2, 2); CString D = A.Right(2); 删除操作\nCString A(L\"ABCDEFGH\"); A.Remove(L\"A\"); 获取字符串\nCString A(L\"ABCDEFGH\"); LPTSTR TSTR = A.GetBuffer(); Windows消息基础 消息的来源\n 由操作系统产生 用户触发事件转换 由另一个消息产生  消息的定义\n   前缀 说明     WM 普通窗口   BM 按钮   CB 组合框   CDM 通用对话框   DBT 设备信息   DL 下拉列表   EM 编辑框   HKM 热键   IPM IP控件   LB 列表框   LVM 列表视图   MCM 日历控件   PBM 进度条   PSM 属性   RB 伸缩条   SB 状态栏   STM 静态栏   TB 工具条   TBM 跟踪条   TCM 标签控件   TVM 树视图   UDM 微调按钮控件    MSG结构体\ntypedef struct tagMSG{ HWND hwnd; UINT message; WPARAM wParam; LPARAM lParam; DWORD time; POINT pt; #ifdef _MAC \tDWORD lPrivate; #endif } MSG, *PMSG, NEAR *NPMSG, FAR *LPMSG; 预定义消息 窗口消息 WM_CREATE 创建窗口 WM_PAINT 绘制窗口 WM_DESTROY 销毁窗口 WM_KILLFOCUS 失去焦点 WM_SETFOCUS 获得焦点 WM_MEASUREITEM WM_DRAWTEM\n命令消息 WM_COMMAND\n控件通知消息 WM_xxxx\n WM_PARENTNOTIFY WM_CTLCOLOR … WM_VSCROLL/WM_HSCROLL  按钮控件 组合框控件 编辑框控件 列表框控件\nWM_NOTIFY 控件绘制结构体\ntypedef struct tagDRAWITEMSTRUCT { UINT CtlType; UINT CtlID; UINT itemID; UINT itemAction; UINT itemState; HWND hwndItem; HDC hDC; RECT rcItem; ULONG_PTR itemData; } DRAWITEMSTRUCT, NEAR *PDRAWITEMSTRUCT, FAR *LPDRAWITEMSTRUCT; typedef struct tagNMHDR { HWND hwndFrom; UINT_PTR idFrom; UINT code; // NM_ code } NMHDR; typedef struct tagLVKEYDOWN { NMHDR hdr; WORD wVKey; UINT flags; } NMLVKEYDOWN, *LPNMLVKEYDOWN; 自定义消息 #define MY_MSG WM_USER+1 使用方法 SendMessage 同步方式 PostMessage 异步方式\nWin32(SDK)  WinMain MSG结构体 注册窗口 创建窗口 显示窗口 刷新窗口 消息循环 WindowProc  // WindowsSDK.cpp : 定义应用程序的入口点。 //  #include \"framework.h\"#include \"WindowsSDK.h\" #define MAX_LOADSTRING 100  // 全局变量: HINSTANCE hInst; // 当前实例 WCHAR szTitle[MAX_LOADSTRING]; // 标题栏文本 WCHAR szWindowClass[MAX_LOADSTRING]; // 主窗口类名  // 此代码模块中包含的函数的前向声明: ATOM MyRegisterClass(HINSTANCE hInstance); BOOL InitInstance(HINSTANCE, int); LRESULT CALLBACK WndProc(HWND, UINT, WPARAM, LPARAM); INT_PTR CALLBACK About(HWND, UINT, WPARAM, LPARAM); int APIENTRY wWinMain(_In_ HINSTANCE hInstance, _In_opt_ HINSTANCE hPrevInstance, _In_ LPWSTR lpCmdLine, _In_ int nCmdShow) { UNREFERENCED_PARAMETER(hPrevInstance); UNREFERENCED_PARAMETER(lpCmdLine); // TODO: 在此处放置代码。  // 初始化全局字符串  LoadStringW(hInstance, IDS_APP_TITLE, szTitle, MAX_LOADSTRING); LoadStringW(hInstance, IDC_WINDOWSSDK, szWindowClass, MAX_LOADSTRING); MyRegisterClass(hInstance); // 执行应用程序初始化:  if (!InitInstance (hInstance, nCmdShow)) { return FALSE; } HACCEL hAccelTable = LoadAccelerators(hInstance, MAKEINTRESOURCE(IDC_WINDOWSSDK)); MSG msg; // 主消息循环:  while (GetMessage(\u0026msg, nullptr, 0, 0)) { if (!TranslateAccelerator(msg.hwnd, hAccelTable, \u0026msg)) { TranslateMessage(\u0026msg); DispatchMessage(\u0026msg); } } return (int) msg.wParam; } // // 函数: MyRegisterClass() // // 目标: 注册窗口类。 // ATOM MyRegisterClass(HINSTANCE hInstance) { WNDCLASSEXW wcex; wcex.cbSize = sizeof(WNDCLASSEX); wcex.style = CS_HREDRAW | CS_VREDRAW; wcex.lpfnWndProc = WndProc; wcex.cbClsExtra = 0; wcex.cbWndExtra = 0; wcex.hInstance = hInstance; wcex.hIcon = LoadIcon(hInstance, MAKEINTRESOURCE(IDI_WINDOWSSDK)); wcex.hCursor = LoadCursor(nullptr, IDC_ARROW); wcex.hbrBackground = (HBRUSH)(COLOR_WINDOW+1); wcex.lpszMenuName = MAKEINTRESOURCEW(IDC_WINDOWSSDK); wcex.lpszClassName = szWindowClass; wcex.hIconSm = LoadIcon(wcex.hInstance, MAKEINTRESOURCE(IDI_SMALL)); return RegisterClassExW(\u0026wcex); } // // 函数: InitInstance(HINSTANCE, int) // // 目标: 保存实例句柄并创建主窗口 // // 注释: // // 在此函数中，我们在全局变量中保存实例句柄并 // 创建和显示主程序窗口。 // BOOL InitInstance(HINSTANCE hInstance, int nCmdShow) { hInst = hInstance; // 将实例句柄存储在全局变量中  HWND hWnd = CreateWindowW(szWindowClass, szTitle, WS_OVERLAPPEDWINDOW, CW_USEDEFAULT, 0, CW_USEDEFAULT, 0, nullptr, nullptr, hInstance, nullptr); if (!hWnd) { return FALSE; } ShowWindow(hWnd, nCmdShow); UpdateWindow(hWnd); return TRUE; } // // 函数: WndProc(HWND, UINT, WPARAM, LPARAM) // // 目标: 处理主窗口的消息。 // // WM_COMMAND - 处理应用程序菜单 // WM_PAINT - 绘制主窗口 // WM_DESTROY - 发送退出消息并返回 // // LRESULT CALLBACK WndProc(HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam) { switch (message) { case WM_COMMAND: { int wmId = LOWORD(wParam); // 分析菜单选择:  switch (wmId) { case IDM_ABOUT: DialogBox(hInst, MAKEINTRESOURCE(IDD_ABOUTBOX), hWnd, About); break; case IDM_EXIT: DestroyWindow(hWnd); break; default: return DefWindowProc(hWnd, message, wParam, lParam); } } break; case WM_PAINT: { PAINTSTRUCT ps; HDC hdc = BeginPaint(hWnd, \u0026ps); // TODO: 在此处添加使用 hdc 的任何绘图代码...  EndPaint(hWnd, \u0026ps); } break; case WM_DESTROY: PostQuitMessage(0); break; default: return DefWindowProc(hWnd, message, wParam, lParam); } return 0; } // “关于”框的消息处理程序。 INT_PTR CALLBACK About(HWND hDlg, UINT message, WPARAM wParam, LPARAM lParam) { UNREFERENCED_PARAMETER(lParam); switch (message) { case WM_INITDIALOG: return (INT_PTR)TRUE; case WM_COMMAND: if (LOWORD(wParam) == IDOK || LOWORD(wParam) == IDCANCEL) { EndDialog(hDlg, LOWORD(wParam)); return (INT_PTR)TRUE; } break; } return (INT_PTR)FALSE; } 键盘消息 与key有关的\n相关代码\nBOOL CMFCKeyDlg::PreTranslateMessage(MSG* pMsg) { // TODO: 在此添加专用代码和/或调用基类 \tSHORT nShift = GetKeyState(VK_SHIFT); switch (pMsg-message) { case WM_KEYDOWN: { switch (pMsg-wParam) { case VK_F2: { if (nShift  0) { AfxMessageBox(L\"F2 + shift Message!\"); break; } AfxMessageBox(L\"F2 Message!\"); break; } case 0x41: { AfxMessageBox(L\"A Message!\"); break; } case VK_ESCAPE: return 0; case VK_RETURN: return 0; default: break; } break; } default: break; } return CDialogEx::PreTranslateMessage(pMsg); } 虚拟键码\n VK_xxx ASCII码  虚拟键码表\n   虚拟键码 对应值 对应键     VK_LBUTTON 1 鼠标左键   VK_RBUTTON 2 鼠标右键   VK_CANCEL 3 Cancel   VK_MBUTTON 4 鼠标中键   VK_XBUTTON1 5    VK_XBUTTON2 6    VK_BACK 8 Backspace   VK_TAB 9 Tab   VK_CLEAR 12 Clear   VK_RETURN 13 Enter   VK_SHIFT 16 Shift   VK_CONTROL 17 Ctrl   VK_MENU 18 Alt   VK_PAUSE 19 Pause   VK_CAPITAL 20 Caps Lock   VK_KANA 21    VK_HANGUL 21    VK_JUNJA 23    VK_FINAL 24    VK_HANJA 25    VK_KANJI 25*    VK_ESCAPE 27 Esc   VK_CONVERT 28    VK_NONCONVERT 29    VK_ACCEPT 30    VK_MODECHANGE 31    VK_SPACE 32 Space   VK_PRIOR 33 Page Up   VK_NEXT 34 Page Down   VK_END 35 End   VK_HOME 36 Home   VK_LEFT 37 Left Arrow   VK_UP 38 Up Arrow   VK_RIGHT 39 Right Arrow   VK_DOWN 40 Down Arrow   VK_SELECT 41 Select   VK_PRINT 42 Print   VK_EXECUTE 43 Execute   VK_SNAPSHOT 44 Snapshot   VK_INSERT 45 Insert   VK_DELETE 46 Delete   VK_HELP 47 Help    48 0    49 1    50 2    51 3    52 4    53 5    54 6    55 7    56 8    57 9    65 A    66 B    67 C    68 D    69 E    70 F    71 G    72 H    73 I    74 J    75 K    76 L    77 M    78 N    79 O    80 P    81 Q    82 R    83 S    84 T    85 U    86 V    87 W    88 X    89 Y    90 Z   VK_LWIN 91    VK_RWIN 92    VK_APPS 93    VK_SLEEP 95    VK_NUMPAD0 96 小键盘 0   VK_NUMPAD1 97 小键盘 1   VK_NUMPAD2 98 小键盘 2   VK_NUMPAD3 99 小键盘 3   VK_NUMPAD4 100 小键盘 4   VK_NUMPAD5 101 小键盘 5   VK_NUMPAD6 102 小键盘 6   VK_NUMPAD7 103 小键盘 7   VK_NUMPAD8 104 小键盘 8   VK_NUMPAD9 105 小键盘 9   VK_MULTIPLY 106 小键盘 *   VK_ADD 107 小键盘 +   VK_SEPARATOR 108 小键盘 Enter   VK_SUBTRACT 109 小键盘 -   VK_DECIMAL 110 小键盘 .   VK_DIVIDE 111 小键盘 /   VK_F1 112 F1   VK_F2 113 F2   VK_F3 114 F3   VK_F4 115 F4   VK_F5 116 F5   VK_F6 117 F6   VK_F7 118 F7   VK_F8 119 F8   VK_F9 120 F9   VK_F10 121 F10   VK_F11 122 F11   VK_F12 123 F12   VK_F13 124    VK_F14 125    VK_F15 126    VK_F16 127    VK_F17 128    VK_F18 129    VK_F19 130    VK_F20 131    VK_F21 132    VK_F22 133    VK_F23 134    VK_F24 135    VK_NUMLOCK 144 Num Lock   VK_SCROLL 145 Scroll   VK_LSHIFT 160    VK_RSHIFT 161    VK_LCONTROL 162    VK_RCONTROL 163    VK_LMENU 164    VK_RMENU 165    VK_BROWSER_BACK 166    VK_BROWSER_FORWARD 167    VK_BROWSER_REFRESH 168    VK_BROWSER_STOP 169    VK_BROWSER_SEARCH 170    VK_BROWSER_FAVORITES 171    VK_BROWSER_HOME 172    VK_VOLUME_MUTE 173 VolumeMute   VK_VOLUME_DOWN 174 VolumeDown   VK_VOLUME_UP 175 VolumeUp   VK_MEDIA_NEXT_TRACK 176    VK_MEDIA_PREV_TRACK 177    VK_MEDIA_STOP 178    VK_MEDIA_PLAY_PAUSE 179    VK_LAUNCH_MAIL 180    VK_LAUNCH_MEDIA_SELECT 181    VK_LAUNCH_APP1 182    VK_LAUNCH_APP2 183    VK_OEM_1 186 ; :   VK_OEM_PLUS 187 = +   VK_OEM_COMMA 188    VK_OEM_MINUS 189 - _   VK_OEM_PERIOD 190    VK_OEM_2 191 / ?   VK_OEM_3 192 ` ~   VK_OEM_4 219 [ {   VK_OEM_5 220 \\ |   VK_OEM_6 221 ] }   VK_OEM_7 222 ' \"   VK_OEM_8 223    VK_OEM_102 226    VK_PACKET 231    VK_PROCESSKEY 229    VK_ATTN 246    VK_CRSEL 247    VK_EXSEL 248    VK_EREOF 249    VK_PLAY 250    VK_ZOOM 251    VK_NONAME 252    VK_PA1 253    VK_OEM_CLEAR 254     鼠标消息 与BUTTON有关 L左键 M中键 R右键\n相关代码\nswitch (pMsg-message) { case WM_LBUTTONDOWN: { AfxMessageBox(L\"客户区鼠标左键点击\"); break; } case WM_NCLBUTTONDOWN: { AfxMessageBox(L\"非客户区鼠标左键点击\"); break; } case WM_LBUTTONDBLCLK: { AfxMessageBox(L\"客户区鼠标左键双击\"); break; } case WM_NCLBUTTONDBLCLK: { AfxMessageBox(L\"非客户区鼠标左键双击\"); break; } case WM_LBUTTONUP: { AfxMessageBox(L\"鼠标左键被释放\"); break; } default: break; } Windows控制台 #include  int main() { DWORD dwCount; HANDLE hStd = GetStdHandle(STD_OUTPUT_HANDLE); SetConsoleTextAttribute(hStd, FOREGROUND_RED | FOREGROUND_BLUE | BACKGROUND_BLUE); WriteConsole(hStd, L\"Hello World!\", wcslen(L\"Hello World!\"), \u0026dwCount, NULL); SetConsoleTitle(L\"Title\"); return 0; } 内存申请与释放 HeapAlloc 内存申请 HeapFree 内存释放\n相关代码\nHANDLE hHeap = GetProcessHeap(); char * str = (char*)HeapAlloc(hHeap, HEAP_ZERO_MEMORY, 0x100); HeapFree(hHeap, 0, str); 文件操作 Win32 查看官方文档学习\n#include  int main() { HANDLE hFile = CreateFile(L\"C:\\\\Users\\\\15890\\\\Desktop\\\\Test.txt\",GENERIC_ALL,NULL,NULL,OPEN_EXISTING,FILE_ATTRIBUTE_NORMAL,NULL); if (INVALID_HANDLE_VALUE == hFile) { MessageBox(0, L\"CreateFile Failed!\", L\"Error\", MB_OK); ExitProcess(0); system(\"pause\"); } DWORD dwFileLen = GetFileSize(hFile, NULL); PTCHAR szBuffer; HANDLE hHeap = GetProcessHeap(); szBuffer = (PTCHAR)HeapAlloc(hHeap, HEAP_ZERO_MEMORY, dwFileLen); DWORD dwReadSize; ReadFile(hFile, szBuffer, dwFileLen,\u0026dwReadSize, NULL); CHAR szWriteBuffer[] = \"Hello Windows API\"; DWORD dwWriteSize; WriteFile(hFile, szWriteBuffer,strlen(szWriteBuffer), \u0026dwWriteSize, NULL); HeapFree(hHeap, 0, szBuffer); CloseHandle(hFile); return 0; } CFile类 官方文档非常详细\nCFile cFile; cFile.Open(L\"C:\\\\Users\\\\15890\\\\Desktop\\\\Test.txt\", CFile::modeReadWrite); DWORD dwFileLen = cFile.GetLength(); PTCHAR szBuffer; HANDLE hHeap = GetProcessHeap(); szBuffer = (PTCHAR)HeapAlloc(hHeap, HEAP_ZERO_MEMORY, dwFileLen); cFile.Read(szBuffer, dwFileLen); CHAR pbufWrite[] = \"Hello CFile\"; cFile.Write(pbufWrite, strlen(pbufWrite)); cFile.Flush(); 消息框 MessageBox Win32\nDWORD ret = MessageBox(L\"Hello World!\", L\"Title\", MB_YESNO); if (ret == IDYES) { MessageBox(L\"Yes\", L\"Tip\", MB_OK); } else if(ret == IDNO) { MessageBox(L\"No\", L\"Tip\", MB_OK); } AfxMessageBox MFC\nDWORD ret = AfxMessageBox(L\"Hello World!\", MB_YESNO); if (ret == IDYES) { AfxMessageBox(L\"Yes\", MB_OK); } else if (ret == IDNO) { AfxMessageBox(L\"No\", MB_OK); } 对话框 模态对话框 会占用主对话框\n相关代码\nvoid CMFCAppModDlg::OnBnClickedButton1() { // TODO: 在此添加控件通知处理程序代码 \tCDialogMod dlg; dlg.DoModal(); } 非模态对话框 不会占用主对话框\n相关代码\nvoid CMFCAppModDlg::OnBnClickedButton2() { // TODO: 在此添加控件通知处理程序代码 \tCDialogModLess* m_Dlg = NULL; if (!m_Dlg) { m_Dlg = new CDialogModLess; m_Dlg-Create(IDD_DIALOG2,this); m_Dlg-ShowWindow(SW_SHOW); } } 通用对话框-文件选择 相关代码\nCFileDialog m_dlg(TRUE, NULL, NULL, NULL, L\"文本文件|*.txt|可执行文件|*.exe|所有文件|*.*||\", this); m_dlg.DoModal(); CString szPath = m_dlg.GetPathName(); if(!szPath.IsEmpty()) AfxMessageBox(szPath); 状态栏 相关代码\nm_StatusBar.Create(this); UINT arr[] = { 1,2,3 }; m_StatusBar.SetIndicators(arr, 3); m_StatusBar.SetPaneInfo(0, arr[0], SBPS_NORMAL, 100); m_StatusBar.SetPaneInfo(1, arr[1], SBPS_NORMAL, 100); m_StatusBar.SetPaneInfo(2, arr[2], SBPS_NORMAL, 100); m_StatusBar.SetPaneText(0, L\"Text1\"); m_StatusBar.SetPaneText(1, L\"Text2\"); m_StatusBar.SetPaneText(2, L\"Text3\"); RepositionBars(AFX_IDW_CONTROLBAR_FIRST, AFX_IDW_CONTROLBAR_LAST, 0); 控件 常用控件\n 单选控件 复选控件 按钮控件 静态文本控件 编辑控件 列表控件 下拉框控件 进度条控件 滑块控件 IP控件 树状控件 tab控件  (可参考微软官方文档进行学习)\ntab控件 初始化\nm_Tab.InsertItem(0, L\"Text\"); m_Tab.InsertItem(1, L\"List\"); m_Tab.InsertItem(2, L\"Tree\"); m_Tab.InsertItem(3, L\"Other\"); m_dlgText.Create(IDD_DIALOG1, \u0026m_Tab); m_dlgList.Create(IDD_DIALOG2, \u0026m_Tab); m_dlgTree.Create(IDD_DIALOG3, \u0026m_Tab); m_dlgOther.Create(IDD_DIALOG4, \u0026m_Tab); CRect rs; m_Tab.GetClientRect(rs); rs.top += 20; m_dlgText.MoveWindow(rs); m_dlgList.MoveWindow(rs); m_dlgTree.MoveWindow(rs); m_dlgOther.MoveWindow(rs); m_dlgText.ShowWindow(SW_SHOW); 使用\nint nCurSel; nCurSel = m_Tab.GetCurSel(); switch (nCurSel) { case 0: { m_dlgText.ShowWindow(SW_SHOW); m_dlgList.ShowWindow(SW_HIDE); m_dlgTree.ShowWindow(SW_HIDE); m_dlgOther.ShowWindow(SW_HIDE); break; } case 1: { m_dlgText.ShowWindow(SW_HIDE); m_dlgList.ShowWindow(SW_SHOW); m_dlgTree.ShowWindow(SW_HIDE); m_dlgOther.ShowWindow(SW_HIDE); break; } case 2: { m_dlgText.ShowWindow(SW_HIDE); m_dlgList.ShowWindow(SW_HIDE); m_dlgTree.ShowWindow(SW_SHOW); m_dlgOther.ShowWindow(SW_HIDE); break; } case 3: { m_dlgText.ShowWindow(SW_HIDE); m_dlgList.ShowWindow(SW_HIDE); m_dlgTree.ShowWindow(SW_HIDE); m_dlgOther.ShowWindow(SW_SHOW); break; } default: break; } 热键 相关代码\n注册\nRegisterHotKey(m_hWnd, HOT_KEY_MESSAGEBOX, MOD_WIN, VK_F2); 使用\nvoid CMFCAppUseDlg::OnHotKey(UINT nHotKeyId, UINT nKey1, UINT nKey2) { // TODO: 在此添加消息处理程序代码和/或调用默认值 \tswitch (nHotKeyId) { case HOT_KEY_MESSAGEBOX: { AfxMessageBox( L\"\\u2764\\u2721\\u262a\\u2600\\u2602\\u2622\\u2648\\u2649\\u264a\\u264b\\u264c\\u264d\" L\"\\u264e\\u264f\\u2650\\u2651\\u2652\\u2653\\u2690\\u2691\\u26c4\\u2620\\u27bc\\u2200\" ); break; } default: break; } CDialogEx::OnHotKey(nHotKeyId, nKey1, nKey2); } ",
  "wordCount" : "1675",
  "inLanguage": "en",
  "datePublished": "2022-02-22T18:30:22+08:00",
  "dateModified": "2022-02-22T18:30:22+08:00",
  "author":{
    "@type": "Person",
    "name": "Me"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.codetea.top/posts/mfc_basic/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "OPdbgBytes",
    "logo": {
      "@type": "ImageObject",
      "url": "https://www.codetea.top/favicon.ico"
    }
  }
}
</script>
  <script>renderMathInElement(document.body);</script>


<link href="https://cdn.bootcdn.net/ajax/libs/highlight.js/11.4.0/styles/atom-one-dark.min.css" rel="stylesheet">
<script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/11.4.0/highlight.min.js"></script>

<script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/11.4.0/languages/armasm.min.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/11.4.0/languages/mipsasm.min.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/11.4.0/languages/wasm.min.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/11.4.0/languages/x86asm.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://www.codetea.top/" accesskey="h" title="OPdbgBytes (Alt + H)">OPdbgBytes</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://www.codetea.top/about" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://www.codetea.top/posts" title="Blog">
                    <span>Blog</span>
                </a>
            </li>
            <li>
                <a href="https://www.codetea.top/link" title="Link">
                    <span>Link</span>
                </a>
            </li>
            <li>
                <a href="https://www.codetea.top/tags" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://www.codetea.top/">Home</a>&nbsp;»&nbsp;<a href="https://www.codetea.top/posts/">Posts</a></div>
    <h1 class="post-title">
      MFC基础 笔记
    </h1>
    <div class="post-meta"><span title='2022-02-22 18:30:22 +0800 CST'>February 22, 2022</span>&nbsp;·&nbsp;8 min&nbsp;·&nbsp;1675 words&nbsp;·&nbsp;Me

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><nav id="TableOfContents">
  <ul>
    <li><a href="#ctime类">CTIME类</a></li>
    <li><a href="#mfc三种开发模式">MFC三种开发模式</a></li>
    <li><a href="#字符串">字符串</a>
      <ul>
        <li><a href="#cstring类">CString类</a></li>
      </ul>
    </li>
    <li><a href="#windows消息基础">Windows消息基础</a>
      <ul>
        <li><a href="#预定义消息">预定义消息</a></li>
        <li><a href="#自定义消息">自定义消息</a></li>
      </ul>
    </li>
    <li><a href="#win32sdk">Win32(SDK)</a></li>
    <li><a href="#键盘消息">键盘消息</a></li>
    <li><a href="#鼠标消息">鼠标消息</a></li>
    <li><a href="#windows控制台">Windows控制台</a></li>
    <li><a href="#内存申请与释放">内存申请与释放</a></li>
    <li><a href="#文件操作">文件操作</a>
      <ul>
        <li><a href="#win32">Win32</a></li>
        <li><a href="#cfile类">CFile类</a></li>
      </ul>
    </li>
    <li><a href="#消息框">消息框</a></li>
    <li><a href="#对话框">对话框</a>
      <ul>
        <li><a href="#模态对话框">模态对话框</a></li>
        <li><a href="#非模态对话框">非模态对话框</a></li>
        <li><a href="#通用对话框-文件选择">通用对话框-文件选择</a></li>
      </ul>
    </li>
    <li><a href="#状态栏">状态栏</a></li>
    <li><a href="#控件">控件</a>
      <ul>
        <li><a href="#tab控件">tab控件</a></li>
        <li><a href="#热键">热键</a></li>
      </ul>
    </li>
  </ul>
</nav>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="mfc">MFC<a hidden class="anchor" aria-hidden="true" href="#mfc">#</a></h1>
<p>默认UNICODE编码</p>
<h2 id="ctime类">CTIME类<a hidden class="anchor" aria-hidden="true" href="#ctime类">#</a></h2>
<p>获取时间的类对象，可以通过类方法获取时间</p>
<p>使用方法</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="n">CTime</span> <span class="n">m_Time</span> <span class="o">=</span> <span class="n">CTime</span><span class="o">::</span><span class="n">GetCurrentTime</span><span class="p">();</span>
<span class="kt">int</span> <span class="n">nYear</span> <span class="o">=</span> <span class="n">m_Time</span><span class="p">.</span><span class="n">GetYear</span><span class="p">();</span>
<span class="kt">int</span> <span class="n">nMonth</span> <span class="o">=</span> <span class="n">m_Time</span><span class="p">.</span><span class="n">GetMonth</span><span class="p">();</span>
<span class="kt">int</span> <span class="n">nDay</span> <span class="o">=</span> <span class="n">m_Time</span><span class="p">.</span><span class="n">GetDay</span><span class="p">();</span>
<span class="kt">int</span> <span class="n">nHour</span> <span class="o">=</span> <span class="n">m_Time</span><span class="p">.</span><span class="n">GetHour</span><span class="p">();</span>
<span class="kt">int</span> <span class="n">nMinute</span> <span class="o">=</span> <span class="n">m_Time</span><span class="p">.</span><span class="n">GetMinute</span><span class="p">();</span>
<span class="kt">int</span> <span class="n">nSecond</span> <span class="o">=</span> <span class="n">m_Time</span><span class="p">.</span><span class="n">GetSecond</span><span class="p">();</span>

</code></pre></div><h2 id="mfc三种开发模式">MFC三种开发模式<a hidden class="anchor" aria-hidden="true" href="#mfc三种开发模式">#</a></h2>
<ol>
<li>SDK &ndash;&gt; Win32</li>
<li>MFC &ndash;&gt; MFC</li>
<li>托管 &ndash;&gt; CLR</li>
</ol>
<h2 id="字符串">字符串<a hidden class="anchor" aria-hidden="true" href="#字符串">#</a></h2>
<p>ASCII <code>char CHAR</code>
UNICODE <code>wchar_t WCHAR</code>
T <code>TCHAR</code></p>
<h3 id="cstring类">CString类<a hidden class="anchor" aria-hidden="true" href="#cstring类">#</a></h3>
<p>定义与初始化</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="n">CString</span> <span class="nf">str</span><span class="p">(</span><span class="sa">L</span><span class="s">&#34;大大大&#34;</span><span class="p">);</span>

<span class="n">CString</span> <span class="n">str1</span><span class="p">;</span>
<span class="n">str1</span> <span class="o">=</span> <span class="sa">L</span><span class="s">&#34;小小小&#34;</span><span class="p">;</span>

<span class="n">CString</span> <span class="n">str2</span> <span class="o">=</span> <span class="n">str1</span><span class="p">;</span>

<span class="n">CString</span> <span class="n">str3</span> <span class="o">=</span> <span class="sa">L</span><span class="sc">&#39;A&#39;</span><span class="p">;</span>

<span class="n">CString</span> <span class="nf">str4</span><span class="p">(</span><span class="sa">L</span><span class="s">&#34;A&#34;</span><span class="p">,</span><span class="mi">66</span><span class="p">);</span>
</code></pre></div><p>格式化字符串</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="n">CString</span> <span class="n">str</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">nFlag</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
<span class="kt">char</span> <span class="n">strz</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&#34;Hello World!&#34;</span><span class="p">;</span>
<span class="n">str</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="sa">L</span><span class="s">&#34;char = %S int = %d&#34;</span><span class="p">,</span> <span class="n">strz</span><span class="p">,</span> <span class="n">nFlag</span><span class="p">);</span>

</code></pre></div><p>字符串长度获取</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="n">str</span><span class="p">.</span><span class="n">GetLength</span><span class="p">();</span>
</code></pre></div><p>判断字符串为空</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="kt">bool</span> <span class="n">flag</span> <span class="o">=</span> <span class="n">str</span><span class="p">.</span><span class="n">IsEmpty</span><span class="p">();</span>
</code></pre></div><p>字符串拼接</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="n">CString</span> <span class="nf">A</span><span class="p">(</span><span class="sa">L</span><span class="s">&#34;A&#34;</span><span class="p">);</span>
<span class="n">CString</span> <span class="nf">B</span><span class="p">(</span><span class="sa">L</span><span class="s">&#34;B&#34;</span><span class="p">);</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">A</span> <span class="o">+</span> <span class="n">B</span><span class="p">;</span>
</code></pre></div><p>切片操作</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="n">CString</span> <span class="nf">A</span><span class="p">(</span><span class="sa">L</span><span class="s">&#34;ABCDEFGH&#34;</span><span class="p">);</span>
<span class="n">CString</span> <span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="p">.</span><span class="n">Left</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="n">CString</span> <span class="n">C</span> <span class="o">=</span> <span class="n">A</span><span class="p">.</span><span class="n">Mid</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="n">CString</span> <span class="n">D</span> <span class="o">=</span> <span class="n">A</span><span class="p">.</span><span class="n">Right</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>

</code></pre></div><p>删除操作</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="n">CString</span> <span class="nf">A</span><span class="p">(</span><span class="sa">L</span><span class="s">&#34;ABCDEFGH&#34;</span><span class="p">);</span>
<span class="n">A</span><span class="p">.</span><span class="n">Remove</span><span class="p">(</span><span class="sa">L</span><span class="s">&#34;A&#34;</span><span class="p">);</span>
</code></pre></div><p>获取字符串</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="n">CString</span> <span class="nf">A</span><span class="p">(</span><span class="sa">L</span><span class="s">&#34;ABCDEFGH&#34;</span><span class="p">);</span>
<span class="n">LPTSTR</span> <span class="n">TSTR</span> <span class="o">=</span> <span class="n">A</span><span class="p">.</span><span class="n">GetBuffer</span><span class="p">();</span>
</code></pre></div><h2 id="windows消息基础">Windows消息基础<a hidden class="anchor" aria-hidden="true" href="#windows消息基础">#</a></h2>
<p>消息的来源</p>
<ul>
<li>由操作系统产生</li>
<li>用户触发事件转换</li>
<li>由另一个消息产生</li>
</ul>
<p>消息的定义</p>
<table>
<thead>
<tr>
<th>前缀</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>WM</td>
<td>普通窗口</td>
</tr>
<tr>
<td>BM</td>
<td>按钮</td>
</tr>
<tr>
<td>CB</td>
<td>组合框</td>
</tr>
<tr>
<td>CDM</td>
<td>通用对话框</td>
</tr>
<tr>
<td>DBT</td>
<td>设备信息</td>
</tr>
<tr>
<td>DL</td>
<td>下拉列表</td>
</tr>
<tr>
<td>EM</td>
<td>编辑框</td>
</tr>
<tr>
<td>HKM</td>
<td>热键</td>
</tr>
<tr>
<td>IPM</td>
<td>IP控件</td>
</tr>
<tr>
<td>LB</td>
<td>列表框</td>
</tr>
<tr>
<td>LVM</td>
<td>列表视图</td>
</tr>
<tr>
<td>MCM</td>
<td>日历控件</td>
</tr>
<tr>
<td>PBM</td>
<td>进度条</td>
</tr>
<tr>
<td>PSM</td>
<td>属性</td>
</tr>
<tr>
<td>RB</td>
<td>伸缩条</td>
</tr>
<tr>
<td>SB</td>
<td>状态栏</td>
</tr>
<tr>
<td>STM</td>
<td>静态栏</td>
</tr>
<tr>
<td>TB</td>
<td>工具条</td>
</tr>
<tr>
<td>TBM</td>
<td>跟踪条</td>
</tr>
<tr>
<td>TCM</td>
<td>标签控件</td>
</tr>
<tr>
<td>TVM</td>
<td>树视图</td>
</tr>
<tr>
<td>UDM</td>
<td>微调按钮控件</td>
</tr>
</tbody>
</table>
<p>MSG结构体</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="k">typedef</span> <span class="k">struct</span> <span class="n">tagMSG</span><span class="p">{</span>
    <span class="n">HWND</span> <span class="n">hwnd</span><span class="p">;</span>
    <span class="n">UINT</span> <span class="n">message</span><span class="p">;</span>
    <span class="n">WPARAM</span> <span class="n">wParam</span><span class="p">;</span>
    <span class="n">LPARAM</span> <span class="n">lParam</span><span class="p">;</span>
    <span class="n">DWORD</span> <span class="n">time</span><span class="p">;</span>
    <span class="n">POINT</span> <span class="n">pt</span><span class="p">;</span>
<span class="cp">#ifdef _MAC
</span><span class="cp"></span>	<span class="n">DWORD</span> <span class="n">lPrivate</span><span class="p">;</span>
<span class="cp">#endif
</span><span class="cp"></span><span class="p">}</span> 	<span class="n">MSG</span><span class="p">,</span> <span class="o">*</span><span class="n">PMSG</span><span class="p">,</span> <span class="n">NEAR</span> <span class="o">*</span><span class="n">NPMSG</span><span class="p">,</span> <span class="n">FAR</span> <span class="o">*</span><span class="n">LPMSG</span><span class="p">;</span>
</code></pre></div><h3 id="预定义消息">预定义消息<a hidden class="anchor" aria-hidden="true" href="#预定义消息">#</a></h3>
<h4 id="窗口消息">窗口消息<a hidden class="anchor" aria-hidden="true" href="#窗口消息">#</a></h4>
<p><code>WM_CREATE</code> 创建窗口
<code>WM_PAINT</code> 绘制窗口
<code>WM_DESTROY</code> 销毁窗口
<code>WM_KILLFOCUS</code> 失去焦点
<code>WM_SETFOCUS</code> 获得焦点
<code>WM_MEASUREITEM</code>
<code>WM_DRAWTEM</code></p>
<p>命令消息
<code>WM_COMMAND</code></p>
<h4 id="控件通知消息">控件通知消息<a hidden class="anchor" aria-hidden="true" href="#控件通知消息">#</a></h4>
<p><code>WM_xxxx</code></p>
<ul>
<li><code>WM_PARENTNOTIFY</code></li>
<li><code>WM_CTLCOLOR</code> &hellip;</li>
<li><code>WM_VSCROLL/WM_HSCROLL</code></li>
</ul>
<p>按钮控件
组合框控件
编辑框控件
列表框控件</p>
<p><code>WM_NOTIFY</code>
控件绘制结构体</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="k">typedef</span> <span class="k">struct</span> <span class="n">tagDRAWITEMSTRUCT</span> <span class="p">{</span>
    <span class="n">UINT</span>        <span class="n">CtlType</span><span class="p">;</span>
    <span class="n">UINT</span>        <span class="n">CtlID</span><span class="p">;</span>
    <span class="n">UINT</span>        <span class="n">itemID</span><span class="p">;</span>
    <span class="n">UINT</span>        <span class="n">itemAction</span><span class="p">;</span>
    <span class="n">UINT</span>        <span class="n">itemState</span><span class="p">;</span>
    <span class="n">HWND</span>        <span class="n">hwndItem</span><span class="p">;</span>
    <span class="n">HDC</span>         <span class="n">hDC</span><span class="p">;</span>
    <span class="n">RECT</span>        <span class="n">rcItem</span><span class="p">;</span>
    <span class="n">ULONG_PTR</span>   <span class="n">itemData</span><span class="p">;</span>
<span class="p">}</span> <span class="n">DRAWITEMSTRUCT</span><span class="p">,</span> <span class="n">NEAR</span> <span class="o">*</span><span class="n">PDRAWITEMSTRUCT</span><span class="p">,</span> <span class="n">FAR</span> <span class="o">*</span><span class="n">LPDRAWITEMSTRUCT</span><span class="p">;</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="k">typedef</span> <span class="k">struct</span> <span class="n">tagNMHDR</span>
<span class="p">{</span>
    <span class="n">HWND</span>      <span class="n">hwndFrom</span><span class="p">;</span>
    <span class="n">UINT_PTR</span>  <span class="n">idFrom</span><span class="p">;</span>
    <span class="n">UINT</span>      <span class="n">code</span><span class="p">;</span>         <span class="c1">// NM_ code
</span><span class="c1"></span><span class="p">}</span>   <span class="n">NMHDR</span><span class="p">;</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="k">typedef</span> <span class="k">struct</span> <span class="n">tagLVKEYDOWN</span>
<span class="p">{</span>
    <span class="n">NMHDR</span> <span class="n">hdr</span><span class="p">;</span>
    <span class="n">WORD</span> <span class="n">wVKey</span><span class="p">;</span>
    <span class="n">UINT</span> <span class="n">flags</span><span class="p">;</span>
<span class="p">}</span> <span class="n">NMLVKEYDOWN</span><span class="p">,</span> <span class="o">*</span><span class="n">LPNMLVKEYDOWN</span><span class="p">;</span>
</code></pre></div><h3 id="自定义消息">自定义消息<a hidden class="anchor" aria-hidden="true" href="#自定义消息">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="cp">#define MY_MSG WM_USER+1
</span></code></pre></div><p>使用方法
<code>SendMessage</code> 同步方式
<code>PostMessage</code> 异步方式</p>
<h2 id="win32sdk">Win32(SDK)<a hidden class="anchor" aria-hidden="true" href="#win32sdk">#</a></h2>
<ol>
<li>WinMain</li>
<li>MSG结构体</li>
<li>注册窗口</li>
<li>创建窗口</li>
<li>显示窗口</li>
<li>刷新窗口</li>
<li>消息循环</li>
<li>WindowProc</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="c1">// WindowsSDK.cpp : 定义应用程序的入口点。
</span><span class="c1">//
</span><span class="c1"></span>
<span class="cp">#include</span> <span class="cpf">&#34;framework.h&#34;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&#34;WindowsSDK.h&#34;</span><span class="cp">
</span><span class="cp"></span>
<span class="cp">#define MAX_LOADSTRING 100
</span><span class="cp"></span>
<span class="c1">// 全局变量:
</span><span class="c1"></span><span class="n">HINSTANCE</span> <span class="n">hInst</span><span class="p">;</span>                                <span class="c1">// 当前实例
</span><span class="c1"></span><span class="n">WCHAR</span> <span class="n">szTitle</span><span class="p">[</span><span class="n">MAX_LOADSTRING</span><span class="p">];</span>                  <span class="c1">// 标题栏文本
</span><span class="c1"></span><span class="n">WCHAR</span> <span class="n">szWindowClass</span><span class="p">[</span><span class="n">MAX_LOADSTRING</span><span class="p">];</span>            <span class="c1">// 主窗口类名
</span><span class="c1"></span>
<span class="c1">// 此代码模块中包含的函数的前向声明:
</span><span class="c1"></span><span class="n">ATOM</span>                <span class="nf">MyRegisterClass</span><span class="p">(</span><span class="n">HINSTANCE</span> <span class="n">hInstance</span><span class="p">);</span>
<span class="n">BOOL</span>                <span class="nf">InitInstance</span><span class="p">(</span><span class="n">HINSTANCE</span><span class="p">,</span> <span class="kt">int</span><span class="p">);</span>
<span class="n">LRESULT</span> <span class="n">CALLBACK</span>    <span class="nf">WndProc</span><span class="p">(</span><span class="n">HWND</span><span class="p">,</span> <span class="n">UINT</span><span class="p">,</span> <span class="n">WPARAM</span><span class="p">,</span> <span class="n">LPARAM</span><span class="p">);</span>
<span class="n">INT_PTR</span> <span class="n">CALLBACK</span>    <span class="nf">About</span><span class="p">(</span><span class="n">HWND</span><span class="p">,</span> <span class="n">UINT</span><span class="p">,</span> <span class="n">WPARAM</span><span class="p">,</span> <span class="n">LPARAM</span><span class="p">);</span>

<span class="kt">int</span> <span class="n">APIENTRY</span> <span class="nf">wWinMain</span><span class="p">(</span><span class="n">_In_</span> <span class="n">HINSTANCE</span> <span class="n">hInstance</span><span class="p">,</span>
                     <span class="n">_In_opt_</span> <span class="n">HINSTANCE</span> <span class="n">hPrevInstance</span><span class="p">,</span>
                     <span class="n">_In_</span> <span class="n">LPWSTR</span>    <span class="n">lpCmdLine</span><span class="p">,</span>
                     <span class="n">_In_</span> <span class="kt">int</span>       <span class="n">nCmdShow</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">UNREFERENCED_PARAMETER</span><span class="p">(</span><span class="n">hPrevInstance</span><span class="p">);</span>
    <span class="n">UNREFERENCED_PARAMETER</span><span class="p">(</span><span class="n">lpCmdLine</span><span class="p">);</span>

    <span class="c1">// TODO: 在此处放置代码。
</span><span class="c1"></span>
    <span class="c1">// 初始化全局字符串
</span><span class="c1"></span>    <span class="n">LoadStringW</span><span class="p">(</span><span class="n">hInstance</span><span class="p">,</span> <span class="n">IDS_APP_TITLE</span><span class="p">,</span> <span class="n">szTitle</span><span class="p">,</span> <span class="n">MAX_LOADSTRING</span><span class="p">);</span>
    <span class="n">LoadStringW</span><span class="p">(</span><span class="n">hInstance</span><span class="p">,</span> <span class="n">IDC_WINDOWSSDK</span><span class="p">,</span> <span class="n">szWindowClass</span><span class="p">,</span> <span class="n">MAX_LOADSTRING</span><span class="p">);</span>
    <span class="n">MyRegisterClass</span><span class="p">(</span><span class="n">hInstance</span><span class="p">);</span>

    <span class="c1">// 执行应用程序初始化:
</span><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">InitInstance</span> <span class="p">(</span><span class="n">hInstance</span><span class="p">,</span> <span class="n">nCmdShow</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">FALSE</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">HACCEL</span> <span class="n">hAccelTable</span> <span class="o">=</span> <span class="n">LoadAccelerators</span><span class="p">(</span><span class="n">hInstance</span><span class="p">,</span> <span class="n">MAKEINTRESOURCE</span><span class="p">(</span><span class="n">IDC_WINDOWSSDK</span><span class="p">));</span>

    <span class="n">MSG</span> <span class="n">msg</span><span class="p">;</span>

    <span class="c1">// 主消息循环:
</span><span class="c1"></span>    <span class="k">while</span> <span class="p">(</span><span class="n">GetMessage</span><span class="p">(</span><span class="o">&amp;</span><span class="n">msg</span><span class="p">,</span> <span class="k">nullptr</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">TranslateAccelerator</span><span class="p">(</span><span class="n">msg</span><span class="p">.</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">hAccelTable</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">msg</span><span class="p">))</span>
        <span class="p">{</span>
            <span class="n">TranslateMessage</span><span class="p">(</span><span class="o">&amp;</span><span class="n">msg</span><span class="p">);</span>
            <span class="n">DispatchMessage</span><span class="p">(</span><span class="o">&amp;</span><span class="n">msg</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="n">msg</span><span class="p">.</span><span class="n">wParam</span><span class="p">;</span>
<span class="p">}</span>



<span class="c1">//
</span><span class="c1">//  函数: MyRegisterClass()
</span><span class="c1">//
</span><span class="c1">//  目标: 注册窗口类。
</span><span class="c1">//
</span><span class="c1"></span><span class="n">ATOM</span> <span class="nf">MyRegisterClass</span><span class="p">(</span><span class="n">HINSTANCE</span> <span class="n">hInstance</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">WNDCLASSEXW</span> <span class="n">wcex</span><span class="p">;</span>

    <span class="n">wcex</span><span class="p">.</span><span class="n">cbSize</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">WNDCLASSEX</span><span class="p">);</span>

    <span class="n">wcex</span><span class="p">.</span><span class="n">style</span>          <span class="o">=</span> <span class="n">CS_HREDRAW</span> <span class="o">|</span> <span class="n">CS_VREDRAW</span><span class="p">;</span>
    <span class="n">wcex</span><span class="p">.</span><span class="n">lpfnWndProc</span>    <span class="o">=</span> <span class="n">WndProc</span><span class="p">;</span>
    <span class="n">wcex</span><span class="p">.</span><span class="n">cbClsExtra</span>     <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">wcex</span><span class="p">.</span><span class="n">cbWndExtra</span>     <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">wcex</span><span class="p">.</span><span class="n">hInstance</span>      <span class="o">=</span> <span class="n">hInstance</span><span class="p">;</span>
    <span class="n">wcex</span><span class="p">.</span><span class="n">hIcon</span>          <span class="o">=</span> <span class="n">LoadIcon</span><span class="p">(</span><span class="n">hInstance</span><span class="p">,</span> <span class="n">MAKEINTRESOURCE</span><span class="p">(</span><span class="n">IDI_WINDOWSSDK</span><span class="p">));</span>
    <span class="n">wcex</span><span class="p">.</span><span class="n">hCursor</span>        <span class="o">=</span> <span class="n">LoadCursor</span><span class="p">(</span><span class="k">nullptr</span><span class="p">,</span> <span class="n">IDC_ARROW</span><span class="p">);</span>
    <span class="n">wcex</span><span class="p">.</span><span class="n">hbrBackground</span>  <span class="o">=</span> <span class="p">(</span><span class="n">HBRUSH</span><span class="p">)(</span><span class="n">COLOR_WINDOW</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
    <span class="n">wcex</span><span class="p">.</span><span class="n">lpszMenuName</span>   <span class="o">=</span> <span class="n">MAKEINTRESOURCEW</span><span class="p">(</span><span class="n">IDC_WINDOWSSDK</span><span class="p">);</span>
    <span class="n">wcex</span><span class="p">.</span><span class="n">lpszClassName</span>  <span class="o">=</span> <span class="n">szWindowClass</span><span class="p">;</span>
    <span class="n">wcex</span><span class="p">.</span><span class="n">hIconSm</span>        <span class="o">=</span> <span class="n">LoadIcon</span><span class="p">(</span><span class="n">wcex</span><span class="p">.</span><span class="n">hInstance</span><span class="p">,</span> <span class="n">MAKEINTRESOURCE</span><span class="p">(</span><span class="n">IDI_SMALL</span><span class="p">));</span>

    <span class="k">return</span> <span class="n">RegisterClassExW</span><span class="p">(</span><span class="o">&amp;</span><span class="n">wcex</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">//
</span><span class="c1">//   函数: InitInstance(HINSTANCE, int)
</span><span class="c1">//
</span><span class="c1">//   目标: 保存实例句柄并创建主窗口
</span><span class="c1">//
</span><span class="c1">//   注释:
</span><span class="c1">//
</span><span class="c1">//        在此函数中，我们在全局变量中保存实例句柄并
</span><span class="c1">//        创建和显示主程序窗口。
</span><span class="c1">//
</span><span class="c1"></span><span class="n">BOOL</span> <span class="nf">InitInstance</span><span class="p">(</span><span class="n">HINSTANCE</span> <span class="n">hInstance</span><span class="p">,</span> <span class="kt">int</span> <span class="n">nCmdShow</span><span class="p">)</span>
<span class="p">{</span>
   <span class="n">hInst</span> <span class="o">=</span> <span class="n">hInstance</span><span class="p">;</span> <span class="c1">// 将实例句柄存储在全局变量中
</span><span class="c1"></span>
   <span class="n">HWND</span> <span class="n">hWnd</span> <span class="o">=</span> <span class="n">CreateWindowW</span><span class="p">(</span><span class="n">szWindowClass</span><span class="p">,</span> <span class="n">szTitle</span><span class="p">,</span> <span class="n">WS_OVERLAPPEDWINDOW</span><span class="p">,</span>
      <span class="n">CW_USEDEFAULT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">CW_USEDEFAULT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">nullptr</span><span class="p">,</span> <span class="k">nullptr</span><span class="p">,</span> <span class="n">hInstance</span><span class="p">,</span> <span class="k">nullptr</span><span class="p">);</span>

   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">hWnd</span><span class="p">)</span>
   <span class="p">{</span>
      <span class="k">return</span> <span class="n">FALSE</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="n">ShowWindow</span><span class="p">(</span><span class="n">hWnd</span><span class="p">,</span> <span class="n">nCmdShow</span><span class="p">);</span>
   <span class="n">UpdateWindow</span><span class="p">(</span><span class="n">hWnd</span><span class="p">);</span>

   <span class="k">return</span> <span class="n">TRUE</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">//
</span><span class="c1">//  函数: WndProc(HWND, UINT, WPARAM, LPARAM)
</span><span class="c1">//
</span><span class="c1">//  目标: 处理主窗口的消息。
</span><span class="c1">//
</span><span class="c1">//  WM_COMMAND  - 处理应用程序菜单
</span><span class="c1">//  WM_PAINT    - 绘制主窗口
</span><span class="c1">//  WM_DESTROY  - 发送退出消息并返回
</span><span class="c1">//
</span><span class="c1">//
</span><span class="c1"></span><span class="n">LRESULT</span> <span class="n">CALLBACK</span> <span class="nf">WndProc</span><span class="p">(</span><span class="n">HWND</span> <span class="n">hWnd</span><span class="p">,</span> <span class="n">UINT</span> <span class="n">message</span><span class="p">,</span> <span class="n">WPARAM</span> <span class="n">wParam</span><span class="p">,</span> <span class="n">LPARAM</span> <span class="n">lParam</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">switch</span> <span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="p">{</span>
    <span class="k">case</span> <span class="nl">WM_COMMAND</span><span class="p">:</span>
        <span class="p">{</span>
            <span class="kt">int</span> <span class="n">wmId</span> <span class="o">=</span> <span class="n">LOWORD</span><span class="p">(</span><span class="n">wParam</span><span class="p">);</span>
            <span class="c1">// 分析菜单选择:
</span><span class="c1"></span>            <span class="k">switch</span> <span class="p">(</span><span class="n">wmId</span><span class="p">)</span>
            <span class="p">{</span>
            <span class="k">case</span> <span class="nl">IDM_ABOUT</span><span class="p">:</span>
                <span class="n">DialogBox</span><span class="p">(</span><span class="n">hInst</span><span class="p">,</span> <span class="n">MAKEINTRESOURCE</span><span class="p">(</span><span class="n">IDD_ABOUTBOX</span><span class="p">),</span> <span class="n">hWnd</span><span class="p">,</span> <span class="n">About</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="nl">IDM_EXIT</span><span class="p">:</span>
                <span class="n">DestroyWindow</span><span class="p">(</span><span class="n">hWnd</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">default</span><span class="o">:</span>
                <span class="k">return</span> <span class="n">DefWindowProc</span><span class="p">(</span><span class="n">hWnd</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">wParam</span><span class="p">,</span> <span class="n">lParam</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="nl">WM_PAINT</span><span class="p">:</span>
        <span class="p">{</span>
            <span class="n">PAINTSTRUCT</span> <span class="n">ps</span><span class="p">;</span>
            <span class="n">HDC</span> <span class="n">hdc</span> <span class="o">=</span> <span class="n">BeginPaint</span><span class="p">(</span><span class="n">hWnd</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ps</span><span class="p">);</span>
            <span class="c1">// TODO: 在此处添加使用 hdc 的任何绘图代码...
</span><span class="c1"></span>            <span class="n">EndPaint</span><span class="p">(</span><span class="n">hWnd</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ps</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="nl">WM_DESTROY</span><span class="p">:</span>
        <span class="n">PostQuitMessage</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="k">default</span><span class="o">:</span>
        <span class="k">return</span> <span class="n">DefWindowProc</span><span class="p">(</span><span class="n">hWnd</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">wParam</span><span class="p">,</span> <span class="n">lParam</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// “关于”框的消息处理程序。
</span><span class="c1"></span><span class="n">INT_PTR</span> <span class="n">CALLBACK</span> <span class="nf">About</span><span class="p">(</span><span class="n">HWND</span> <span class="n">hDlg</span><span class="p">,</span> <span class="n">UINT</span> <span class="n">message</span><span class="p">,</span> <span class="n">WPARAM</span> <span class="n">wParam</span><span class="p">,</span> <span class="n">LPARAM</span> <span class="n">lParam</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">UNREFERENCED_PARAMETER</span><span class="p">(</span><span class="n">lParam</span><span class="p">);</span>
    <span class="k">switch</span> <span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="p">{</span>
    <span class="k">case</span> <span class="nl">WM_INITDIALOG</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">INT_PTR</span><span class="p">)</span><span class="n">TRUE</span><span class="p">;</span>

    <span class="k">case</span> <span class="nl">WM_COMMAND</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">LOWORD</span><span class="p">(</span><span class="n">wParam</span><span class="p">)</span> <span class="o">==</span> <span class="n">IDOK</span> <span class="o">||</span> <span class="n">LOWORD</span><span class="p">(</span><span class="n">wParam</span><span class="p">)</span> <span class="o">==</span> <span class="n">IDCANCEL</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">EndDialog</span><span class="p">(</span><span class="n">hDlg</span><span class="p">,</span> <span class="n">LOWORD</span><span class="p">(</span><span class="n">wParam</span><span class="p">));</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">INT_PTR</span><span class="p">)</span><span class="n">TRUE</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">INT_PTR</span><span class="p">)</span><span class="n">FALSE</span><span class="p">;</span>
<span class="p">}</span>

</code></pre></div><h2 id="键盘消息">键盘消息<a hidden class="anchor" aria-hidden="true" href="#键盘消息">#</a></h2>
<p>与key有关的</p>
<p>相关代码</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="n">BOOL</span> <span class="n">CMFCKeyDlg</span><span class="o">::</span><span class="n">PreTranslateMessage</span><span class="p">(</span><span class="n">MSG</span><span class="o">*</span> <span class="n">pMsg</span><span class="p">)</span>
<span class="p">{</span>
	<span class="c1">// TODO: 在此添加专用代码和/或调用基类
</span><span class="c1"></span>	<span class="n">SHORT</span> <span class="n">nShift</span> <span class="o">=</span> <span class="n">GetKeyState</span><span class="p">(</span><span class="n">VK_SHIFT</span><span class="p">);</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">pMsg</span><span class="o">-&gt;</span><span class="n">message</span><span class="p">)</span>
	<span class="p">{</span>
	<span class="k">case</span> <span class="nl">WM_KEYDOWN</span><span class="p">:</span>
	<span class="p">{</span>

		<span class="k">switch</span> <span class="p">(</span><span class="n">pMsg</span><span class="o">-&gt;</span><span class="n">wParam</span><span class="p">)</span>
		<span class="p">{</span>
		<span class="k">case</span> <span class="nl">VK_F2</span><span class="p">:</span>
		<span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">nShift</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="n">AfxMessageBox</span><span class="p">(</span><span class="sa">L</span><span class="s">&#34;F2 + shift Message!&#34;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="n">AfxMessageBox</span><span class="p">(</span><span class="sa">L</span><span class="s">&#34;F2 Message!&#34;</span><span class="p">);</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">case</span> <span class="mh">0x41</span><span class="o">:</span>
		<span class="p">{</span>
			<span class="n">AfxMessageBox</span><span class="p">(</span><span class="sa">L</span><span class="s">&#34;A Message!&#34;</span><span class="p">);</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">case</span> <span class="nl">VK_ESCAPE</span><span class="p">:</span>
			<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">case</span> <span class="nl">VK_RETURN</span><span class="p">:</span>
			<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">default</span><span class="o">:</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
			
	<span class="k">default</span><span class="o">:</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">CDialogEx</span><span class="o">::</span><span class="n">PreTranslateMessage</span><span class="p">(</span><span class="n">pMsg</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div><p>虚拟键码</p>
<ul>
<li><code>VK_xxx</code></li>
<li>ASCII码</li>
</ul>
<p>虚拟键码表</p>
<table>
<thead>
<tr>
<th>虚拟键码</th>
<th>对应值</th>
<th>对应键</th>
</tr>
</thead>
<tbody>
<tr>
<td>VK_LBUTTON</td>
<td>1</td>
<td>鼠标左键</td>
</tr>
<tr>
<td>VK_RBUTTON</td>
<td>2</td>
<td>鼠标右键</td>
</tr>
<tr>
<td>VK_CANCEL</td>
<td>3</td>
<td>Cancel</td>
</tr>
<tr>
<td>VK_MBUTTON</td>
<td>4</td>
<td>鼠标中键</td>
</tr>
<tr>
<td>VK_XBUTTON1</td>
<td>5</td>
<td></td>
</tr>
<tr>
<td>VK_XBUTTON2</td>
<td>6</td>
<td></td>
</tr>
<tr>
<td>VK_BACK</td>
<td>8</td>
<td>Backspace</td>
</tr>
<tr>
<td>VK_TAB</td>
<td>9</td>
<td>Tab</td>
</tr>
<tr>
<td>VK_CLEAR</td>
<td>12</td>
<td>Clear</td>
</tr>
<tr>
<td>VK_RETURN</td>
<td>13</td>
<td>Enter</td>
</tr>
<tr>
<td>VK_SHIFT</td>
<td>16</td>
<td>Shift</td>
</tr>
<tr>
<td>VK_CONTROL</td>
<td>17</td>
<td>Ctrl</td>
</tr>
<tr>
<td>VK_MENU</td>
<td>18</td>
<td>Alt</td>
</tr>
<tr>
<td>VK_PAUSE</td>
<td>19</td>
<td>Pause</td>
</tr>
<tr>
<td>VK_CAPITAL</td>
<td>20</td>
<td>Caps Lock</td>
</tr>
<tr>
<td>VK_KANA</td>
<td>21</td>
<td></td>
</tr>
<tr>
<td>VK_HANGUL</td>
<td>21</td>
<td></td>
</tr>
<tr>
<td>VK_JUNJA</td>
<td>23</td>
<td></td>
</tr>
<tr>
<td>VK_FINAL</td>
<td>24</td>
<td></td>
</tr>
<tr>
<td>VK_HANJA</td>
<td>25</td>
<td></td>
</tr>
<tr>
<td>VK_KANJI</td>
<td>25*</td>
<td></td>
</tr>
<tr>
<td>VK_ESCAPE</td>
<td>27</td>
<td>Esc</td>
</tr>
<tr>
<td>VK_CONVERT</td>
<td>28</td>
<td></td>
</tr>
<tr>
<td>VK_NONCONVERT</td>
<td>29</td>
<td></td>
</tr>
<tr>
<td>VK_ACCEPT</td>
<td>30</td>
<td></td>
</tr>
<tr>
<td>VK_MODECHANGE</td>
<td>31</td>
<td></td>
</tr>
<tr>
<td>VK_SPACE</td>
<td>32</td>
<td>Space</td>
</tr>
<tr>
<td>VK_PRIOR</td>
<td>33</td>
<td>Page Up</td>
</tr>
<tr>
<td>VK_NEXT</td>
<td>34</td>
<td>Page Down</td>
</tr>
<tr>
<td>VK_END</td>
<td>35</td>
<td>End</td>
</tr>
<tr>
<td>VK_HOME</td>
<td>36</td>
<td>Home</td>
</tr>
<tr>
<td>VK_LEFT</td>
<td>37</td>
<td>Left Arrow</td>
</tr>
<tr>
<td>VK_UP</td>
<td>38</td>
<td>Up Arrow</td>
</tr>
<tr>
<td>VK_RIGHT</td>
<td>39</td>
<td>Right Arrow</td>
</tr>
<tr>
<td>VK_DOWN</td>
<td>40</td>
<td>Down Arrow</td>
</tr>
<tr>
<td>VK_SELECT</td>
<td>41</td>
<td>Select</td>
</tr>
<tr>
<td>VK_PRINT</td>
<td>42</td>
<td>Print</td>
</tr>
<tr>
<td>VK_EXECUTE</td>
<td>43</td>
<td>Execute</td>
</tr>
<tr>
<td>VK_SNAPSHOT</td>
<td>44</td>
<td>Snapshot</td>
</tr>
<tr>
<td>VK_INSERT</td>
<td>45</td>
<td>Insert</td>
</tr>
<tr>
<td>VK_DELETE</td>
<td>46</td>
<td>Delete</td>
</tr>
<tr>
<td>VK_HELP</td>
<td>47</td>
<td>Help</td>
</tr>
<tr>
<td></td>
<td>48</td>
<td>0</td>
</tr>
<tr>
<td></td>
<td>49</td>
<td>1</td>
</tr>
<tr>
<td></td>
<td>50</td>
<td>2</td>
</tr>
<tr>
<td></td>
<td>51</td>
<td>3</td>
</tr>
<tr>
<td></td>
<td>52</td>
<td>4</td>
</tr>
<tr>
<td></td>
<td>53</td>
<td>5</td>
</tr>
<tr>
<td></td>
<td>54</td>
<td>6</td>
</tr>
<tr>
<td></td>
<td>55</td>
<td>7</td>
</tr>
<tr>
<td></td>
<td>56</td>
<td>8</td>
</tr>
<tr>
<td></td>
<td>57</td>
<td>9</td>
</tr>
<tr>
<td></td>
<td>65</td>
<td>A</td>
</tr>
<tr>
<td></td>
<td>66</td>
<td>B</td>
</tr>
<tr>
<td></td>
<td>67</td>
<td>C</td>
</tr>
<tr>
<td></td>
<td>68</td>
<td>D</td>
</tr>
<tr>
<td></td>
<td>69</td>
<td>E</td>
</tr>
<tr>
<td></td>
<td>70</td>
<td>F</td>
</tr>
<tr>
<td></td>
<td>71</td>
<td>G</td>
</tr>
<tr>
<td></td>
<td>72</td>
<td>H</td>
</tr>
<tr>
<td></td>
<td>73</td>
<td>I</td>
</tr>
<tr>
<td></td>
<td>74</td>
<td>J</td>
</tr>
<tr>
<td></td>
<td>75</td>
<td>K</td>
</tr>
<tr>
<td></td>
<td>76</td>
<td>L</td>
</tr>
<tr>
<td></td>
<td>77</td>
<td>M</td>
</tr>
<tr>
<td></td>
<td>78</td>
<td>N</td>
</tr>
<tr>
<td></td>
<td>79</td>
<td>O</td>
</tr>
<tr>
<td></td>
<td>80</td>
<td>P</td>
</tr>
<tr>
<td></td>
<td>81</td>
<td>Q</td>
</tr>
<tr>
<td></td>
<td>82</td>
<td>R</td>
</tr>
<tr>
<td></td>
<td>83</td>
<td>S</td>
</tr>
<tr>
<td></td>
<td>84</td>
<td>T</td>
</tr>
<tr>
<td></td>
<td>85</td>
<td>U</td>
</tr>
<tr>
<td></td>
<td>86</td>
<td>V</td>
</tr>
<tr>
<td></td>
<td>87</td>
<td>W</td>
</tr>
<tr>
<td></td>
<td>88</td>
<td>X</td>
</tr>
<tr>
<td></td>
<td>89</td>
<td>Y</td>
</tr>
<tr>
<td></td>
<td>90</td>
<td>Z</td>
</tr>
<tr>
<td>VK_LWIN</td>
<td>91</td>
<td></td>
</tr>
<tr>
<td>VK_RWIN</td>
<td>92</td>
<td></td>
</tr>
<tr>
<td>VK_APPS</td>
<td>93</td>
<td></td>
</tr>
<tr>
<td>VK_SLEEP</td>
<td>95</td>
<td></td>
</tr>
<tr>
<td>VK_NUMPAD0</td>
<td>96</td>
<td>小键盘 0</td>
</tr>
<tr>
<td>VK_NUMPAD1</td>
<td>97</td>
<td>小键盘 1</td>
</tr>
<tr>
<td>VK_NUMPAD2</td>
<td>98</td>
<td>小键盘 2</td>
</tr>
<tr>
<td>VK_NUMPAD3</td>
<td>99</td>
<td>小键盘 3</td>
</tr>
<tr>
<td>VK_NUMPAD4</td>
<td>100</td>
<td>小键盘 4</td>
</tr>
<tr>
<td>VK_NUMPAD5</td>
<td>101</td>
<td>小键盘 5</td>
</tr>
<tr>
<td>VK_NUMPAD6</td>
<td>102</td>
<td>小键盘 6</td>
</tr>
<tr>
<td>VK_NUMPAD7</td>
<td>103</td>
<td>小键盘 7</td>
</tr>
<tr>
<td>VK_NUMPAD8</td>
<td>104</td>
<td>小键盘 8</td>
</tr>
<tr>
<td>VK_NUMPAD9</td>
<td>105</td>
<td>小键盘 9</td>
</tr>
<tr>
<td>VK_MULTIPLY</td>
<td>106</td>
<td>小键盘 *</td>
</tr>
<tr>
<td>VK_ADD</td>
<td>107</td>
<td>小键盘 +</td>
</tr>
<tr>
<td>VK_SEPARATOR</td>
<td>108</td>
<td>小键盘 Enter</td>
</tr>
<tr>
<td>VK_SUBTRACT</td>
<td>109</td>
<td>小键盘 -</td>
</tr>
<tr>
<td>VK_DECIMAL</td>
<td>110</td>
<td>小键盘 .</td>
</tr>
<tr>
<td>VK_DIVIDE</td>
<td>111</td>
<td>小键盘 /</td>
</tr>
<tr>
<td>VK_F1</td>
<td>112</td>
<td>F1</td>
</tr>
<tr>
<td>VK_F2</td>
<td>113</td>
<td>F2</td>
</tr>
<tr>
<td>VK_F3</td>
<td>114</td>
<td>F3</td>
</tr>
<tr>
<td>VK_F4</td>
<td>115</td>
<td>F4</td>
</tr>
<tr>
<td>VK_F5</td>
<td>116</td>
<td>F5</td>
</tr>
<tr>
<td>VK_F6</td>
<td>117</td>
<td>F6</td>
</tr>
<tr>
<td>VK_F7</td>
<td>118</td>
<td>F7</td>
</tr>
<tr>
<td>VK_F8</td>
<td>119</td>
<td>F8</td>
</tr>
<tr>
<td>VK_F9</td>
<td>120</td>
<td>F9</td>
</tr>
<tr>
<td>VK_F10</td>
<td>121</td>
<td>F10</td>
</tr>
<tr>
<td>VK_F11</td>
<td>122</td>
<td>F11</td>
</tr>
<tr>
<td>VK_F12</td>
<td>123</td>
<td>F12</td>
</tr>
<tr>
<td>VK_F13</td>
<td>124</td>
<td></td>
</tr>
<tr>
<td>VK_F14</td>
<td>125</td>
<td></td>
</tr>
<tr>
<td>VK_F15</td>
<td>126</td>
<td></td>
</tr>
<tr>
<td>VK_F16</td>
<td>127</td>
<td></td>
</tr>
<tr>
<td>VK_F17</td>
<td>128</td>
<td></td>
</tr>
<tr>
<td>VK_F18</td>
<td>129</td>
<td></td>
</tr>
<tr>
<td>VK_F19</td>
<td>130</td>
<td></td>
</tr>
<tr>
<td>VK_F20</td>
<td>131</td>
<td></td>
</tr>
<tr>
<td>VK_F21</td>
<td>132</td>
<td></td>
</tr>
<tr>
<td>VK_F22</td>
<td>133</td>
<td></td>
</tr>
<tr>
<td>VK_F23</td>
<td>134</td>
<td></td>
</tr>
<tr>
<td>VK_F24</td>
<td>135</td>
<td></td>
</tr>
<tr>
<td>VK_NUMLOCK</td>
<td>144</td>
<td>Num Lock</td>
</tr>
<tr>
<td>VK_SCROLL</td>
<td>145</td>
<td>Scroll</td>
</tr>
<tr>
<td>VK_LSHIFT</td>
<td>160</td>
<td></td>
</tr>
<tr>
<td>VK_RSHIFT</td>
<td>161</td>
<td></td>
</tr>
<tr>
<td>VK_LCONTROL</td>
<td>162</td>
<td></td>
</tr>
<tr>
<td>VK_RCONTROL</td>
<td>163</td>
<td></td>
</tr>
<tr>
<td>VK_LMENU</td>
<td>164</td>
<td></td>
</tr>
<tr>
<td>VK_RMENU</td>
<td>165</td>
<td></td>
</tr>
<tr>
<td>VK_BROWSER_BACK</td>
<td>166</td>
<td></td>
</tr>
<tr>
<td>VK_BROWSER_FORWARD</td>
<td>167</td>
<td></td>
</tr>
<tr>
<td>VK_BROWSER_REFRESH</td>
<td>168</td>
<td></td>
</tr>
<tr>
<td>VK_BROWSER_STOP</td>
<td>169</td>
<td></td>
</tr>
<tr>
<td>VK_BROWSER_SEARCH</td>
<td>170</td>
<td></td>
</tr>
<tr>
<td>VK_BROWSER_FAVORITES</td>
<td>171</td>
<td></td>
</tr>
<tr>
<td>VK_BROWSER_HOME</td>
<td>172</td>
<td></td>
</tr>
<tr>
<td>VK_VOLUME_MUTE</td>
<td>173</td>
<td>VolumeMute</td>
</tr>
<tr>
<td>VK_VOLUME_DOWN</td>
<td>174</td>
<td>VolumeDown</td>
</tr>
<tr>
<td>VK_VOLUME_UP</td>
<td>175</td>
<td>VolumeUp</td>
</tr>
<tr>
<td>VK_MEDIA_NEXT_TRACK</td>
<td>176</td>
<td></td>
</tr>
<tr>
<td>VK_MEDIA_PREV_TRACK</td>
<td>177</td>
<td></td>
</tr>
<tr>
<td>VK_MEDIA_STOP</td>
<td>178</td>
<td></td>
</tr>
<tr>
<td>VK_MEDIA_PLAY_PAUSE</td>
<td>179</td>
<td></td>
</tr>
<tr>
<td>VK_LAUNCH_MAIL</td>
<td>180</td>
<td></td>
</tr>
<tr>
<td>VK_LAUNCH_MEDIA_SELECT</td>
<td>181</td>
<td></td>
</tr>
<tr>
<td>VK_LAUNCH_APP1</td>
<td>182</td>
<td></td>
</tr>
<tr>
<td>VK_LAUNCH_APP2</td>
<td>183</td>
<td></td>
</tr>
<tr>
<td>VK_OEM_1</td>
<td>186</td>
<td>; :</td>
</tr>
<tr>
<td>VK_OEM_PLUS</td>
<td>187</td>
<td>= +</td>
</tr>
<tr>
<td>VK_OEM_COMMA</td>
<td>188</td>
<td></td>
</tr>
<tr>
<td>VK_OEM_MINUS</td>
<td>189</td>
<td>- _</td>
</tr>
<tr>
<td>VK_OEM_PERIOD</td>
<td>190</td>
<td></td>
</tr>
<tr>
<td>VK_OEM_2</td>
<td>191</td>
<td>/ ?</td>
</tr>
<tr>
<td>VK_OEM_3</td>
<td>192</td>
<td>` ~</td>
</tr>
<tr>
<td>VK_OEM_4</td>
<td>219</td>
<td>[ {</td>
</tr>
<tr>
<td>VK_OEM_5</td>
<td>220</td>
<td>\ |</td>
</tr>
<tr>
<td>VK_OEM_6</td>
<td>221</td>
<td>] }</td>
</tr>
<tr>
<td>VK_OEM_7</td>
<td>222</td>
<td>' &quot;</td>
</tr>
<tr>
<td>VK_OEM_8</td>
<td>223</td>
<td></td>
</tr>
<tr>
<td>VK_OEM_102</td>
<td>226</td>
<td></td>
</tr>
<tr>
<td>VK_PACKET</td>
<td>231</td>
<td></td>
</tr>
<tr>
<td>VK_PROCESSKEY</td>
<td>229</td>
<td></td>
</tr>
<tr>
<td>VK_ATTN</td>
<td>246</td>
<td></td>
</tr>
<tr>
<td>VK_CRSEL</td>
<td>247</td>
<td></td>
</tr>
<tr>
<td>VK_EXSEL</td>
<td>248</td>
<td></td>
</tr>
<tr>
<td>VK_EREOF</td>
<td>249</td>
<td></td>
</tr>
<tr>
<td>VK_PLAY</td>
<td>250</td>
<td></td>
</tr>
<tr>
<td>VK_ZOOM</td>
<td>251</td>
<td></td>
</tr>
<tr>
<td>VK_NONAME</td>
<td>252</td>
<td></td>
</tr>
<tr>
<td>VK_PA1</td>
<td>253</td>
<td></td>
</tr>
<tr>
<td>VK_OEM_CLEAR</td>
<td>254</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="鼠标消息">鼠标消息<a hidden class="anchor" aria-hidden="true" href="#鼠标消息">#</a></h2>
<p>与BUTTON有关
L左键
M中键
R右键</p>
<p>相关代码</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="k">switch</span> <span class="p">(</span><span class="n">pMsg</span><span class="o">-&gt;</span><span class="n">message</span><span class="p">)</span>
	<span class="p">{</span>
	<span class="k">case</span> <span class="nl">WM_LBUTTONDOWN</span><span class="p">:</span>
	<span class="p">{</span>
		<span class="n">AfxMessageBox</span><span class="p">(</span><span class="sa">L</span><span class="s">&#34;客户区鼠标左键点击&#34;</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">case</span> <span class="nl">WM_NCLBUTTONDOWN</span><span class="p">:</span>
	<span class="p">{</span>
		<span class="n">AfxMessageBox</span><span class="p">(</span><span class="sa">L</span><span class="s">&#34;非客户区鼠标左键点击&#34;</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">case</span> <span class="nl">WM_LBUTTONDBLCLK</span><span class="p">:</span>
	<span class="p">{</span>
		<span class="n">AfxMessageBox</span><span class="p">(</span><span class="sa">L</span><span class="s">&#34;客户区鼠标左键双击&#34;</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">case</span> <span class="nl">WM_NCLBUTTONDBLCLK</span><span class="p">:</span>
	<span class="p">{</span>
		<span class="n">AfxMessageBox</span><span class="p">(</span><span class="sa">L</span><span class="s">&#34;非客户区鼠标左键双击&#34;</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">case</span> <span class="nl">WM_LBUTTONUP</span><span class="p">:</span>
	<span class="p">{</span>
		<span class="n">AfxMessageBox</span><span class="p">(</span><span class="sa">L</span><span class="s">&#34;鼠标左键被释放&#34;</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">default</span><span class="o">:</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>

</code></pre></div><h2 id="windows控制台">Windows控制台<a hidden class="anchor" aria-hidden="true" href="#windows控制台">#</a></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;Windows.h&gt;</span><span class="cp">
</span><span class="cp"></span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="n">DWORD</span> <span class="n">dwCount</span><span class="p">;</span>
	<span class="n">HANDLE</span> <span class="n">hStd</span> <span class="o">=</span> <span class="n">GetStdHandle</span><span class="p">(</span><span class="n">STD_OUTPUT_HANDLE</span><span class="p">);</span>
	<span class="n">SetConsoleTextAttribute</span><span class="p">(</span><span class="n">hStd</span><span class="p">,</span> <span class="n">FOREGROUND_RED</span> <span class="o">|</span> <span class="n">FOREGROUND_BLUE</span> <span class="o">|</span> <span class="n">BACKGROUND_BLUE</span><span class="p">);</span>
	<span class="n">WriteConsole</span><span class="p">(</span><span class="n">hStd</span><span class="p">,</span> <span class="sa">L</span><span class="s">&#34;Hello World!&#34;</span><span class="p">,</span> <span class="n">wcslen</span><span class="p">(</span><span class="sa">L</span><span class="s">&#34;Hello World!&#34;</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">dwCount</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
	<span class="n">SetConsoleTitle</span><span class="p">(</span><span class="sa">L</span><span class="s">&#34;Title&#34;</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><h2 id="内存申请与释放">内存申请与释放<a hidden class="anchor" aria-hidden="true" href="#内存申请与释放">#</a></h2>
<p><code>HeapAlloc</code> 内存申请
<code>HeapFree</code> 内存释放</p>
<p>相关代码</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="n">HANDLE</span> <span class="n">hHeap</span> <span class="o">=</span> <span class="n">GetProcessHeap</span><span class="p">();</span>
<span class="kt">char</span> <span class="o">*</span> <span class="n">str</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">HeapAlloc</span><span class="p">(</span><span class="n">hHeap</span><span class="p">,</span> <span class="n">HEAP_ZERO_MEMORY</span><span class="p">,</span> <span class="mh">0x100</span><span class="p">);</span>
<span class="n">HeapFree</span><span class="p">(</span><span class="n">hHeap</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">str</span><span class="p">);</span>
</code></pre></div><h2 id="文件操作">文件操作<a hidden class="anchor" aria-hidden="true" href="#文件操作">#</a></h2>
<h3 id="win32">Win32<a hidden class="anchor" aria-hidden="true" href="#win32">#</a></h3>
<p>查看官方文档学习</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;Windows.h&gt;</span><span class="cp">
</span><span class="cp"></span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="n">HANDLE</span> <span class="n">hFile</span> <span class="o">=</span> <span class="n">CreateFile</span><span class="p">(</span><span class="sa">L</span><span class="s">&#34;C:</span><span class="se">\\</span><span class="s">Users</span><span class="se">\\</span><span class="s">15890</span><span class="se">\\</span><span class="s">Desktop</span><span class="se">\\</span><span class="s">Test.txt&#34;</span><span class="p">,</span><span class="n">GENERIC_ALL</span><span class="p">,</span><span class="nb">NULL</span><span class="p">,</span><span class="nb">NULL</span><span class="p">,</span><span class="n">OPEN_EXISTING</span><span class="p">,</span><span class="n">FILE_ATTRIBUTE_NORMAL</span><span class="p">,</span><span class="nb">NULL</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">INVALID_HANDLE_VALUE</span> <span class="o">==</span> <span class="n">hFile</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">MessageBox</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="sa">L</span><span class="s">&#34;CreateFile Failed!&#34;</span><span class="p">,</span> <span class="sa">L</span><span class="s">&#34;Error&#34;</span><span class="p">,</span> <span class="n">MB_OK</span><span class="p">);</span>
		<span class="n">ExitProcess</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
		<span class="n">system</span><span class="p">(</span><span class="s">&#34;pause&#34;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">DWORD</span> <span class="n">dwFileLen</span> <span class="o">=</span> <span class="n">GetFileSize</span><span class="p">(</span><span class="n">hFile</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
	<span class="n">PTCHAR</span> <span class="n">szBuffer</span><span class="p">;</span>
	<span class="n">HANDLE</span> <span class="n">hHeap</span> <span class="o">=</span> <span class="n">GetProcessHeap</span><span class="p">();</span>
	<span class="n">szBuffer</span> <span class="o">=</span> <span class="p">(</span><span class="n">PTCHAR</span><span class="p">)</span><span class="n">HeapAlloc</span><span class="p">(</span><span class="n">hHeap</span><span class="p">,</span> <span class="n">HEAP_ZERO_MEMORY</span><span class="p">,</span> <span class="n">dwFileLen</span><span class="p">);</span>
	<span class="n">DWORD</span> <span class="n">dwReadSize</span><span class="p">;</span>
	<span class="n">ReadFile</span><span class="p">(</span><span class="n">hFile</span><span class="p">,</span> <span class="n">szBuffer</span><span class="p">,</span> <span class="n">dwFileLen</span><span class="p">,</span><span class="o">&amp;</span><span class="n">dwReadSize</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
	<span class="n">CHAR</span> <span class="n">szWriteBuffer</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&#34;Hello Windows API&#34;</span><span class="p">;</span>
	<span class="n">DWORD</span> <span class="n">dwWriteSize</span><span class="p">;</span>
	<span class="n">WriteFile</span><span class="p">(</span><span class="n">hFile</span><span class="p">,</span> <span class="n">szWriteBuffer</span><span class="p">,</span><span class="n">strlen</span><span class="p">(</span><span class="n">szWriteBuffer</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">dwWriteSize</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
	<span class="n">HeapFree</span><span class="p">(</span><span class="n">hHeap</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">szBuffer</span><span class="p">);</span>
	<span class="n">CloseHandle</span><span class="p">(</span><span class="n">hFile</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><h3 id="cfile类">CFile类<a hidden class="anchor" aria-hidden="true" href="#cfile类">#</a></h3>
<p>官方文档非常详细</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="n">CFile</span> <span class="n">cFile</span><span class="p">;</span>
<span class="n">cFile</span><span class="p">.</span><span class="n">Open</span><span class="p">(</span><span class="sa">L</span><span class="s">&#34;C:</span><span class="se">\\</span><span class="s">Users</span><span class="se">\\</span><span class="s">15890</span><span class="se">\\</span><span class="s">Desktop</span><span class="se">\\</span><span class="s">Test.txt&#34;</span><span class="p">,</span> <span class="n">CFile</span><span class="o">::</span><span class="n">modeReadWrite</span><span class="p">);</span>
<span class="n">DWORD</span> <span class="n">dwFileLen</span> <span class="o">=</span> <span class="n">cFile</span><span class="p">.</span><span class="n">GetLength</span><span class="p">();</span>
<span class="n">PTCHAR</span> <span class="n">szBuffer</span><span class="p">;</span>
<span class="n">HANDLE</span> <span class="n">hHeap</span> <span class="o">=</span> <span class="n">GetProcessHeap</span><span class="p">();</span>
<span class="n">szBuffer</span> <span class="o">=</span> <span class="p">(</span><span class="n">PTCHAR</span><span class="p">)</span><span class="n">HeapAlloc</span><span class="p">(</span><span class="n">hHeap</span><span class="p">,</span> <span class="n">HEAP_ZERO_MEMORY</span><span class="p">,</span> <span class="n">dwFileLen</span><span class="p">);</span>
<span class="n">cFile</span><span class="p">.</span><span class="n">Read</span><span class="p">(</span><span class="n">szBuffer</span><span class="p">,</span> <span class="n">dwFileLen</span><span class="p">);</span>
<span class="n">CHAR</span> <span class="n">pbufWrite</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&#34;Hello CFile&#34;</span><span class="p">;</span>
<span class="n">cFile</span><span class="p">.</span><span class="n">Write</span><span class="p">(</span><span class="n">pbufWrite</span><span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="n">pbufWrite</span><span class="p">));</span>
<span class="n">cFile</span><span class="p">.</span><span class="n">Flush</span><span class="p">();</span>
</code></pre></div><h2 id="消息框">消息框<a hidden class="anchor" aria-hidden="true" href="#消息框">#</a></h2>
<p><code>MessageBox</code> Win32</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="n">DWORD</span> <span class="n">ret</span> <span class="o">=</span> <span class="n">MessageBox</span><span class="p">(</span><span class="sa">L</span><span class="s">&#34;Hello World!&#34;</span><span class="p">,</span> <span class="sa">L</span><span class="s">&#34;Title&#34;</span><span class="p">,</span> <span class="n">MB_YESNO</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">==</span> <span class="n">IDYES</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">MessageBox</span><span class="p">(</span><span class="sa">L</span><span class="s">&#34;Yes&#34;</span><span class="p">,</span> <span class="sa">L</span><span class="s">&#34;Tip&#34;</span><span class="p">,</span> <span class="n">MB_OK</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">else</span> <span class="nf">if</span><span class="p">(</span><span class="n">ret</span> <span class="o">==</span> <span class="n">IDNO</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">MessageBox</span><span class="p">(</span><span class="sa">L</span><span class="s">&#34;No&#34;</span><span class="p">,</span> <span class="sa">L</span><span class="s">&#34;Tip&#34;</span><span class="p">,</span> <span class="n">MB_OK</span><span class="p">);</span>
<span class="p">}</span>

</code></pre></div><p><code>AfxMessageBox</code> MFC</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="n">DWORD</span> <span class="n">ret</span> <span class="o">=</span> <span class="n">AfxMessageBox</span><span class="p">(</span><span class="sa">L</span><span class="s">&#34;Hello World!&#34;</span><span class="p">,</span> <span class="n">MB_YESNO</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">==</span> <span class="n">IDYES</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">AfxMessageBox</span><span class="p">(</span><span class="sa">L</span><span class="s">&#34;Yes&#34;</span><span class="p">,</span> <span class="n">MB_OK</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">else</span> <span class="nf">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">==</span> <span class="n">IDNO</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">AfxMessageBox</span><span class="p">(</span><span class="sa">L</span><span class="s">&#34;No&#34;</span><span class="p">,</span> <span class="n">MB_OK</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div><h2 id="对话框">对话框<a hidden class="anchor" aria-hidden="true" href="#对话框">#</a></h2>
<h3 id="模态对话框">模态对话框<a hidden class="anchor" aria-hidden="true" href="#模态对话框">#</a></h3>
<p>会占用主对话框</p>
<p>相关代码</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="kt">void</span> <span class="n">CMFCAppModDlg</span><span class="o">::</span><span class="n">OnBnClickedButton1</span><span class="p">()</span>
<span class="p">{</span>
	<span class="c1">// TODO: 在此添加控件通知处理程序代码
</span><span class="c1"></span>	<span class="n">CDialogMod</span> <span class="n">dlg</span><span class="p">;</span>
	<span class="n">dlg</span><span class="p">.</span><span class="n">DoModal</span><span class="p">();</span>
<span class="p">}</span>

</code></pre></div><h3 id="非模态对话框">非模态对话框<a hidden class="anchor" aria-hidden="true" href="#非模态对话框">#</a></h3>
<p>不会占用主对话框</p>
<p>相关代码</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="kt">void</span> <span class="n">CMFCAppModDlg</span><span class="o">::</span><span class="n">OnBnClickedButton2</span><span class="p">()</span>
<span class="p">{</span>
	<span class="c1">// TODO: 在此添加控件通知处理程序代码
</span><span class="c1"></span>	<span class="n">CDialogModLess</span><span class="o">*</span> <span class="n">m_Dlg</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">m_Dlg</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">m_Dlg</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CDialogModLess</span><span class="p">;</span>
		<span class="n">m_Dlg</span><span class="o">-&gt;</span><span class="n">Create</span><span class="p">(</span><span class="n">IDD_DIALOG2</span><span class="p">,</span><span class="k">this</span><span class="p">);</span>
		<span class="n">m_Dlg</span><span class="o">-&gt;</span><span class="n">ShowWindow</span><span class="p">(</span><span class="n">SW_SHOW</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>

</code></pre></div><h3 id="通用对话框-文件选择">通用对话框-文件选择<a hidden class="anchor" aria-hidden="true" href="#通用对话框-文件选择">#</a></h3>
<p>相关代码</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="n">CFileDialog</span> <span class="nf">m_dlg</span><span class="p">(</span><span class="n">TRUE</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="sa">L</span><span class="s">&#34;文本文件|*.txt|可执行文件|*.exe|所有文件|*.*||&#34;</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="n">m_dlg</span><span class="p">.</span><span class="n">DoModal</span><span class="p">();</span>
<span class="n">CString</span> <span class="n">szPath</span> <span class="o">=</span> <span class="n">m_dlg</span><span class="p">.</span><span class="n">GetPathName</span><span class="p">();</span>
<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">szPath</span><span class="p">.</span><span class="n">IsEmpty</span><span class="p">())</span>
	<span class="n">AfxMessageBox</span><span class="p">(</span><span class="n">szPath</span><span class="p">);</span>
</code></pre></div><h2 id="状态栏">状态栏<a hidden class="anchor" aria-hidden="true" href="#状态栏">#</a></h2>
<p>相关代码</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="n">m_StatusBar</span><span class="p">.</span><span class="n">Create</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="n">UINT</span> <span class="n">arr</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span> <span class="p">};</span>
<span class="n">m_StatusBar</span><span class="p">.</span><span class="n">SetIndicators</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
<span class="n">m_StatusBar</span><span class="p">.</span><span class="n">SetPaneInfo</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">SBPS_NORMAL</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
<span class="n">m_StatusBar</span><span class="p">.</span><span class="n">SetPaneInfo</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">SBPS_NORMAL</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
<span class="n">m_StatusBar</span><span class="p">.</span><span class="n">SetPaneInfo</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">arr</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">SBPS_NORMAL</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
<span class="n">m_StatusBar</span><span class="p">.</span><span class="n">SetPaneText</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="sa">L</span><span class="s">&#34;Text1&#34;</span><span class="p">);</span>
<span class="n">m_StatusBar</span><span class="p">.</span><span class="n">SetPaneText</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="sa">L</span><span class="s">&#34;Text2&#34;</span><span class="p">);</span>
<span class="n">m_StatusBar</span><span class="p">.</span><span class="n">SetPaneText</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="sa">L</span><span class="s">&#34;Text3&#34;</span><span class="p">);</span>
<span class="n">RepositionBars</span><span class="p">(</span><span class="n">AFX_IDW_CONTROLBAR_FIRST</span><span class="p">,</span> <span class="n">AFX_IDW_CONTROLBAR_LAST</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

</code></pre></div><h2 id="控件">控件<a hidden class="anchor" aria-hidden="true" href="#控件">#</a></h2>
<p>常用控件</p>
<ul>
<li>单选控件</li>
<li>复选控件</li>
<li>按钮控件</li>
<li>静态文本控件</li>
<li>编辑控件</li>
<li>列表控件</li>
<li>下拉框控件</li>
<li>进度条控件</li>
<li>滑块控件</li>
<li>IP控件</li>
<li>树状控件</li>
<li><strong>tab控件</strong></li>
</ul>
<p>(可参考微软官方文档进行学习)</p>
<h3 id="tab控件">tab控件<a hidden class="anchor" aria-hidden="true" href="#tab控件">#</a></h3>
<p>初始化</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="n">m_Tab</span><span class="p">.</span><span class="n">InsertItem</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="sa">L</span><span class="s">&#34;Text&#34;</span><span class="p">);</span>
<span class="n">m_Tab</span><span class="p">.</span><span class="n">InsertItem</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="sa">L</span><span class="s">&#34;List&#34;</span><span class="p">);</span>
<span class="n">m_Tab</span><span class="p">.</span><span class="n">InsertItem</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="sa">L</span><span class="s">&#34;Tree&#34;</span><span class="p">);</span>
<span class="n">m_Tab</span><span class="p">.</span><span class="n">InsertItem</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="sa">L</span><span class="s">&#34;Other&#34;</span><span class="p">);</span>

<span class="n">m_dlgText</span><span class="p">.</span><span class="n">Create</span><span class="p">(</span><span class="n">IDD_DIALOG1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">m_Tab</span><span class="p">);</span>
<span class="n">m_dlgList</span><span class="p">.</span><span class="n">Create</span><span class="p">(</span><span class="n">IDD_DIALOG2</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">m_Tab</span><span class="p">);</span>
<span class="n">m_dlgTree</span><span class="p">.</span><span class="n">Create</span><span class="p">(</span><span class="n">IDD_DIALOG3</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">m_Tab</span><span class="p">);</span>
<span class="n">m_dlgOther</span><span class="p">.</span><span class="n">Create</span><span class="p">(</span><span class="n">IDD_DIALOG4</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">m_Tab</span><span class="p">);</span>

<span class="n">CRect</span> <span class="n">rs</span><span class="p">;</span>
<span class="n">m_Tab</span><span class="p">.</span><span class="n">GetClientRect</span><span class="p">(</span><span class="n">rs</span><span class="p">);</span>
<span class="n">rs</span><span class="p">.</span><span class="n">top</span> <span class="o">+=</span> <span class="mi">20</span><span class="p">;</span>
<span class="n">m_dlgText</span><span class="p">.</span><span class="n">MoveWindow</span><span class="p">(</span><span class="n">rs</span><span class="p">);</span>
<span class="n">m_dlgList</span><span class="p">.</span><span class="n">MoveWindow</span><span class="p">(</span><span class="n">rs</span><span class="p">);</span>
<span class="n">m_dlgTree</span><span class="p">.</span><span class="n">MoveWindow</span><span class="p">(</span><span class="n">rs</span><span class="p">);</span>
<span class="n">m_dlgOther</span><span class="p">.</span><span class="n">MoveWindow</span><span class="p">(</span><span class="n">rs</span><span class="p">);</span>
<span class="n">m_dlgText</span><span class="p">.</span><span class="n">ShowWindow</span><span class="p">(</span><span class="n">SW_SHOW</span><span class="p">);</span>

</code></pre></div><p>使用</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="kt">int</span> <span class="n">nCurSel</span><span class="p">;</span>
<span class="n">nCurSel</span> <span class="o">=</span> <span class="n">m_Tab</span><span class="p">.</span><span class="n">GetCurSel</span><span class="p">();</span>
<span class="k">switch</span> <span class="p">(</span><span class="n">nCurSel</span><span class="p">)</span>
<span class="p">{</span>
<span class="k">case</span> <span class="mi">0</span><span class="o">:</span>
<span class="p">{</span>
	<span class="n">m_dlgText</span><span class="p">.</span><span class="n">ShowWindow</span><span class="p">(</span><span class="n">SW_SHOW</span><span class="p">);</span>
	<span class="n">m_dlgList</span><span class="p">.</span><span class="n">ShowWindow</span><span class="p">(</span><span class="n">SW_HIDE</span><span class="p">);</span>
	<span class="n">m_dlgTree</span><span class="p">.</span><span class="n">ShowWindow</span><span class="p">(</span><span class="n">SW_HIDE</span><span class="p">);</span>
	<span class="n">m_dlgOther</span><span class="p">.</span><span class="n">ShowWindow</span><span class="p">(</span><span class="n">SW_HIDE</span><span class="p">);</span>
	<span class="k">break</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
<span class="p">{</span>
	<span class="n">m_dlgText</span><span class="p">.</span><span class="n">ShowWindow</span><span class="p">(</span><span class="n">SW_HIDE</span><span class="p">);</span>
	<span class="n">m_dlgList</span><span class="p">.</span><span class="n">ShowWindow</span><span class="p">(</span><span class="n">SW_SHOW</span><span class="p">);</span>
	<span class="n">m_dlgTree</span><span class="p">.</span><span class="n">ShowWindow</span><span class="p">(</span><span class="n">SW_HIDE</span><span class="p">);</span>
	<span class="n">m_dlgOther</span><span class="p">.</span><span class="n">ShowWindow</span><span class="p">(</span><span class="n">SW_HIDE</span><span class="p">);</span>
	<span class="k">break</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
<span class="p">{</span>
	<span class="n">m_dlgText</span><span class="p">.</span><span class="n">ShowWindow</span><span class="p">(</span><span class="n">SW_HIDE</span><span class="p">);</span>
	<span class="n">m_dlgList</span><span class="p">.</span><span class="n">ShowWindow</span><span class="p">(</span><span class="n">SW_HIDE</span><span class="p">);</span>
	<span class="n">m_dlgTree</span><span class="p">.</span><span class="n">ShowWindow</span><span class="p">(</span><span class="n">SW_SHOW</span><span class="p">);</span>
	<span class="n">m_dlgOther</span><span class="p">.</span><span class="n">ShowWindow</span><span class="p">(</span><span class="n">SW_HIDE</span><span class="p">);</span>
	<span class="k">break</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">case</span> <span class="mi">3</span><span class="o">:</span>
<span class="p">{</span>
	<span class="n">m_dlgText</span><span class="p">.</span><span class="n">ShowWindow</span><span class="p">(</span><span class="n">SW_HIDE</span><span class="p">);</span>
	<span class="n">m_dlgList</span><span class="p">.</span><span class="n">ShowWindow</span><span class="p">(</span><span class="n">SW_HIDE</span><span class="p">);</span>
	<span class="n">m_dlgTree</span><span class="p">.</span><span class="n">ShowWindow</span><span class="p">(</span><span class="n">SW_HIDE</span><span class="p">);</span>
	<span class="n">m_dlgOther</span><span class="p">.</span><span class="n">ShowWindow</span><span class="p">(</span><span class="n">SW_SHOW</span><span class="p">);</span>
	<span class="k">break</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">default</span><span class="o">:</span>
	<span class="k">break</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><h3 id="热键">热键<a hidden class="anchor" aria-hidden="true" href="#热键">#</a></h3>
<p>相关代码</p>
<p>注册</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="n">RegisterHotKey</span><span class="p">(</span><span class="n">m_hWnd</span><span class="p">,</span> <span class="n">HOT_KEY_MESSAGEBOX</span><span class="p">,</span> <span class="n">MOD_WIN</span><span class="p">,</span> <span class="n">VK_F2</span><span class="p">);</span>
</code></pre></div><p>使用</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="kt">void</span> <span class="n">CMFCAppUseDlg</span><span class="o">::</span><span class="n">OnHotKey</span><span class="p">(</span><span class="n">UINT</span> <span class="n">nHotKeyId</span><span class="p">,</span> <span class="n">UINT</span> <span class="n">nKey1</span><span class="p">,</span> <span class="n">UINT</span> <span class="n">nKey2</span><span class="p">)</span>
<span class="p">{</span>
	<span class="c1">// TODO: 在此添加消息处理程序代码和/或调用默认值
</span><span class="c1"></span>	<span class="k">switch</span> <span class="p">(</span><span class="n">nHotKeyId</span><span class="p">)</span>
	<span class="p">{</span>
	<span class="k">case</span> <span class="nl">HOT_KEY_MESSAGEBOX</span><span class="p">:</span>
	<span class="p">{</span>
		<span class="n">AfxMessageBox</span><span class="p">(</span>
			<span class="sa">L</span><span class="s">&#34;</span><span class="se">\u2764\u2721\u262a\u2600\u2602\u2622\u2648\u2649\u264a\u264b\u264c\u264d</span><span class="s">&#34;</span>
			<span class="sa">L</span><span class="s">&#34;</span><span class="se">\u264e\u264f\u2650\u2651\u2652\u2653\u2690\u2691\u26c4\u2620\u27bc\u2200</span><span class="s">&#34;</span>
		<span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">default</span><span class="o">:</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">CDialogEx</span><span class="o">::</span><span class="n">OnHotKey</span><span class="p">(</span><span class="n">nHotKeyId</span><span class="p">,</span> <span class="n">nKey1</span><span class="p">,</span> <span class="n">nKey2</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://www.codetea.top/tags/windows/">Windows</a></li>
      <li><a href="https://www.codetea.top/tags/note/">note</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://www.codetea.top/posts/base_note/">
    <span class="title">« Prev</span>
    <br>
    <span>进制笔记</span>
  </a>
  <a class="next" href="https://www.codetea.top/posts/css3-style/">
    <span class="title">Next »</span>
    <br>
    <span>CSS3样式 笔记</span>
  </a>
</nav>


<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share MFC基础 笔记 on twitter"
        href="https://twitter.com/intent/tweet/?text=MFC%e5%9f%ba%e7%a1%80%20%e7%ac%94%e8%ae%b0&amp;url=https%3a%2f%2fwww.codetea.top%2fposts%2fmfc_basic%2f&amp;hashtags=Windows%2c%e2%80%9cNote%22">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share MFC基础 笔记 on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.codetea.top%2fposts%2fmfc_basic%2f&amp;title=MFC%e5%9f%ba%e7%a1%80%20%e7%ac%94%e8%ae%b0&amp;summary=MFC%e5%9f%ba%e7%a1%80%20%e7%ac%94%e8%ae%b0&amp;source=https%3a%2f%2fwww.codetea.top%2fposts%2fmfc_basic%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share MFC基础 笔记 on reddit"
        href="https://reddit.com/submit?url=https%3a%2f%2fwww.codetea.top%2fposts%2fmfc_basic%2f&title=MFC%e5%9f%ba%e7%a1%80%20%e7%ac%94%e8%ae%b0">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share MFC基础 笔记 on facebook"
        href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.codetea.top%2fposts%2fmfc_basic%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share MFC基础 笔记 on whatsapp"
        href="https://api.whatsapp.com/send?text=MFC%e5%9f%ba%e7%a1%80%20%e7%ac%94%e8%ae%b0%20-%20https%3a%2f%2fwww.codetea.top%2fposts%2fmfc_basic%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share MFC基础 笔记 on telegram"
        href="https://telegram.me/share/url?text=MFC%e5%9f%ba%e7%a1%80%20%e7%ac%94%e8%ae%b0&amp;url=https%3a%2f%2fwww.codetea.top%2fposts%2fmfc_basic%2f">
        <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28">
            <path
                d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
        </svg>
    </a>
</div>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2022 <a href="https://www.codetea.top/">OPdbgBytes</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
