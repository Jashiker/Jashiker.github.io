<!DOCTYPE html>
<html lang="en"><head>
    <title>OPdbg</title>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
    <meta content="utf-8" http-equiv="encoding">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="format-detection" content="telephone=no" />
    <meta name="theme-color" content="#000084" />
    <link rel="icon" href="https://www.codetea.top//favicon.ico">
    <link rel="canonical" href="https://www.codetea.top/">
    
    
    
<script>
  MathJax = {
    tex: {
      inlineMath: [["$", "$"]],
    },
    displayMath: [
      ["$$", "$$"],
      ["\[\[", "\]\]"],
    ],
    svg: {
      fontCache: "global",
    },
  };
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
></script>

    
        <script>renderMathInElement(document.body);</script>
    
    <link href="https://cdn.bootcdn.net/ajax/libs/highlight.js/11.4.0/styles/atom-one-dark.min.css" rel="stylesheet">
    <script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/11.4.0/highlight.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/11.4.0/languages/armasm.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/11.4.0/languages/mipsasm.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/11.4.0/languages/wasm.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/11.4.0/languages/x86asm.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
</head>
<body>
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="navbar-inner">
        <div class="container">
            <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse"></button>
            <a class="brand" href="https://www.codetea.top/">OPdbg</a>
            <div class="nav-collapse collapse">
                <ul class="nav">
                    
                    
                        
                            <li>
                                <a href="/about/">
                                    
                                    <span>About</span>
                                </a>
                            </li>
                        
                    
                        
                            <li>
                                <a href="/posts">
                                    
                                    <span>Blog</span>
                                </a>
                            </li>
                        
                    
                        
                            <li>
                                <a href="/tags">
                                    
                                    <span>Tags</span>
                                </a>
                            </li>
                        
                    
                        
                            <li>
                                <a href="/link">
                                    
                                    <span>Link</span>
                                </a>
                            </li>
                        
                    
                </ul>
            </div>
        </div>
    </div>
</nav><div id="content" class="container">

<div class="row-fluid navmargin">
    <div class="page-header">
        <h1>2021 羊城杯 Crypto部分_Writeup - Sat, Jan 29, 2022</h1>
    </div>
    <p class="lead"></p>
    <h1 id="2021-羊城杯-crypto部分-writeup">2021 羊城杯 Crypto部分 Writeup</h1>
<p>菜鸡Crypto手，就解出来了两道题，都是相对比较简单的密码学题目，供各位大佬参考</p>
<h2 id="bigrsa">BigRSA</h2>
<p>题目源码</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> Crypto.Util.number <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
<span style="color:#f92672">from</span> flag <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>

n1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">103835296409081751860770535514746586815395898427260334325680313648369132661057840680823295512236948953370895568419721331170834557812541468309298819497267746892814583806423027167382825479157951365823085639078738847647634406841331307035593810712914545347201619004253602692127370265833092082543067153606828049061</span>
n2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">115383198584677147487556014336448310721853841168758012445634182814180314480501828927160071015197089456042472185850893847370481817325868824076245290735749717384769661698895000176441497242371873981353689607711146852891551491168528799814311992471449640014501858763495472267168224015665906627382490565507927272073</span>
e <span style="color:#f92672">=</span> <span style="color:#ae81ff">65537</span>
m <span style="color:#f92672">=</span> bytes_to_long(flag)
c <span style="color:#f92672">=</span> pow(m, e, n1)
c <span style="color:#f92672">=</span> pow(c, e, n2)

print(<span style="color:#e6db74">&#34;c = </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> c)

<span style="color:#75715e"># output</span>
<span style="color:#75715e"># c = 60406168302768860804211220055708551816238816061772464557956985699400782163597251861675967909246187833328847989530950308053492202064477410641014045601986036822451416365957817685047102703301347664879870026582087365822433436251615243854347490600004857861059245403674349457345319269266645006969222744554974358264</span>
</code></pre></div><p>手速题目，可以通过n1和n2直接的关系。</p>
<p>n1和n2经过测试是存在有一个不等于1的最大公约数，这个最大公约数显然就是共同的p，可以根据这一线索进行。然后就是两层的加密数值，求出两个q，然后再求出两个phi和d，然后这道题目就像剥洋葱一样简单了</p>
<p>EXP：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> gmpy2
<span style="color:#f92672">import</span> libnum
<span style="color:#f92672">from</span> Crypto.Util.number <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>

n1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">103835296409081751860770535514746586815395898427260334325680313648369132661057840680823295512236948953370895568419721331170834557812541468309298819497267746892814583806423027167382825479157951365823085639078738847647634406841331307035593810712914545347201619004253602692127370265833092082543067153606828049061</span>
n2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">115383198584677147487556014336448310721853841168758012445634182814180314480501828927160071015197089456042472185850893847370481817325868824076245290735749717384769661698895000176441497242371873981353689607711146852891551491168528799814311992471449640014501858763495472267168224015665906627382490565507927272073</span>
e <span style="color:#f92672">=</span> <span style="color:#ae81ff">65537</span>
<span style="color:#75715e"># m = bytes_to_long(flag)</span>
<span style="color:#75715e"># c = pow(m, e, n1)</span>
<span style="color:#75715e"># c = pow(c, e, n2)</span>

c <span style="color:#f92672">=</span> <span style="color:#ae81ff">60406168302768860804211220055708551816238816061772464557956985699400782163597251861675967909246187833328847989530950308053492202064477410641014045601986036822451416365957817685047102703301347664879870026582087365822433436251615243854347490600004857861059245403674349457345319269266645006969222744554974358264</span>

p <span style="color:#f92672">=</span>int(gmpy2<span style="color:#f92672">.</span>gcd(n1,n2))
q1 <span style="color:#f92672">=</span> n1<span style="color:#f92672">//</span>p
q2 <span style="color:#f92672">=</span> n2<span style="color:#f92672">//</span>p
<span style="color:#66d9ef">assert</span> p<span style="color:#f92672">*</span>q1 <span style="color:#f92672">==</span> n1
<span style="color:#66d9ef">assert</span> p<span style="color:#f92672">*</span>q2 <span style="color:#f92672">==</span> n2


phi1 <span style="color:#f92672">=</span> (p<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>(q1<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
phi2 <span style="color:#f92672">=</span> (p<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>(q2<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)

d1 <span style="color:#f92672">=</span> libnum<span style="color:#f92672">.</span>invmod(e,phi1)
d2 <span style="color:#f92672">=</span> libnum<span style="color:#f92672">.</span>invmod(e,phi2)

c1 <span style="color:#f92672">=</span> pow(c,d2,n2)
m <span style="color:#f92672">=</span> pow(c1,d1,n1)
flag <span style="color:#f92672">=</span> long_to_bytes(m)
print(flag)

</code></pre></div><h2 id="ringringring">RingRingRing</h2>
<p>这道题目需要使用羊城杯官方的VPN进行连接，是一个远程的动态靶机，其实也就是一个身份认证加一个简单是数学运算题目，我是采用从简单的形式入手，由简单推向复杂，找出规律就行遍历求解。
$$
a^4+b^4+c^4+d^4 = e^2
$$
题目关键点也就是这个公式，根据这个公式的特点：
$$
1^4 + 1^4 +1^4 + 1^4 = 2^2
$$</p>
<p>$$
2^4 + 2^4 + 2^4 + 2^4 = 8^2
$$</p>
<p>$$
4^4 + 4^4 + 4^4 + 4^4 = 32^2
$$</p>
<p>根据简单的数据推测出规律性的公式
$$
(2^n)^4+(2^n)^4+(2^n)^4+(2^n)^4 = (2^{2n+1})^2
$$
根据公式进行代码编写即可求解</p>
<p>EXP：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
<span style="color:#f92672">import</span> string
<span style="color:#f92672">import</span> hashlib
<span style="color:#f92672">import</span> itertools
sh <span style="color:#f92672">=</span> remote(<span style="color:#e6db74">&#34;192.168.39.50&#34;</span>,<span style="color:#ae81ff">2378</span>)
line <span style="color:#f92672">=</span> sh<span style="color:#f92672">.</span>recvline()<span style="color:#f92672">.</span>decode()<span style="color:#f92672">.</span>strip(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
ans <span style="color:#f92672">=</span> line[<span style="color:#f92672">-</span><span style="color:#ae81ff">5</span>:]
s2 <span style="color:#f92672">=</span> line[line<span style="color:#f92672">.</span>find(<span style="color:#e6db74">&#34;+&#34;</span>)<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>:line<span style="color:#f92672">.</span>find(<span style="color:#e6db74">&#34;)&#34;</span>)]
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> itertools<span style="color:#f92672">.</span>product(string<span style="color:#f92672">.</span>ascii_letters <span style="color:#f92672">+</span> string<span style="color:#f92672">.</span>digits, repeat<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span>):
    s1 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join(i)
    ss <span style="color:#f92672">=</span> s1 <span style="color:#f92672">+</span> s2
    <span style="color:#66d9ef">if</span> (hashlib<span style="color:#f92672">.</span>md5(ss<span style="color:#f92672">.</span>encode())<span style="color:#f92672">.</span>hexdigest()[<span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">5</span>] <span style="color:#f92672">==</span> ans):
        sh<span style="color:#f92672">.</span>sendline(s1)
        <span style="color:#66d9ef">break</span>

context<span style="color:#f92672">.</span>log_level <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;debug&#39;</span>
sh<span style="color:#f92672">.</span>recvline()
sh<span style="color:#f92672">.</span>recvline()
<span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">100</span>):
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>):
        sh<span style="color:#f92672">.</span>sendline(str(<span style="color:#ae81ff">2</span><span style="color:#f92672">**</span>j))
        sleep(<span style="color:#ae81ff">1</span>)
    sh<span style="color:#f92672">.</span>sendline(str(<span style="color:#ae81ff">2</span><span style="color:#f92672">**</span>(<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>j<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)))
    sleep(<span style="color:#ae81ff">1</span>)
sh<span style="color:#f92672">.</span>interactive()
</code></pre></div>
    <h4><a href="https://www.codetea.top/">Back to Home</a></h4>
</div>


        </div><footer class="container">
    <hr class="soften">
    <p>
    OrcasCode Blog | 

&copy; 

    OolongCode

<span id="thisyear">2022</span>

    | OolongBytes Space


</p>
    <p class="text-center">
        
        
        <a href="https://linkedin.com">Linkedin</a> 
        <a href="https://github.com/OolongCode">GitHub</a> 
        <a href="https://gitlab.com">GitLab</a>
    </p>
</footer>

</body><link rel="stylesheet" href="/css/bootstrap.css">
<link rel="stylesheet" href="/css/bootstrap-responsive.css">
<link rel="stylesheet" href="/css/style.css">

<script src="/js/jquery.js"></script>
<script src="/js/bootstrap-386.js"></script>
<script src="/js/bootstrap-transition.js"></script>
<script src="/js/bootstrap-alert.js"></script>
<script src="/js/bootstrap-modal.js"></script>
<script src="/js/bootstrap-dropdown.js"></script>
<script src="/js/bootstrap-scrollspy.js"></script>
<script src="/js/bootstrap-tab.js"></script>
<script src="/js/bootstrap-tooltip.js"></script>
<script src="/js/bootstrap-popover.js"></script>
<script src="/js/bootstrap-button.js"></script>
<script src="/js/bootstrap-collapse.js"></script>
<script src="/js/bootstrap-carousel.js"></script>
<script src="/js/bootstrap-typeahead.js"></script>
<script src="/js/bootstrap-affix.js"></script>
<script>
    _386 = { 
        fastLoad: false ,
        onePass: false , 
        speedFactor: 1 
    };

    
    function ThisYear() {
        document.getElementById('thisyear').innerHTML = new Date().getFullYear();
    };
</script></html>
